<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VisNDT å®Œæ•´å†…å®¹ç®¡ç†ä¸­å¿ƒ</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <!-- Quillå¯Œæ–‡æœ¬ç¼–è¾‘å™¨ -->
    <link href="https://cdn.quilljs.com/1.3.6/quill.snow.css" rel="stylesheet">
    <script src="https://cdn.quilljs.com/1.3.6/quill.min.js"></script>
    <style>
        :root {
            --primary-color: #007bff;
            --success-color: #28a745;
            --warning-color: #ffc107;
            --danger-color: #dc3545;
            --info-color: #17a2b8;
            --dark-color: #343a40;
            --light-color: #f8f9fa;
            --sidebar-width: 280px;
            --header-height: 70px;
        }

        body {
            background: #f5f6fa;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 0;
        }

        /* é¡¶éƒ¨å¯¼èˆª */
        .top-navbar {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            height: var(--header-height);
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 1000;
            display: flex;
            align-items: center;
            padding: 0 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .navbar-brand {
            font-size: 1.5rem;
            font-weight: 600;
            color: white;
            text-decoration: none;
            margin-right: 30px;
        }

        .navbar-nav {
            display: flex;
            gap: 20px;
            margin-left: auto;
        }

        .navbar-btn {
            background: rgba(255,255,255,0.1);
            color: white;
            border: 1px solid rgba(255,255,255,0.2);
            padding: 8px 16px;
            border-radius: 6px;
            text-decoration: none;
            transition: all 0.2s ease;
            font-size: 0.9rem;
        }

        .navbar-btn:hover {
            background: rgba(255,255,255,0.2);
            color: white;
        }

        /* ä¾§è¾¹æ  */
        .sidebar {
            position: fixed;
            top: var(--header-height);
            left: 0;
            width: var(--sidebar-width);
            height: calc(100vh - var(--header-height));
            background: white;
            border-right: 1px solid #e9ecef;
            overflow-y: auto;
            z-index: 999;
        }

        .sidebar-section {
            border-bottom: 1px solid #f0f0f0;
        }

        .section-header {
            background: #f8f9fa;
            padding: 15px 20px;
            font-weight: 600;
            color: var(--dark-color);
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: all 0.2s ease;
        }

        .section-header:hover {
            background: #e9ecef;
        }

        .section-content {
            padding: 0;
            max-height: 300px;
            overflow: hidden;
            transition: max-height 0.3s ease;
        }

        .section-content.collapsed {
            max-height: 0;
        }

        .sidebar-item {
            padding: 12px 20px;
            cursor: pointer;
            transition: all 0.2s ease;
            border-bottom: 1px solid #f8f9fa;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .sidebar-item:hover {
            background: #f8f9fa;
        }

        .sidebar-item.active {
            background: rgba(0,123,255,0.1);
            border-left: 3px solid var(--primary-color);
            color: var(--primary-color);
        }

        .sidebar-icon {
            width: 20px;
            text-align: center;
        }

        /* ä¸»å†…å®¹åŒº */
        .main-content {
            margin-left: var(--sidebar-width);
            margin-top: var(--header-height);
            padding: 30px;
            min-height: calc(100vh - var(--header-height));
        }

        .content-header {
            background: white;
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 25px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .content-title {
            font-size: 1.8rem;
            font-weight: 600;
            color: var(--dark-color);
            margin-bottom: 8px;
        }

        .content-subtitle {
            color: #6c757d;
            margin-bottom: 20px;
        }

        .content-actions {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .content-body {
            background: white;
            border-radius: 12px;
            padding: 25px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        /* å·¥å…·æ æ ·å¼ */
        .list-toolbar {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 10px;
        }

        .toolbar-left {
            display: flex;
            flex-direction: column;
            gap: 10px;
            align-items: flex-start;
        }

        .toolbar-right {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        /* ç­›é€‰ç»„æ ·å¼ */
        .filter-group {
            display: flex;
            gap: 10px;
            align-items: center;
            flex-wrap: wrap;
        }

        .filter-select {
            min-width: 150px !important;
            width: auto !important;
        }

        .filter-status {
            margin-top: 8px;
        }

        .filter-tag {
            display: inline-block;
            background: #007bff;
            color: white;
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 0.8rem;
            margin-right: 5px;
            margin-bottom: 2px;
        }

        .filter-tag .remove {
            margin-left: 5px;
            cursor: pointer;
            font-weight: bold;
        }

        .search-box {
            position: relative;
            width: 250px;
        }

        .search-input {
            width: 100%;
            padding: 8px 35px 8px 12px;
            border: 1px solid #dee2e6;
            border-radius: 6px;
            font-size: 0.9rem;
        }

        .search-icon {
            position: absolute;
            right: 10px;
            top: 50%;
            transform: translateY(-50%);
            color: #6c757d;
        }

        /* è¡¨æ ¼æ ·å¼ */
        .content-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
        }

        .content-table th,
        .content-table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #e9ecef;
        }

        .content-table th {
            background: #f8f9fa;
            font-weight: 600;
            color: var(--dark-color);
        }

        .content-table tbody tr:hover {
            background: #f8f9fa;
        }

        .status-badge {
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 0.8rem;
            font-weight: 500;
        }

        .status-published {
            background: #d4edda;
            color: #155724;
        }

        .status-draft {
            background: #fff3cd;
            color: #856404;
        }

        .action-buttons {
            display: flex;
            gap: 5px;
        }

        .action-btn {
            background: none;
            border: none;
            color: #6c757d;
            padding: 4px 8px;
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 0.9rem;
        }

        .action-btn:hover {
            background: rgba(0,0,0,0.1);
        }

        .action-btn.edit:hover {
            color: var(--primary-color);
        }

        .action-btn.delete:hover {
            color: var(--danger-color);
        }

        .action-btn.view:hover {
            color: var(--success-color);
        }

        /* åˆ†é¡µæ ·å¼ */
        .pagination-container {
            margin-top: 20px;
            padding: 15px 0;
            border-top: 1px solid #e9ecef;
        }

        .pagination .page-link {
            color: var(--primary-color);
            border: 1px solid #dee2e6;
            padding: 8px 12px;
            margin: 0 2px;
            border-radius: 4px;
            text-decoration: none;
            transition: all 0.2s ease;
        }

        .pagination .page-link:hover {
            background-color: #e9ecef;
            border-color: #adb5bd;
        }

        .pagination .page-item.active .page-link {
            background-color: var(--primary-color);
            border-color: var(--primary-color);
            color: white;
        }

        .pagination .page-item.disabled .page-link {
            color: #6c757d;
            background-color: #fff;
            border-color: #dee2e6;
            cursor: not-allowed;
        }

        .pagination-info {
            color: #6c757d;
            font-size: 0.9rem;
        }

        /* åª’ä½“åº“æ ·å¼ */
        .media-file-item {
            border: 2px solid #e9ecef;
            border-radius: 8px;
            padding: 10px;
            cursor: pointer;
            transition: all 0.2s ease;
            position: relative;
            background: white;
        }

        .media-file-item:hover {
            border-color: var(--primary-color);
            box-shadow: 0 2px 8px rgba(0,123,255,0.15);
        }

        .media-file-item.selected {
            border-color: var(--primary-color);
            background-color: rgba(0,123,255,0.05);
        }

        .media-preview {
            height: 120px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: #f8f9fa;
            border-radius: 4px;
            margin-bottom: 8px;
        }

        .media-preview img {
            max-height: 100%;
            max-width: 100%;
            object-fit: cover;
            border-radius: 4px;
        }

        .file-icon {
            color: #dc3545;
        }

        .media-info {
            text-align: center;
        }

        .selection-indicator {
            position: absolute;
            top: 5px;
            right: 5px;
            background: var(--primary-color);
            color: white;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            display: none;
            align-items: center;
            justify-content: center;
            font-size: 12px;
        }

        .media-file-item.selected .selection-indicator {
            display: flex;
        }

        /* å›¾åº“æ ·å¼ */
        .gallery-image-item {
            position: relative;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            padding: 8px;
            background: white;
            transition: all 0.2s ease;
        }

        .gallery-image-item:hover {
            border-color: var(--primary-color);
            box-shadow: 0 2px 8px rgba(0,123,255,0.15);
        }

        .gallery-image-item.main-image {
            border-color: #ffc107;
            background-color: rgba(255,193,7,0.05);
        }

        .gallery-image-item img {
            width: 100%;
            height: 120px;
            object-fit: cover;
            border-radius: 4px;
        }

        .image-controls {
            position: absolute;
            top: 12px;
            right: 12px;
            display: flex;
            gap: 4px;
            opacity: 0;
            transition: opacity 0.2s ease;
        }

        .gallery-image-item:hover .image-controls {
            opacity: 1;
        }

        .image-info {
            margin-top: 8px;
        }

        .image-upload-area {
            border: 2px dashed #dee2e6;
            border-radius: 8px;
            padding: 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.2s ease;
            background: #f8f9fa;
            height: 180px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .image-upload-area:hover {
            border-color: var(--primary-color);
            background: rgba(0,123,255,0.05);
        }

        .upload-placeholder {
            color: #6c757d;
        }

        /* å›¾ç‰‡åœ°å€æ˜¾ç¤ºæ ·å¼ */
        .image-address {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 4px;
            padding: 4px 8px;
            word-break: break-all;
        }

        .image-placeholder {
            transition: all 0.2s ease;
        }

        .image-placeholder:hover {
            background: #e9ecef !important;
            border-color: var(--primary-color) !important;
        }

        /* ä¾›åº”å•†å›¾ç‰‡ç®¡ç†æ ·å¼ */
        .supplier-image-item {
            position: relative;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            padding: 8px;
            background: white;
            transition: all 0.2s ease;
        }

        .supplier-image-item:hover {
            border-color: var(--primary-color);
            box-shadow: 0 2px 8px rgba(0,123,255,0.15);
        }

        .supplier-image-item img {
            width: 100%;
            height: 120px;
            object-fit: cover;
            border-radius: 4px;
        }

        .supplier-image-upload-area {
            border: 2px dashed #dee2e6;
            border-radius: 8px;
            padding: 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.2s ease;
            background: #f8f9fa;
            height: 150px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .supplier-image-upload-area:hover {
            border-color: var(--primary-color);
            background: rgba(0,123,255,0.05);
        }

        /* å¯Œæ–‡æœ¬ç¼–è¾‘å™¨æ ·å¼ */
        .ql-editor {
            min-height: 200px;
        }

        /* å›¾ç‰‡ä¸Šä¼ åŒºåŸŸ */
        .image-upload-area {
            border: 2px dashed #dee2e6;
            border-radius: 8px;
            padding: 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.2s ease;
            background: #f8f9fa;
        }

        .image-upload-area:hover {
            border-color: var(--primary-color);
            background: rgba(0,123,255,0.05);
        }

        .upload-placeholder {
            color: #6c757d;
        }

        /* å“åº”å¼è®¾è®¡ */
        @media (max-width: 768px) {
            .sidebar {
                transform: translateX(-100%);
                transition: transform 0.3s ease;
            }

            .sidebar.show {
                transform: translateX(0);
            }

            .main-content {
                margin-left: 0;
                padding: 20px 15px;
            }

            .search-box {
                width: 200px;
            }
        }

        /* åŠ è½½åŠ¨ç”» */
        .loading {
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 40px;
            color: #6c757d;
        }

        .spinner {
            width: 20px;
            height: 20px;
            border: 2px solid #f3f3f3;
            border-top: 2px solid var(--primary-color);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-right: 10px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <!-- é¡¶éƒ¨å¯¼èˆª -->
    <nav class="top-navbar">
        <a href="#" class="navbar-brand">
            <i class="fas fa-cogs me-2"></i>VisNDT å®Œæ•´å†…å®¹ç®¡ç†ä¸­å¿ƒ
        </a>
        <div class="navbar-nav">
            <span id="serverStatus" class="navbar-btn" style="cursor: default;">
                <i class="fas fa-circle text-secondary me-1"></i>æ£€æŸ¥ä¸­...
            </span>
            <button onclick="syncLocalData()" class="navbar-btn" id="syncBtn" style="display: none;">
                <i class="fas fa-sync me-1"></i>åŒæ­¥æ•°æ®
            </button>
            <a href="../" class="navbar-btn">
                <i class="fas fa-home me-1"></i>è¿”å›ç½‘ç«™
            </a>
            <a href="index.html" class="navbar-btn">
                <i class="fas fa-arrow-left me-1"></i>è¿”å›ç®¡ç†é¦–é¡µ
            </a>
            <button onclick="logout()" class="navbar-btn">
                <i class="fas fa-sign-out-alt me-1"></i>é€€å‡ºç™»å½•
            </button>
        </div>
    </nav>

    <!-- ä¾§è¾¹æ  -->
    <div class="sidebar">
        <!-- äº§å“ç®¡ç† -->
        <div class="sidebar-section">
            <div class="section-header" onclick="toggleSection('products')">
                <span><i class="fas fa-box me-2"></i>äº§å“ç®¡ç†</span>
                <i class="fas fa-chevron-down"></i>
            </div>
            <div class="section-content" id="products-section">
                <div class="sidebar-item" onclick="showProductsList()">
                    <i class="sidebar-icon fas fa-list"></i>
                    <span>äº§å“åˆ—è¡¨</span>
                </div>
                <div class="sidebar-item" onclick="showProductCategories()">
                    <i class="sidebar-icon fas fa-tags"></i>
                    <span>äº§å“åˆ†ç±»</span>
                </div>
                <div class="sidebar-item" onclick="showSuppliers()">
                    <i class="sidebar-icon fas fa-building"></i>
                    <span>ä¾›åº”å•†ç®¡ç†</span>
                </div>

            </div>
        </div>

        <!-- å†…å®¹ç®¡ç† -->
        <div class="sidebar-section">
            <div class="section-header" onclick="toggleSection('content')">
                <span><i class="fas fa-newspaper me-2"></i>å†…å®¹ç®¡ç†</span>
                <i class="fas fa-chevron-down"></i>
            </div>
            <div class="section-content" id="content-section">
                <div class="sidebar-item" onclick="showNewsList()">
                    <i class="sidebar-icon fas fa-newspaper"></i>
                    <span>èµ„è®¯ç®¡ç†</span>
                </div>
                <div class="sidebar-item" onclick="showCasesList()">
                    <i class="sidebar-icon fas fa-briefcase"></i>
                    <span>æ¡ˆä¾‹ç®¡ç†</span>
                </div>
                <div class="sidebar-item" onclick="showApplications()">
                    <i class="sidebar-icon fas fa-cogs"></i>
                    <span>åº”ç”¨é¢†åŸŸ</span>
                </div>

            </div>
        </div>

        <!-- ç³»ç»Ÿç®¡ç† -->
        <div class="sidebar-section">
            <div class="section-header" onclick="toggleSection('system')">
                <span><i class="fas fa-cog me-2"></i>ç³»ç»Ÿç®¡ç†</span>
                <i class="fas fa-chevron-down"></i>
            </div>
            <div class="section-content" id="system-section">
                <div class="sidebar-item" onclick="showImportExport()">
                    <i class="sidebar-icon fas fa-exchange-alt"></i>
                    <span>å¯¼å…¥å¯¼å‡º</span>
                </div>
                <div class="sidebar-item" onclick="showMediaLibrary()">
                    <i class="sidebar-icon fas fa-images"></i>
                    <span>åª’ä½“åº“</span>
                </div>
                <div class="sidebar-item" onclick="showSystemSettings()">
                    <i class="sidebar-icon fas fa-sliders-h"></i>
                    <span>ç³»ç»Ÿè®¾ç½®</span>
                </div>
            </div>
        </div>
    </div>

    <!-- ä¸»å†…å®¹åŒº -->
    <div class="main-content">
        <!-- å†…å®¹å¤´éƒ¨ -->
        <div class="content-header">
            <h1 class="content-title" id="contentTitle">æ¬¢è¿ä½¿ç”¨å®Œæ•´å†…å®¹ç®¡ç†ä¸­å¿ƒ</h1>
            <p class="content-subtitle" id="contentSubtitle">é€‰æ‹©å·¦ä¾§èœå•å¼€å§‹ç®¡ç†æ‚¨çš„å†…å®¹</p>
            <div class="content-actions" id="contentActions">
                <!-- åŠ¨æ€ç”Ÿæˆçš„æ“ä½œæŒ‰é’® -->
            </div>
        </div>

        <!-- å†…å®¹ä¸»ä½“ -->
        <div class="content-body" id="contentBody">
            <div class="text-center py-5">
                <div class="mb-4">
                    <i class="fas fa-rocket fa-4x text-primary mb-3"></i>
                    <h3>å®Œæ•´å†…å®¹ç®¡ç†ç³»ç»Ÿ</h3>
                    <p class="text-muted">åŠŸèƒ½å®Œæ•´çš„å†…å®¹ç®¡ç†è§£å†³æ–¹æ¡ˆï¼Œæ”¯æŒäº§å“ã€èµ„è®¯ã€æ¡ˆä¾‹çš„å…¨ç”Ÿå‘½å‘¨æœŸç®¡ç†</p>
                </div>
                <div class="row">
                    <div class="col-md-4">
                        <div class="card h-100">
                            <div class="card-body text-center">
                                <i class="fas fa-box fa-2x text-primary mb-3"></i>
                                <h5>äº§å“ç®¡ç†</h5>
                                <p class="text-muted">å®Œæ•´çš„äº§å“ä¿¡æ¯ç®¡ç†ï¼Œæ”¯æŒåˆ†ç±»ã€ä¾›åº”å•†ã€ç³»åˆ—ç­‰</p>
                                <button class="btn btn-primary btn-sm" onclick="showProductsList()">å¼€å§‹ç®¡ç†</button>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="card h-100">
                            <div class="card-body text-center">
                                <i class="fas fa-newspaper fa-2x text-success mb-3"></i>
                                <h5>å†…å®¹ç®¡ç†</h5>
                                <p class="text-muted">èµ„è®¯ã€æ¡ˆä¾‹ã€åº”ç”¨é¢†åŸŸç­‰å†…å®¹çš„ç»Ÿä¸€ç®¡ç†</p>
                                <button class="btn btn-success btn-sm" onclick="showNewsList()">å¼€å§‹ç®¡ç†</button>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="card h-100">
                            <div class="card-body text-center">
                                <i class="fas fa-exchange-alt fa-2x text-warning mb-3"></i>
                                <h5>å¯¼å…¥å¯¼å‡º</h5>
                                <p class="text-muted">æ‰¹é‡å¯¼å…¥å¯¼å‡ºåŠŸèƒ½ï¼Œæ”¯æŒExcelå’ŒJSONæ ¼å¼</p>
                                <button class="btn btn-warning btn-sm" onclick="showImportExport()">å¼€å§‹ä½¿ç”¨</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- äº§å“ç¼–è¾‘å¼¹çª— -->
    <div class="modal fade" id="productModal" tabindex="-1" aria-labelledby="productModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-xl">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="productModalLabel">æ·»åŠ äº§å“</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="productForm">
                        <div class="row">
                            <!-- åŸºæœ¬ä¿¡æ¯ -->
                            <div class="col-md-6">
                                <h6 class="mb-3"><i class="fas fa-info-circle me-2"></i>åŸºæœ¬ä¿¡æ¯</h6>

                                <div class="mb-3">
                                    <label for="productTitle" class="form-label">äº§å“åç§° *</label>
                                    <input type="text" class="form-control" id="productTitle" required>
                                </div>

                                <div class="mb-3">
                                    <label for="productModel" class="form-label">äº§å“å‹å· *</label>
                                    <input type="text" class="form-control" id="productModel" required>
                                </div>

                                <div class="mb-3">
                                    <label for="productId" class="form-label">äº§å“ç¼–å· *</label>
                                    <input type="text" class="form-control" id="productId" placeholder="6ä½æ•°å­—ç¼–å·" maxlength="6" pattern="[0-9]{6}" required>
                                    <div class="form-text">è¯·è¾“å…¥6ä½æ•°å­—ç¼–å·</div>
                                </div>

                                <div class="mb-3">
                                    <label for="productSummary" class="form-label">äº§å“ç®€è¿°</label>
                                    <textarea class="form-control" id="productSummary" rows="3"></textarea>
                                </div>

                                <div class="mb-3">
                                    <label for="publishStatus" class="form-label">å‘å¸ƒçŠ¶æ€ *</label>
                                    <select class="form-select" id="publishStatus" required>
                                        <option value="published">å·²å‘å¸ƒ</option>
                                        <option value="draft">è‰ç¨¿</option>
                                    </select>
                                </div>

                                <div class="mb-3">
                                    <label for="publishDate" class="form-label">å‘å¸ƒæ—¶é—´</label>
                                    <input type="datetime-local" class="form-control" id="publishDate">
                                    <div class="form-text">ç•™ç©ºåˆ™ä½¿ç”¨å½“å‰æ—¶é—´</div>
                                </div>
                            </div>

                            <!-- åˆ†ç±»å’Œä¾›åº”å•† -->
                            <div class="col-md-6">
                                <h6 class="mb-3"><i class="fas fa-tags me-2"></i>åˆ†ç±»å’Œä¾›åº”å•†</h6>

                                <div class="mb-3">
                                    <label for="primaryCategory" class="form-label">äº§å“ä¸€çº§åˆ†ç±» *</label>
                                    <select class="form-select" id="primaryCategory" required onchange="updateSecondaryCategories()">
                                        <option value="">è¯·é€‰æ‹©ä¸€çº§åˆ†ç±»</option>
                                    </select>
                                </div>

                                <div class="mb-3">
                                    <label for="secondaryCategory" class="form-label">äº§å“äºŒçº§åˆ†ç±»</label>
                                    <select class="form-select" id="secondaryCategory">
                                        <option value="">è¯·å…ˆé€‰æ‹©ä¸€çº§åˆ†ç±»</option>
                                    </select>
                                </div>

                                <div class="mb-3">
                                    <label for="productSupplier" class="form-label">ä¾›åº”å•† *</label>
                                    <select class="form-select" id="productSupplier" required onchange="updateProductSeries()">
                                        <option value="">è¯·é€‰æ‹©ä¾›åº”å•†</option>
                                    </select>
                                </div>

                                <div class="mb-3">
                                    <label for="productSeries" class="form-label">äº§å“ç³»åˆ—</label>
                                    <select class="form-select" id="productSeries">
                                        <option value="">è¯·å…ˆé€‰æ‹©ä¾›åº”å•†</option>
                                    </select>
                                </div>
                            </div>
                        </div>

                        <!-- äº§å“å›¾åº“ -->
                        <div class="row mt-4">
                            <div class="col-12">
                                <h6 class="mb-3"><i class="fas fa-images me-2"></i>äº§å“å›¾åº“</h6>

                                <div class="alert alert-info">
                                    <i class="fas fa-info-circle me-2"></i>
                                    äº§å“å›¾ç‰‡å°†æ ¹æ®äº§å“ç³»åˆ—è‡ªåŠ¨è®¾ç½®é»˜è®¤å›¾ç‰‡ï¼Œæ‚¨ä¹Ÿå¯ä»¥ä¸Šä¼ æ–°å›¾ç‰‡æˆ–ä»åª’ä½“åº“ä¸­é€‰æ‹©ç°æœ‰å›¾ç‰‡ã€‚
                                </div>

                                <div class="mb-3">
                                    <label class="form-label">äº§å“å›¾åº“</label>
                                    <div class="d-flex gap-2 mb-3">
                                        <button type="button" class="btn btn-outline-primary btn-sm" onclick="addGalleryImage()">
                                            <i class="fas fa-upload me-1"></i>ä¸Šä¼ å›¾ç‰‡
                                        </button>
                                        <button type="button" class="btn btn-outline-success btn-sm" onclick="selectFromMediaLibrary()">
                                            <i class="fas fa-folder-open me-1"></i>ä»åª’ä½“åº“é€‰æ‹©
                                        </button>
                                    </div>
                                    <div id="galleryContainer" class="row">
                                        <div class="col-md-3 mb-3">
                                            <div class="image-upload-area" onclick="addGalleryImage()">
                                                <div class="upload-placeholder">
                                                    <i class="fas fa-plus fa-2x mb-2"></i>
                                                    <p>æ·»åŠ å›¾ç‰‡</p>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- äº§å“å‚æ•° -->
                        <div class="row mt-4">
                            <div class="col-12">
                                <h6 class="mb-3"><i class="fas fa-cog me-2"></i>äº§å“å‚æ•°</h6>

                                <div class="mb-3">
                                    <button type="button" class="btn btn-outline-success btn-sm me-2" onclick="loadDefaultParameters()">
                                        <i class="fas fa-magic me-1"></i>åŠ è½½é»˜è®¤å‚æ•°æ¨¡æ¿
                                    </button>
                                    <button type="button" class="btn btn-outline-warning btn-sm" onclick="clearAllParameters()">
                                        <i class="fas fa-trash me-1"></i>æ¸…ç©ºæ‰€æœ‰å‚æ•°
                                    </button>
                                </div>

                                <div id="parametersContainer">
                                    <!-- å‚æ•°å°†åœ¨è¿™é‡ŒåŠ¨æ€ç”Ÿæˆ -->
                                </div>

                                <button type="button" class="btn btn-outline-primary btn-sm" onclick="addParameter()">
                                    <i class="fas fa-plus me-1"></i>æ·»åŠ å‚æ•°
                                </button>
                            </div>
                        </div>

                        <!-- åº”ç”¨åœºæ™¯å’Œè¯¦ç»†æè¿° -->
                        <div class="row mt-4">
                            <div class="col-md-6">
                                <h6 class="mb-3"><i class="fas fa-lightbulb me-2"></i>åº”ç”¨åœºæ™¯</h6>
                                <div id="applicationScenariosEditor" style="height: 200px;"></div>
                            </div>
                            <div class="col-md-6">
                                <h6 class="mb-3"><i class="fas fa-file-alt me-2"></i>äº§å“è¯¦ç»†æè¿°</h6>
                                <div id="productDescriptionEditor" style="height: 200px;"></div>
                            </div>
                        </div>

                        <!-- èµ„æ–™ä¸‹è½½ -->
                        <div class="row mt-4">
                            <div class="col-12">
                                <h6 class="mb-3"><i class="fas fa-download me-2"></i>èµ„æ–™ä¸‹è½½</h6>

                                <div id="dataDownloadContainer">
                                    <!-- èµ„æ–™ä¸‹è½½é¡¹ç›®å°†åœ¨è¿™é‡ŒåŠ¨æ€ç”Ÿæˆ -->
                                </div>

                                <button type="button" class="btn btn-outline-primary btn-sm" onclick="addDataDownload()">
                                    <i class="fas fa-plus me-1"></i>æ·»åŠ èµ„æ–™
                                </button>
                            </div>
                        </div>

                        <!-- ç›¸å…³äº§å“ -->
                        <div class="row mt-4">
                            <div class="col-12">
                                <h6 class="mb-3"><i class="fas fa-link me-2"></i>ç›¸å…³äº§å“</h6>
                                <div class="mb-3">
                                    <label for="relatedProductsSelect" class="form-label">é€‰æ‹©ç›¸å…³äº§å“</label>
                                    <select class="form-select" id="relatedProductsSelect" onchange="addRelatedProduct()">
                                        <option value="">è¯·é€‰æ‹©ç›¸å…³äº§å“</option>
                                    </select>
                                </div>
                                <div id="relatedProductsList">
                                    <!-- å·²é€‰æ‹©çš„ç›¸å…³äº§å“åˆ—è¡¨ -->
                                </div>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">å–æ¶ˆ</button>
                    <button type="button" class="btn btn-primary" onclick="saveProduct()">ä¿å­˜äº§å“</button>
                </div>
            </div>
        </div>
    </div>

    <!-- èµ„è®¯ç¼–è¾‘å¼¹çª— -->
    <div class="modal fade" id="newsModal" tabindex="-1" aria-labelledby="newsModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-xl">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="newsModalLabel">æ·»åŠ èµ„è®¯</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="newsForm">
                        <div class="row">
                            <!-- åŸºæœ¬ä¿¡æ¯ -->
                            <div class="col-md-8">
                                <div class="mb-3">
                                    <label for="newsTitle" class="form-label">æ ‡é¢˜ *</label>
                                    <input type="text" class="form-control" id="newsTitle" required>
                                </div>
                                <div class="mb-3">
                                    <label for="newsSummary" class="form-label">æ‘˜è¦ *</label>
                                    <textarea class="form-control" id="newsSummary" rows="3" required></textarea>
                                </div>
                                <div class="mb-3">
                                    <label for="newsContent" class="form-label">å†…å®¹ *</label>
                                    <div id="newsContentEditor" style="height: 300px;"></div>
                                    <textarea id="newsContentHidden" style="display: none;"></textarea>
                                </div>
                            </div>

                            <!-- ä¾§è¾¹æ ä¿¡æ¯ -->
                            <div class="col-md-4">
                                <div class="mb-3">
                                    <label for="newsCategory" class="form-label">åˆ†ç±» *</label>
                                    <select class="form-select" id="newsCategory" required>
                                        <option value="">é€‰æ‹©åˆ†ç±»</option>
                                        <option value="æŠ€æœ¯èµ„è®¯">æŠ€æœ¯èµ„è®¯</option>
                                        <option value="äº§å“å‘å¸ƒ">äº§å“å‘å¸ƒ</option>
                                        <option value="å…¬å¸åŠ¨æ€">å…¬å¸åŠ¨æ€</option>
                                        <option value="è¡Œä¸šæ–°é—»">è¡Œä¸šæ–°é—»</option>
                                    </select>
                                </div>
                                <div class="mb-3">
                                    <label for="newsAuthor" class="form-label">ä½œè€…</label>
                                    <input type="text" class="form-control" id="newsAuthor" value="ç®¡ç†å‘˜">
                                </div>
                                <div class="mb-3">
                                    <label for="newsPublishDate" class="form-label">å‘å¸ƒæ—¥æœŸ</label>
                                    <input type="date" class="form-control" id="newsPublishDate">
                                </div>
                                <div class="mb-3">
                                    <label for="newsStatus" class="form-label">çŠ¶æ€</label>
                                    <select class="form-select" id="newsStatus">
                                        <option value="è‰ç¨¿">è‰ç¨¿</option>
                                        <option value="å·²å‘å¸ƒ">å·²å‘å¸ƒ</option>
                                        <option value="å¾…å®¡æ ¸">å¾…å®¡æ ¸</option>
                                    </select>
                                </div>
                                <div class="mb-3">
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" id="newsFeatured">
                                        <label class="form-check-label" for="newsFeatured">
                                            æ¨èèµ„è®¯
                                        </label>
                                    </div>
                                </div>
                                <div class="mb-3">
                                    <label for="newsImage" class="form-label">å°é¢å›¾ç‰‡</label>
                                    <input type="url" class="form-control" id="newsImage" placeholder="å›¾ç‰‡URL">
                                    <div class="mt-2">
                                        <img id="newsImagePreview" src="" alt="é¢„è§ˆ" style="max-width: 100%; height: auto; display: none;">
                                    </div>
                                </div>
                                <div class="mb-3">
                                    <label for="newsTags" class="form-label">æ ‡ç­¾</label>
                                    <input type="text" class="form-control" id="newsTags" placeholder="ç”¨é€—å·åˆ†éš”å¤šä¸ªæ ‡ç­¾">
                                    <small class="form-text text-muted">ä¾‹å¦‚ï¼šæŠ€æœ¯,å†…çª¥é•œ,å·¥ä¸š</small>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">å–æ¶ˆ</button>
                    <button type="button" class="btn btn-primary" onclick="saveNews()">ä¿å­˜</button>
                </div>
            </div>
        </div>
    </div>

    <!-- æ¡ˆä¾‹ç¼–è¾‘å¼¹çª— -->
    <div class="modal fade" id="caseModal" tabindex="-1" aria-labelledby="caseModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-xl">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="caseModalLabel">æ·»åŠ æ¡ˆä¾‹</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="caseForm">
                        <div class="row">
                            <!-- åŸºæœ¬ä¿¡æ¯ -->
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="caseTitle" class="form-label">æ¡ˆä¾‹æ ‡é¢˜ <span class="text-danger">*</span></label>
                                    <input type="text" class="form-control" id="caseTitle" required>
                                </div>
                                <div class="mb-3">
                                    <label for="caseSummary" class="form-label">æ¡ˆä¾‹ç®€ä»‹ <span class="text-danger">*</span></label>
                                    <textarea class="form-control" id="caseSummary" rows="3" required></textarea>
                                </div>
                                <div class="mb-3">
                                    <label for="caseClient" class="form-label">å®¢æˆ·åç§°</label>
                                    <input type="text" class="form-control" id="caseClient">
                                </div>
                                <div class="mb-3">
                                    <label for="caseIndustry" class="form-label">æ‰€å±è¡Œä¸š</label>
                                    <select class="form-select" id="caseIndustry">
                                        <option value="">è¯·é€‰æ‹©è¡Œä¸š</option>
                                        <option value="èˆªç©ºèˆªå¤©">èˆªç©ºèˆªå¤©</option>
                                        <option value="æ±½è½¦åˆ¶é€ ">æ±½è½¦åˆ¶é€ </option>
                                        <option value="èƒ½æºç”µåŠ›">èƒ½æºç”µåŠ›</option>
                                        <option value="æœºæ¢°åˆ¶é€ ">æœºæ¢°åˆ¶é€ </option>
                                        <option value="ç²¾å¯†é“¸é€ ">ç²¾å¯†é“¸é€ </option>
                                        <option value="ç§‘å­¦ç ”ç©¶">ç§‘å­¦ç ”ç©¶</option>
                                    </select>
                                </div>
                            </div>

                            <!-- åˆ†ç±»ä¿¡æ¯ -->
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="casePrimaryCategory" class="form-label">äº§å“åˆ†ç±»</label>
                                    <select class="form-select" id="casePrimaryCategory">
                                        <option value="">è¯·é€‰æ‹©äº§å“åˆ†ç±»</option>
                                        <option value="ç”µå­è§†é¢‘å†…çª¥é•œ">ç”µå­è§†é¢‘å†…çª¥é•œ</option>
                                        <option value="å…‰çº¤å†…çª¥é•œ">å…‰çº¤å†…çª¥é•œ</option>
                                        <option value="ç¡¬ç®¡å†…çª¥é•œ">ç¡¬ç®¡å†…çª¥é•œ</option>
                                        <option value="å·¥ä¸šCT">å·¥ä¸šCT</option>
                                        <option value="è¶…å£°æ£€æµ‹">è¶…å£°æ£€æµ‹</option>
                                        <option value="å°„çº¿æ£€æµ‹">å°„çº¿æ£€æµ‹</option>
                                    </select>
                                </div>
                                <div class="mb-3">
                                    <label for="caseApplicationField" class="form-label">åº”ç”¨é¢†åŸŸ</label>
                                    <select class="form-select" id="caseApplicationField">
                                        <option value="">è¯·é€‰æ‹©åº”ç”¨é¢†åŸŸ</option>
                                        <option value="å‘åŠ¨æœºæ£€æµ‹">å‘åŠ¨æœºæ£€æµ‹</option>
                                        <option value="ç®¡é“æ£€æµ‹">ç®¡é“æ£€æµ‹</option>
                                        <option value="ç„Šç¼æ£€æµ‹">ç„Šç¼æ£€æµ‹</option>
                                        <option value="é“¸ä»¶æ£€æµ‹">é“¸ä»¶æ£€æµ‹</option>
                                        <option value="è®¾å¤‡ç»´æŠ¤">è®¾å¤‡ç»´æŠ¤</option>
                                        <option value="è´¨é‡æ§åˆ¶">è´¨é‡æ§åˆ¶</option>
                                    </select>
                                </div>
                                <div class="mb-3">
                                    <label for="caseApplicationScenario" class="form-label">åº”ç”¨åœºæ™¯</label>
                                    <select class="form-select" id="caseApplicationScenario">
                                        <option value="">è¯·é€‰æ‹©åº”ç”¨åœºæ™¯</option>
                                        <option value="ç”Ÿäº§çº¿æ£€æµ‹">ç”Ÿäº§çº¿æ£€æµ‹</option>
                                        <option value="ç»´æŠ¤æ£€ä¿®">ç»´æŠ¤æ£€ä¿®</option>
                                        <option value="è´¨é‡éªŒæ”¶">è´¨é‡éªŒæ”¶</option>
                                        <option value="æ•…éšœè¯Šæ–­">æ•…éšœè¯Šæ–­</option>
                                        <option value="ç ”å‘æµ‹è¯•">ç ”å‘æµ‹è¯•</option>
                                    </select>
                                </div>
                                <div class="mb-3">
                                    <label for="caseDetectionObject" class="form-label">æ£€æµ‹å¯¹è±¡</label>
                                    <input type="text" class="form-control" id="caseDetectionObject" placeholder="å¦‚ï¼šå‘åŠ¨æœºå¶ç‰‡ã€ç®¡é“å†…å£ç­‰">
                                </div>
                            </div>
                        </div>

                        <!-- é¡¹ç›®ä¿¡æ¯ -->
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="caseEquipmentUsed" class="form-label">ä½¿ç”¨è®¾å¤‡</label>
                                    <input type="text" class="form-control" id="caseEquipmentUsed" placeholder="å¦‚ï¼šWS-K1210é«˜æ¸…å†…çª¥é•œ">
                                </div>
                                <div class="mb-3">
                                    <label for="caseDate" class="form-label">é¡¹ç›®æ—¥æœŸ</label>
                                    <input type="date" class="form-control" id="caseDate">
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="caseFeaturedImage" class="form-label">å°é¢å›¾ç‰‡</label>
                                    <input type="url" class="form-control" id="caseFeaturedImage" placeholder="å›¾ç‰‡URL">
                                    <div class="form-text">å»ºè®®å°ºå¯¸ï¼š800x600åƒç´ </div>
                                </div>
                                <div class="mb-3" id="caseImagePreview" style="display: none;">
                                    <img src="" alt="é¢„è§ˆ" class="img-thumbnail" style="max-width: 200px;">
                                </div>
                            </div>
                        </div>

                        <!-- å†…å®¹ç¼–è¾‘ -->
                        <div class="mb-3">
                            <label for="caseContent" class="form-label">æ¡ˆä¾‹è¯¦æƒ… <span class="text-danger">*</span></label>
                            <div id="caseContentEditor" style="height: 300px;"></div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">å–æ¶ˆ</button>
                    <button type="button" class="btn btn-primary" onclick="saveCase()">ä¿å­˜</button>
                </div>
            </div>
        </div>
    </div>

    <!-- é€šçŸ¥ç»„ä»¶ -->
    <div class="toast-container position-fixed top-0 end-0 p-3">
        <div id="notificationToast" class="toast" role="alert" aria-live="assertive" aria-atomic="true">
            <div class="toast-header">
                <i class="fas fa-info-circle me-2"></i>
                <strong class="me-auto">ç³»ç»Ÿé€šçŸ¥</strong>
                <button type="button" class="btn-close" data-bs-dismiss="toast" aria-label="Close"></button>
            </div>
            <div class="toast-body" id="notificationBody">
                <!-- é€šçŸ¥å†…å®¹ -->
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

    <!-- æµ‹è¯•JavaScriptæ˜¯å¦èƒ½æ‰§è¡Œ -->
    <script>
        console.log('ğŸš€ JavaScriptå¼€å§‹åŠ è½½...');

        // æµ‹è¯•åŸºæœ¬åŠŸèƒ½
        function testBasicFunction() {
            alert('åŸºæœ¬åŠŸèƒ½æµ‹è¯•æˆåŠŸï¼');
            console.log('åŸºæœ¬åŠŸèƒ½æµ‹è¯•æˆåŠŸ');
        }

        // é¡µé¢åŠ è½½å®Œæˆåçš„åŸºæœ¬æµ‹è¯•
        document.addEventListener('DOMContentLoaded', function() {
            console.log('âœ… DOMåŠ è½½å®Œæˆ');

            // æ·»åŠ æµ‹è¯•æŒ‰é’®åˆ°é¡µé¢
            const contentBody = document.getElementById('contentBody');
            if (contentBody) {
                contentBody.innerHTML = `
                    <div class="alert alert-info">
                        <h4>JavaScriptæµ‹è¯•</h4>
                        <p>å¦‚æœæ‚¨èƒ½çœ‹åˆ°è¿™ä¸ªæ¶ˆæ¯ï¼Œè¯´æ˜JavaScriptæ­£åœ¨å·¥ä½œã€‚</p>
                        <button class="btn btn-primary" onclick="testBasicFunction()">æµ‹è¯•åŸºæœ¬åŠŸèƒ½</button>
                        <button class="btn btn-success" onclick="testMenuFunction()">æµ‹è¯•èœå•åŠŸèƒ½</button>
                    </div>
                `;
                console.log('âœ… æµ‹è¯•ç•Œé¢å·²æ·»åŠ ');
            } else {
                console.error('âŒ æ‰¾ä¸åˆ°contentBodyå…ƒç´ ');
            }
        });

        // æµ‹è¯•èœå•åŠŸèƒ½
        function testMenuFunction() {
            console.log('ğŸ§ª æµ‹è¯•èœå•åŠŸèƒ½...');

            // æ£€æŸ¥èœå•å…ƒç´ 
            const menuItems = document.querySelectorAll('.sidebar-item');
            console.log(`æ‰¾åˆ° ${menuItems.length} ä¸ªèœå•é¡¹`);

            // æ£€æŸ¥onclickå±æ€§
            menuItems.forEach((item, index) => {
                const onclick = item.getAttribute('onclick');
                console.log(`èœå•é¡¹ ${index + 1}: ${onclick || 'æ— onclickå±æ€§'}`);
            });

            alert(`æ‰¾åˆ° ${menuItems.length} ä¸ªèœå•é¡¹ï¼Œè¯¦æƒ…è¯·æŸ¥çœ‹æ§åˆ¶å°`);
        }

        console.log('ğŸš€ åŸºæœ¬JavaScriptåŠ è½½å®Œæˆ');
    </script>

    <script>
        /*
        // æš‚æ—¶æ³¨é‡Šæ‰å¤æ‚çš„JavaScriptä»£ç ï¼Œå…ˆæµ‹è¯•åŸºæœ¬åŠŸèƒ½

        // ç¼–ç å®‰å…¨å·¥å…·å‡½æ•°
        const EncodingUtils = {
            // å®‰å…¨çš„JSONåºåˆ—åŒ–
            safeStringify: function(obj, space = 2) {
                try {
                    return JSON.stringify(obj, null, space);
                } catch (error) {
                    console.error('JSONåºåˆ—åŒ–å¤±è´¥:', error);
                    return '{}';
                }
            },

            // å®‰å…¨çš„JSONè§£æ
            safeParse: function(str, defaultValue = null) {
                try {
                    return JSON.parse(str);
                } catch (error) {
                    console.error('JSONè§£æå¤±è´¥:', error);
                    return defaultValue;
                }
            },

            // å­—ç¬¦ä¸²æ ‡å‡†åŒ–
            normalizeString: function(str) {
                if (typeof str !== 'string') return str;
                return str.normalize('NFC');
            },

            // å®‰å…¨çš„URLç¼–ç 
            safeEncodeURI: function(str) {
                try {
                    return encodeURIComponent(this.normalizeString(str));
                } catch (error) {
                    console.error('URLç¼–ç å¤±è´¥:', error);
                    return str;
                }
            },

            // å®‰å…¨çš„URLè§£ç 
            safeDecodeURI: function(str) {
                try {
                    return decodeURIComponent(str);
                } catch (error) {
                    console.error('URLè§£ç å¤±è´¥:', error);
                    return str;
                }
            },

            // æ‰¹é‡æ ‡å‡†åŒ–å¯¹è±¡ä¸­çš„å­—ç¬¦ä¸²
            normalizeObject: function(obj) {
                if (typeof obj !== 'object' || obj === null) return obj;

                const normalized = Array.isArray(obj) ? [] : {};

                for (const [key, value] of Object.entries(obj)) {
                    const normalizedKey = this.normalizeString(key);
                    if (typeof value === 'string') {
                        normalized[normalizedKey] = this.normalizeString(value);
                    } else if (typeof value === 'object' && value !== null) {
                        normalized[normalizedKey] = this.normalizeObject(value);
                    } else {
                        normalized[normalizedKey] = value;
                    }
                }

                return normalized;
            }
        };

        // å…¨å±€å˜é‡
        let currentSection = 'dashboard';
        let currentData = [];
        let filteredData = [];
        let editingProduct = null;
        let applicationScenariosEditor = null;
        let productDescriptionEditor = null;
        let productCategories = [];
        let suppliers = [];
        let allProducts = [];

        // åˆ†é¡µé…ç½®
        const ITEMS_PER_PAGE = 10;
        let currentPage = 1;

        // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', async function() {
            // æ£€æŸ¥ç™»å½•çŠ¶æ€
            if (!checkAuth()) {
                window.location.href = 'login.html';
                return;
            }

            // åˆå§‹åŒ–å¯Œæ–‡æœ¬ç¼–è¾‘å™¨
            initializeEditors();

            // åŠ è½½åŸºç¡€æ•°æ®
            await loadBaseData();

            // æ£€æŸ¥æœåŠ¡å™¨çŠ¶æ€
            await checkServerStatus();

            // åˆå§‹åŒ–å›¾ç‰‡ä¸Šä¼ ç»„ä»¶
            setTimeout(() => {
                if (window.FixedImageUploader) {
                    window.FixedImageUploader.createImageUploader('productGalleryUploader');
                }
            }, 1000);

            // åˆå§‹åŒ–åª’ä½“åº“äº‹ä»¶ç›‘å¬å™¨
            initializeMediaLibraryEvents();

            // åˆå§‹åŒ–å†…å®¹åŒæ­¥
            setTimeout(async () => {
                await window.ContentSyncManager.initSync();
            }, 1000);

            // åˆå§‹åŒ–äº‹ä»¶ç»‘å®š
            initializeEventBindings();

            // æ˜¾ç¤ºä»ªè¡¨æ¿
            setTimeout(() => {
                try {
                    showDashboard();
                } catch (error) {
                    console.error('æ˜¾ç¤ºä»ªè¡¨æ¿å¤±è´¥:', error);
                    // å¦‚æœä»ªè¡¨æ¿å¤±è´¥ï¼Œè‡³å°‘æ˜¾ç¤ºä¸€äº›åŸºæœ¬å†…å®¹
                    document.getElementById('contentTitle').textContent = 'ç®¡ç†ä¸­å¿ƒ';
                    document.getElementById('contentSubtitle').textContent = 'ç³»ç»Ÿæ­£åœ¨åˆå§‹åŒ–...';
                    document.getElementById('contentBody').innerHTML = `
                        <div class="alert alert-info">
                            <h4>æ¬¢è¿ä½¿ç”¨ VisNDT å†…å®¹ç®¡ç†ä¸­å¿ƒ</h4>
                            <p>è¯·ä½¿ç”¨å·¦ä¾§èœå•å¯¼èˆªåˆ°ä¸åŒçš„ç®¡ç†åŠŸèƒ½ã€‚</p>
                            <div class="mb-3">
                                <button class="btn btn-primary me-2" onclick="testAllFunctions()">æµ‹è¯•æ‰€æœ‰åŠŸèƒ½</button>
                                <button class="btn btn-success me-2" onclick="directTestProducts()">ç›´æ¥æµ‹è¯•äº§å“ç®¡ç†</button>
                                <button class="btn btn-info me-2" onclick="directTestNews()">ç›´æ¥æµ‹è¯•èµ„è®¯ç®¡ç†</button>
                                <button class="btn btn-warning" onclick="directTestCases()">ç›´æ¥æµ‹è¯•æ¡ˆä¾‹ç®¡ç†</button>
                            </div>
                            <div class="alert alert-secondary">
                                <strong>è°ƒè¯•ä¿¡æ¯ï¼š</strong>
                                <div id="debugInfo">æ­£åœ¨æ£€æŸ¥ç³»ç»ŸçŠ¶æ€...</div>
                            </div>
                        </div>
                    `;
                }
            }, 500);

            // è°ƒè¯•ï¼šæ£€æŸ¥æ‰€æœ‰å‡½æ•°æ˜¯å¦æ­£ç¡®åŠ è½½
            setTimeout(() => {
                console.log('ğŸ” è°ƒè¯•æ£€æŸ¥å¼€å§‹...');

                // æ£€æŸ¥å…³é”®å‡½æ•°
                const keyFunctions = [
                    'showProductsList', 'showNewsList', 'showCasesList',
                    'showApplications', 'showSuppliers', 'showProductCategories',
                    'showImportExport', 'showMediaLibrary', 'showSystemSettings',
                    'toggleSection', 'showDashboard'
                ];

                keyFunctions.forEach(funcName => {
                    if (typeof window[funcName] === 'function') {
                        console.log(`âœ… ${funcName} å‡½æ•°å·²åŠ è½½`);
                    } else {
                        console.error(`âŒ ${funcName} å‡½æ•°æœªæ‰¾åˆ°`);
                    }
                });

                // æ£€æŸ¥DOMå…ƒç´ 
                const keyElements = ['contentTitle', 'contentSubtitle', 'contentBody', 'contentActions'];
                keyElements.forEach(elementId => {
                    const element = document.getElementById(elementId);
                    if (element) {
                        console.log(`âœ… DOMå…ƒç´  ${elementId} å·²æ‰¾åˆ°`);
                    } else {
                        console.error(`âŒ DOMå…ƒç´  ${elementId} æœªæ‰¾åˆ°`);
                    }
                });

                // æ›´æ–°è°ƒè¯•ä¿¡æ¯æ˜¾ç¤º
                const debugInfo = document.getElementById('debugInfo');
                if (debugInfo) {
                    const availableFunctions = keyFunctions.filter(funcName => typeof window[funcName] === 'function');
                    const missingFunctions = keyFunctions.filter(funcName => typeof window[funcName] !== 'function');

                    debugInfo.innerHTML = `
                        <strong>å¯ç”¨åŠŸèƒ½ (${availableFunctions.length}/${keyFunctions.length}):</strong><br>
                        ${availableFunctions.map(f => `âœ… ${f}`).join('<br>')}
                        ${missingFunctions.length > 0 ? `<br><br><strong>ç¼ºå¤±åŠŸèƒ½:</strong><br>${missingFunctions.map(f => `âŒ ${f}`).join('<br>')}` : ''}
                    `;
                }

                console.log('ğŸ” è°ƒè¯•æ£€æŸ¥å®Œæˆ');
            }, 1000);

            console.log('å®Œæ•´å†…å®¹ç®¡ç†ç³»ç»Ÿå·²åŠ è½½');
        });

        // æµ‹è¯•æ‰€æœ‰åŠŸèƒ½æ˜¯å¦å¯ç”¨
        function testAllFunctions() {
            console.log('ğŸ§ª å¼€å§‹æµ‹è¯•æ‰€æœ‰åŠŸèƒ½...');

            const functions = [
                { name: 'showProductsList', desc: 'äº§å“åˆ—è¡¨' },
                { name: 'showProductCategories', desc: 'äº§å“åˆ†ç±»' },
                { name: 'showSuppliers', desc: 'ä¾›åº”å•†ç®¡ç†' },
                { name: 'showNewsList', desc: 'èµ„è®¯ç®¡ç†' },
                { name: 'showCasesList', desc: 'æ¡ˆä¾‹ç®¡ç†' },
                { name: 'showApplications', desc: 'åº”ç”¨é¢†åŸŸ' },
                { name: 'showImportExport', desc: 'å¯¼å…¥å¯¼å‡º' },
                { name: 'showMediaLibrary', desc: 'åª’ä½“åº“' },
                { name: 'showSystemSettings', desc: 'ç³»ç»Ÿè®¾ç½®' },
                { name: 'toggleSection', desc: 'åˆ‡æ¢èŠ‚' }
            ];

            let results = [];

            functions.forEach(func => {
                try {
                    if (typeof window[func.name] === 'function') {
                        results.push(`âœ… ${func.desc} (${func.name}) - å¯ç”¨`);
                    } else {
                        results.push(`âŒ ${func.desc} (${func.name}) - ä¸å¯ç”¨`);
                    }
                } catch (error) {
                    results.push(`âŒ ${func.desc} (${func.name}) - é”™è¯¯: ${error.message}`);
                }
            });

            const resultHtml = `
                <div class="alert alert-info">
                    <h4>åŠŸèƒ½æµ‹è¯•ç»“æœ</h4>
                    <pre>${results.join('\n')}</pre>
                    <hr>
                    <button class="btn btn-success" onclick="showProductsList()">æµ‹è¯•äº§å“ç®¡ç†</button>
                    <button class="btn btn-info" onclick="showNewsList()">æµ‹è¯•èµ„è®¯ç®¡ç†</button>
                    <button class="btn btn-warning" onclick="showCasesList()">æµ‹è¯•æ¡ˆä¾‹ç®¡ç†</button>
                </div>
            `;

            document.getElementById('contentBody').innerHTML = resultHtml;
            console.log('æµ‹è¯•ç»“æœ:', results);
        }

        // ç›´æ¥æµ‹è¯•å‡½æ•°
        function directTestProducts() {
            console.log('ğŸ§ª ç›´æ¥æµ‹è¯•äº§å“ç®¡ç†...');
            try {
                if (typeof showProductsList === 'function') {
                    showProductsList();
                    showNotification('äº§å“ç®¡ç†åŠŸèƒ½è°ƒç”¨æˆåŠŸ', 'success');
                } else {
                    showNotification('äº§å“ç®¡ç†å‡½æ•°ä¸å­˜åœ¨', 'error');
                }
            } catch (error) {
                console.error('äº§å“ç®¡ç†æµ‹è¯•å¤±è´¥:', error);
                showNotification('äº§å“ç®¡ç†æµ‹è¯•å¤±è´¥: ' + error.message, 'error');
            }
        }

        function directTestNews() {
            console.log('ğŸ§ª ç›´æ¥æµ‹è¯•èµ„è®¯ç®¡ç†...');
            try {
                if (typeof showNewsList === 'function') {
                    showNewsList();
                    showNotification('èµ„è®¯ç®¡ç†åŠŸèƒ½è°ƒç”¨æˆåŠŸ', 'success');
                } else {
                    showNotification('èµ„è®¯ç®¡ç†å‡½æ•°ä¸å­˜åœ¨', 'error');
                }
            } catch (error) {
                console.error('èµ„è®¯ç®¡ç†æµ‹è¯•å¤±è´¥:', error);
                showNotification('èµ„è®¯ç®¡ç†æµ‹è¯•å¤±è´¥: ' + error.message, 'error');
            }
        }

        function directTestCases() {
            console.log('ğŸ§ª ç›´æ¥æµ‹è¯•æ¡ˆä¾‹ç®¡ç†...');
            try {
                if (typeof showCasesList === 'function') {
                    showCasesList();
                    showNotification('æ¡ˆä¾‹ç®¡ç†åŠŸèƒ½è°ƒç”¨æˆåŠŸ', 'success');
                } else {
                    showNotification('æ¡ˆä¾‹ç®¡ç†å‡½æ•°ä¸å­˜åœ¨', 'error');
                }
            } catch (error) {
                console.error('æ¡ˆä¾‹ç®¡ç†æµ‹è¯•å¤±è´¥:', error);
                showNotification('æ¡ˆä¾‹ç®¡ç†æµ‹è¯•å¤±è´¥: ' + error.message, 'error');
            }
        }

        // åˆå§‹åŒ–äº‹ä»¶ç»‘å®š
        function initializeEventBindings() {
            console.log('ğŸ”— åˆå§‹åŒ–äº‹ä»¶ç»‘å®š...');

            // æ£€æŸ¥æ‰€æœ‰å¿…è¦çš„å‡½æ•°æ˜¯å¦å·²å®šä¹‰
            const requiredFunctions = [
                'showProductsList', 'showProductCategories', 'showSuppliers',
                'showNewsList', 'showCasesList', 'showApplications',
                'showImportExport', 'showMediaLibrary', 'showSystemSettings',
                'toggleSection'
            ];

            const missingFunctions = requiredFunctions.filter(funcName => typeof window[funcName] !== 'function');
            if (missingFunctions.length > 0) {
                console.error('ç¼ºå°‘å¿…è¦çš„å‡½æ•°:', missingFunctions);
            }

            // ç¡®ä¿onclickäº‹ä»¶èƒ½æ­£å¸¸å·¥ä½œï¼Œä¸ç§»é™¤onclickå±æ€§
            const sidebarItems = document.querySelectorAll('.sidebar-item[onclick]');
            console.log(`æ‰¾åˆ° ${sidebarItems.length} ä¸ªä¾§è¾¹æ èœå•é¡¹`);

            sidebarItems.forEach((item, index) => {
                const onclickAttr = item.getAttribute('onclick');
                console.log(`èœå•é¡¹ ${index + 1}: ${onclickAttr}`);

                // æ·»åŠ é¢å¤–çš„äº‹ä»¶ç›‘å¬å™¨ä½œä¸ºå¤‡ç”¨
                item.addEventListener('click', function(e) {
                    console.log('èœå•é¡¹è¢«ç‚¹å‡»:', onclickAttr);
                    try {
                        // å¦‚æœonclickå±æ€§å­˜åœ¨ä½†æ²¡æœ‰æ‰§è¡Œï¼Œæ‰‹åŠ¨æ‰§è¡Œ
                        if (onclickAttr && !e.defaultPrevented) {
                            eval(onclickAttr);
                        }
                    } catch (error) {
                        console.error('èœå•é¡¹ç‚¹å‡»äº‹ä»¶æ‰§è¡Œå¤±è´¥:', error);
                        showNotification('èœå•åŠŸèƒ½æ‰§è¡Œå¤±è´¥: ' + error.message, 'error');
                    }
                });
            });

            // æ£€æŸ¥èŠ‚æ ‡é¢˜çš„æŠ˜å äº‹ä»¶
            const sectionHeaders = document.querySelectorAll('.section-header[onclick]');
            console.log(`æ‰¾åˆ° ${sectionHeaders.length} ä¸ªèŠ‚æ ‡é¢˜`);

            sectionHeaders.forEach((header, index) => {
                const onclickAttr = header.getAttribute('onclick');
                console.log(`èŠ‚æ ‡é¢˜ ${index + 1}: ${onclickAttr}`);

                header.addEventListener('click', function(e) {
                    console.log('èŠ‚æ ‡é¢˜è¢«ç‚¹å‡»:', onclickAttr);
                    try {
                        if (onclickAttr && !e.defaultPrevented) {
                            eval(onclickAttr);
                        }
                    } catch (error) {
                        console.error('èŠ‚æ ‡é¢˜ç‚¹å‡»äº‹ä»¶æ‰§è¡Œå¤±è´¥:', error);
                    }
                });
            });

            console.log('âœ… äº‹ä»¶ç»‘å®šåˆå§‹åŒ–å®Œæˆ');
        }

        // ç®€å•çš„é€šçŸ¥å‡½æ•°
        function showNotification(message, type = 'info') {
            console.log(`[${type.toUpperCase()}] ${message}`);

            // å°è¯•æ˜¾ç¤ºæµè§ˆå™¨é€šçŸ¥
            if (typeof alert !== 'undefined') {
                alert(message);
            }

            // å¦‚æœæœ‰é€šçŸ¥å®¹å™¨ï¼Œæ˜¾ç¤ºåœ¨é¡µé¢ä¸Š
            const notificationContainer = document.getElementById('notificationContainer');
            if (notificationContainer) {
                const notification = document.createElement('div');
                notification.className = `alert alert-${type === 'error' ? 'danger' : type} alert-dismissible fade show`;
                notification.innerHTML = `
                    ${message}
                    <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
                `;
                notificationContainer.appendChild(notification);

                // 3ç§’åè‡ªåŠ¨ç§»é™¤
                setTimeout(() => {
                    if (notification.parentNode) {
                        notification.parentNode.removeChild(notification);
                    }
                }, 3000);
            }
        }

        // æ˜¾ç¤ºä»ªè¡¨æ¿
        async function showDashboard() {
            document.getElementById('contentTitle').textContent = 'ä»ªè¡¨æ¿';
            document.getElementById('contentSubtitle').textContent = 'ç³»ç»Ÿæ¦‚è§ˆå’Œå¿«é€Ÿæ“ä½œ';
            document.getElementById('contentActions').innerHTML = `
                <button class="btn btn-primary" onclick="syncLocalData()">
                    <i class="fas fa-sync me-1"></i>åŒæ­¥æ•°æ®
                </button>
                <button class="btn btn-success" onclick="refreshDashboard()">
                    <i class="fas fa-refresh me-1"></i>åˆ·æ–°æ•°æ®
                </button>
            `;

            // å…ˆæ˜¾ç¤ºåŠ è½½çŠ¶æ€
            document.getElementById('contentBody').innerHTML = `
                <div class="text-center py-5">
                    <div class="spinner-border text-primary" role="status">
                        <span class="visually-hidden">åŠ è½½ä¸­...</span>
                    </div>
                    <p class="mt-3">æ­£åœ¨åŠ è½½ä»ªè¡¨æ¿æ•°æ®...</p>
                </div>
            `;

            try {
                // å°è¯•ä»é¡¹ç›®æ•°æ®åŒæ­¥æœ€æ–°ä¿¡æ¯
                if (window.ContentSyncManager) {
                    await window.ContentSyncManager.syncAllData();
                }

                // è·å–ç»Ÿè®¡æ•°æ®
                const products = JSON.parse(localStorage.getItem('visndt_products') || '[]');
                const news = JSON.parse(localStorage.getItem('visndt_news') || '[]');
                const cases = JSON.parse(localStorage.getItem('visndt_cases') || '[]');
                const applications = JSON.parse(localStorage.getItem('visndt_applications') || '[]');
                const suppliers = JSON.parse(localStorage.getItem('visndt_suppliers') || '[]');

                // æ¸²æŸ“ä»ªè¡¨æ¿å†…å®¹
                renderDashboard(products, news, cases, applications, suppliers);

            } catch (error) {
                console.error('åŠ è½½ä»ªè¡¨æ¿æ•°æ®å¤±è´¥:', error);
                document.getElementById('contentBody').innerHTML = `
                    <div class="alert alert-warning">
                        <i class="fas fa-exclamation-triangle me-2"></i>
                        åŠ è½½ä»ªè¡¨æ¿æ•°æ®å¤±è´¥: ${error.message}
                        <button class="btn btn-outline-warning btn-sm ms-2" onclick="showDashboard()">é‡è¯•</button>
                    </div>
                `;
            }

            // è®¾ç½®æ´»åŠ¨çŠ¶æ€
            document.querySelectorAll('.sidebar-item').forEach(item => item.classList.remove('active'));
        }

        // æ¸²æŸ“ä»ªè¡¨æ¿å†…å®¹
        function renderDashboard(products, news, cases, applications, suppliers) {
            const dashboardHtml = `
                <div class="row mb-4">
                    <div class="col-md-2">
                        <div class="card text-center">
                            <div class="card-body">
                                <i class="fas fa-box fa-2x text-primary mb-2"></i>
                                <h4 class="card-title">${products.length}</h4>
                                <p class="card-text">äº§å“æ€»æ•°</p>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-2">
                        <div class="card text-center">
                            <div class="card-body">
                                <i class="fas fa-newspaper fa-2x text-success mb-2"></i>
                                <h4 class="card-title">${news.length}</h4>
                                <p class="card-text">èµ„è®¯æ–‡ç« </p>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-2">
                        <div class="card text-center">
                            <div class="card-body">
                                <i class="fas fa-briefcase fa-2x text-info mb-2"></i>
                                <h4 class="card-title">${cases.length}</h4>
                                <p class="card-text">åº”ç”¨æ¡ˆä¾‹</p>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-2">
                        <div class="card text-center">
                            <div class="card-body">
                                <i class="fas fa-cogs fa-2x text-warning mb-2"></i>
                                <h4 class="card-title">${applications.length}</h4>
                                <p class="card-text">åº”ç”¨é¢†åŸŸ</p>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-2">
                        <div class="card text-center">
                            <div class="card-body">
                                <i class="fas fa-building fa-2x text-secondary mb-2"></i>
                                <h4 class="card-title">${suppliers.length}</h4>
                                <p class="card-text">ä¾›åº”å•†</p>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-2">
                        <div class="card text-center">
                            <div class="card-body">
                                <i class="fas fa-sync fa-2x text-primary mb-2"></i>
                                <h4 class="card-title" id="syncStatus">å°±ç»ª</h4>
                                <p class="card-text">åŒæ­¥çŠ¶æ€</p>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="row">
                    <div class="col-md-4">
                        <div class="card">
                            <div class="card-header">
                                <h5><i class="fas fa-box me-2"></i>äº§å“ç®¡ç†</h5>
                            </div>
                            <div class="card-body">
                                <p class="text-muted">å®Œæ•´çš„äº§å“ä¿¡æ¯ç®¡ç†ï¼Œæ”¯æŒåˆ†ç±»ã€ä¾›åº”å•†ã€ç³»åˆ—ç­‰</p>
                                <button class="btn btn-primary btn-sm" onclick="showProductsList()">å¼€å§‹ç®¡ç†</button>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="card">
                            <div class="card-header">
                                <h5><i class="fas fa-newspaper me-2"></i>å†…å®¹ç®¡ç†</h5>
                            </div>
                            <div class="card-body">
                                <p class="text-muted">èµ„è®¯ã€æ¡ˆä¾‹ã€åº”ç”¨é¢†åŸŸç­‰å†…å®¹çš„ç»Ÿä¸€ç®¡ç†</p>
                                <button class="btn btn-success btn-sm" onclick="showNewsList()">å¼€å§‹ç®¡ç†</button>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="card">
                            <div class="card-header">
                                <h5><i class="fas fa-exchange-alt me-2"></i>å¯¼å…¥å¯¼å‡º</h5>
                            </div>
                            <div class="card-body">
                                <p class="text-muted">æ‰¹é‡å¯¼å…¥å¯¼å‡ºåŠŸèƒ½ï¼Œæ”¯æŒExcelå’ŒJSONæ ¼å¼</p>
                                <button class="btn btn-warning btn-sm" onclick="showImportExport()">å¼€å§‹ä½¿ç”¨</button>
                            </div>
                        </div>
                    </div>
                </div>
            `;

            document.getElementById('contentBody').innerHTML = dashboardHtml;
        }

        // åˆ·æ–°ä»ªè¡¨æ¿
        async function refreshDashboard() {
            await showDashboard();
            showNotification('ä»ªè¡¨æ¿æ•°æ®å·²åˆ·æ–°', 'success');
        }

        // åˆå§‹åŒ–åª’ä½“åº“äº‹ä»¶ç›‘å¬å™¨
        function initializeMediaLibraryEvents() {
            // æ–‡ä»¶å¤¹åˆ‡æ¢äº‹ä»¶
            document.addEventListener('click', function(e) {
                if (e.target.closest('#mediaFolderList .list-group-item')) {
                    const button = e.target.closest('.list-group-item');
                    const folder = button.dataset.folder;
                    if (folder) {
                        loadMediaFolder(folder);
                    }
                }
            });
        }

        // æ£€æŸ¥ç™»å½•çŠ¶æ€
        function checkAuth() {
            const sessionData = sessionStorage.getItem('visndt_admin_session');
            if (sessionData) {
                const session = JSON.parse(sessionData);
                if (Date.now() - session.loginTime < 8 * 60 * 60 * 1000) {
                    return true;
                }
            }

            const rememberData = localStorage.getItem('visndt_admin_remember');
            if (rememberData) {
                const remember = JSON.parse(rememberData);
                if (Date.now() - remember.loginTime < 30 * 24 * 60 * 60 * 1000) {
                    const sessionData = {
                        username: remember.username,
                        loginTime: Date.now(),
                        remember: true
                    };
                    sessionStorage.setItem('visndt_admin_session', JSON.stringify(sessionData));
                    return true;
                }
            }

            return false;
        }

        // ç™»å‡ºåŠŸèƒ½
        function logout() {
            if (confirm('ç¡®å®šè¦é€€å‡ºç™»å½•å—ï¼Ÿ')) {
                sessionStorage.removeItem('visndt_admin_session');
                localStorage.removeItem('visndt_admin_remember');
                window.location.href = 'login.html';
            }
        }

        // åˆå§‹åŒ–å¯Œæ–‡æœ¬ç¼–è¾‘å™¨
        function initializeEditors() {
            // åº”ç”¨åœºæ™¯ç¼–è¾‘å™¨
            applicationScenariosEditor = new Quill('#applicationScenariosEditor', {
                theme: 'snow',
                modules: {
                    toolbar: [
                        ['bold', 'italic', 'underline'],
                        ['link', 'image'],
                        [{ 'list': 'ordered'}, { 'list': 'bullet' }],
                        ['clean']
                    ]
                }
            });

            // äº§å“è¯¦ç»†æè¿°ç¼–è¾‘å™¨
            productDescriptionEditor = new Quill('#productDescriptionEditor', {
                theme: 'snow',
                modules: {
                    toolbar: [
                        ['bold', 'italic', 'underline'],
                        ['link', 'image'],
                        [{ 'list': 'ordered'}, { 'list': 'bullet' }],
                        [{ 'header': [1, 2, 3, false] }],
                        ['clean']
                    ]
                }
            });
        }

        // åŠ è½½åŸºç¡€æ•°æ®
        async function loadBaseData() {
            try {
                // åŠ è½½äº§å“åˆ†ç±»
                productCategories = await loadProductCategories();

                // åŠ è½½ä¾›åº”å•†
                suppliers = await loadSuppliers();

                // åŠ è½½æ‰€æœ‰äº§å“
                allProducts = await loadAllProducts();

                // æ›´æ–°ä¸‹æ‹‰é€‰é¡¹
                updateCategoryOptions();
                updateSupplierOptions();
                updateRelatedProductsOptions();

                console.log('åŸºç¡€æ•°æ®åŠ è½½å®Œæˆ');
            } catch (error) {
                console.error('åŠ è½½åŸºç¡€æ•°æ®å¤±è´¥:', error);
                showNotification('åŸºç¡€æ•°æ®åŠ è½½å¤±è´¥: ' + error.message, 'danger');
            }
        }

        // åŠ è½½äº§å“åˆ†ç±»
        async function loadProductCategories() {
            // ä»å‰å°å†…å®¹æ–‡ä»¶åŠ è½½äº§å“åˆ†ç±»ï¼Œä¸å‰å°ä¿æŒä¸€è‡´ï¼Œç”µå­å†…çª¥é•œæ’ç¬¬ä¸€
            return [
                {
                    id: 'electronic-endoscope',
                    title: 'ç”µå­å†…çª¥é•œ',
                    icon: 'fas fa-video',
                    description: 'å„ç±»ç”µå­å†…çª¥é•œåŠç›¸å…³è®¾å¤‡',
                    weight: 1,
                    subcategories: [
                        { id: 'industrial-video-endoscope', title: 'å·¥ä¸šè§†é¢‘å†…çª¥é•œ', description: 'ä¸“ä¸šå·¥ä¸šè§†é¢‘å†…çª¥é•œè®¾å¤‡', icon: 'fas fa-camera', weight: 1 },
                        { id: 'industrial-pipeline-endoscope', title: 'å·¥ä¸šç®¡é“å†…çª¥é•œ', description: 'ä¸“ç”¨ç®¡é“æ£€æµ‹å†…çª¥é•œ', icon: 'fas fa-pipe-section', weight: 2 },
                        { id: 'crawler-robot', title: 'çˆ¬è¡Œæœºå™¨äºº', description: 'ç®¡é“çˆ¬è¡Œæ£€æµ‹æœºå™¨äºº', icon: 'fas fa-robot', weight: 3 }
                    ]
                },
                {
                    id: 'fiber-endoscope',
                    title: 'å…‰çº¤å†…çª¥é•œ',
                    icon: 'fas fa-eye',
                    description: 'é«˜æ€§èƒ½å…‰çº¤å†…çª¥é•œè®¾å¤‡',
                    weight: 2,
                    subcategories: [
                        { id: 'flexible-fiber', title: 'æŸ”æ€§å…‰çº¤å†…çª¥é•œ', description: 'çµæ´»å¼¯æ›²æ£€æµ‹è®¾å¤‡', icon: 'fas fa-wave-square', weight: 1 },
                        { id: 'rigid-fiber', title: 'ç¡¬æ€§å…‰çº¤å†…çª¥é•œ', description: 'ç›´çº¿å‹æ£€æµ‹è®¾å¤‡', icon: 'fas fa-minus', weight: 2 }
                    ]
                },
                {
                    id: 'optical-endoscope',
                    title: 'å…‰å­¦å†…çª¥é•œ',
                    icon: 'fas fa-search',
                    description: 'ä¸“ä¸šå…‰å­¦å†…çª¥é•œè®¾å¤‡',
                    weight: 3,
                    subcategories: [
                        { id: 'rigid-optical', title: 'ç¡¬æ€§å…‰å­¦å†…çª¥é•œ', description: 'ä¼ ç»Ÿå…‰å­¦æ£€æµ‹è®¾å¤‡', icon: 'fas fa-binoculars', weight: 1 },
                        { id: 'flexible-optical', title: 'æŸ”æ€§å…‰å­¦å†…çª¥é•œ', description: 'å¼¯æ›²å…‰å­¦æ£€æµ‹è®¾å¤‡', icon: 'fas fa-eye-dropper', weight: 2 }
                    ]
                }
            ];
        }

        // åŠ è½½ä¾›åº”å•†
        async function loadSuppliers() {
            try {
                // ä¼˜å…ˆä½¿ç”¨ContentSyncManageråŒæ­¥åçš„æ•°æ®
                const syncedSuppliers = JSON.parse(localStorage.getItem('visndt_suppliers') || '[]');
                if (syncedSuppliers.length > 0) {
                    console.log(`âœ… åŠ è½½åŒæ­¥åçš„ä¾›åº”å•†æ•°æ®: ${syncedSuppliers.length} ä¸ªä¾›åº”å•†`);
                    return syncedSuppliers;
                }

                // å¦‚æœæ²¡æœ‰åŒæ­¥æ•°æ®ï¼Œè¿”å›é»˜è®¤æ•°æ®
                return [
                    {
                        id: 'vis',
                        title: 'å¤©æ´¥ç»´æ£®ç§‘æŠ€æœ‰é™å…¬å¸',
                        series: ['VIS-Pç³»åˆ—', 'VIS-Tç³»åˆ—']
                    },
                    {
                        id: 'vsndt',
                        title: 'æ·±åœ³å¸‚å¾®è§†å…‰ç”µç§‘æŠ€æœ‰é™å…¬å¸',
                        series: ['Kç³»åˆ—', 'Pç³»åˆ—', 'DZç³»åˆ—']
                    },
                    {
                        id: 'hs',
                        title: 'æ·±åœ³åè§†å†…çª¥é•œæœ‰é™å…¬å¸',
                        series: ['HS-Aç³»åˆ—', 'HS-Bç³»åˆ—']
                    }
                ];
            } catch (error) {
                console.error('åŠ è½½ä¾›åº”å•†æ•°æ®å¤±è´¥:', error);
                return [];
            }
        }

        // åŠ è½½æ‰€æœ‰äº§å“
        async function loadAllProducts() {
            try {
                // ä¼˜å…ˆä½¿ç”¨ContentSyncManageråŒæ­¥åçš„æ•°æ®
                const syncedProducts = JSON.parse(localStorage.getItem('visndt_products') || '[]');
                if (syncedProducts.length > 0) {
                    console.log(`âœ… åŠ è½½åŒæ­¥åçš„äº§å“æ•°æ®: ${syncedProducts.length} ä¸ªäº§å“`);
                    return syncedProducts;
                }

                // å¦‚æœæ²¡æœ‰åŒæ­¥æ•°æ®ï¼Œä½¿ç”¨ContentDataLoader
                if (typeof ContentDataLoader !== 'undefined') {
                    const dataLoader = new ContentDataLoader();
                    await dataLoader.loadAllData();
                    return dataLoader.contentData.products || [];
                } else {
                    // å¦‚æœContentDataLoaderä¸å¯ç”¨ï¼Œå°è¯•ç›´æ¥åŠ è½½
                    return await loadProductsDirectly();
                }
            } catch (error) {
                console.error('åŠ è½½äº§å“æ•°æ®å¤±è´¥:', error);
                return await loadProductsDirectly();
            }
        }

        // ç›´æ¥åŠ è½½äº§å“æ•°æ®
        async function loadProductsDirectly() {
            const products = [];

            // å·²çŸ¥çš„æ‰€æœ‰äº§å“æ–‡ä»¶åˆ—è¡¨
            const productFiles = [
                'WS-K08510-a', 'WS-K08510-b', 'WS-K09510-a', 'WS-K1010-a',
                'WS-K1210-a', 'WS-K1210-a copy', 'WS-K1210-a copy 6', 'WS-K1210-a copy 7',
                'WS-K1210-a copy 8', 'WS-K1210-a copy 9', 'WS-K1210-b',
                'WS-K1510-a', 'WS-K1510-b', 'WS-K1510-c', 'WS-K1810-a',
                'k1010-electronic-endoscope', 'product-dz60', 'product-p08510',
                'product-p09510', 'product-p1010-model', 'product-p1210',
                'product-p1510', 'product-p1810', 'product-p2010', 'product-p2210',
                'product-p2410', 'product-p2810', 'product-p3910', 'product-p6010',
                'product-p8020', 'sample-product-2', 'sample-product-3', 'test-product-001'
            ];

            console.log(`å¼€å§‹åŠ è½½ ${productFiles.length} ä¸ªäº§å“...`);

            for (const productId of productFiles) {
                try {
                    const product = await loadSingleProductData(productId);
                    if (product) {
                        products.push(product);
                        console.log(`âœ… åŠ è½½äº§å“: ${product.title}`);
                    }
                } catch (error) {
                    console.warn(`âŒ åŠ è½½äº§å“ ${productId} å¤±è´¥:`, error);
                    // ç”ŸæˆåŸºç¡€äº§å“æ•°æ®
                    const basicProduct = generateBasicProductData(productId);
                    products.push(basicProduct);
                }
            }

            console.log(`äº§å“åŠ è½½å®Œæˆ: ${products.length} ä¸ªäº§å“`);
            return products;
        }

        // åŠ è½½å•ä¸ªäº§å“æ•°æ®
        async function loadSingleProductData(productId) {
            try {
                // å°è¯•ä»äº§å“é¡µé¢åŠ è½½
                const response = await fetch(`/products/${productId}/`);
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}`);
                }

                const html = await response.text();
                const parser = new DOMParser();
                const doc = parser.parseFromString(html, 'text/html');

                // æå–äº§å“ä¿¡æ¯
                const title = doc.querySelector('h1')?.textContent?.trim() || productId;
                const summary = doc.querySelector('.product-summary, .lead')?.textContent?.trim() || '';

                // ä»é¡µé¢æå–è¯¦ç»†ä¿¡æ¯
                const detailsList = doc.querySelectorAll('.product-details-list li');
                let model = '', series = '', supplier = '', published = '';

                detailsList.forEach(li => {
                    const text = li.textContent;
                    if (text.includes('å‹å·ï¼š')) {
                        model = text.replace('å‹å·ï¼š', '').trim();
                    } else if (text.includes('ç³»åˆ—ï¼š')) {
                        series = text.replace('ç³»åˆ—ï¼š', '').trim();
                    } else if (text.includes('ä¾›åº”å•†ï¼š')) {
                        supplier = text.replace('ä¾›åº”å•†ï¼š', '').trim();
                    } else if (text.includes('å‘å¸ƒæ—¶é—´ï¼š')) {
                        published = text.replace('å‘å¸ƒæ—¶é—´ï¼š', '').trim();
                    }
                });

                // æå–å‚æ•°
                const parameters = extractParametersFromPage(doc);

                // æå–å›¾åº“
                const gallery = extractGalleryFromPage(doc);

                // æå–åº”ç”¨åœºæ™¯
                const applicationScenarios = extractApplicationScenariosFromPage(doc);

                // æå–èµ„æ–™ä¸‹è½½
                const dataDownload = extractDataDownloadFromPage(doc);

                return {
                    id: productId,
                    title: title,
                    summary: summary,
                    model: model || extractModelFromTitle(title),
                    series: series || extractSeriesFromTitle(title),
                    supplier: supplier || 'æ·±åœ³å¸‚å¾®è§†å…‰ç”µç§‘æŠ€æœ‰é™å…¬å¸',
                    primary_category: 'ç”µå­å†…çª¥é•œ',
                    secondary_category: getSecondaryCategory(productId),
                    status: 'published',
                    statusName: 'å·²å‘å¸ƒ',
                    published: published ? new Date(published).toISOString() : new Date().toISOString(),
                    thumbnail: gallery.length > 0 ? gallery[0].image : getDefaultThumbnail(series),
                    parameters: parameters,
                    gallery: gallery,
                    application_scenarios: applicationScenarios,
                    data_download: dataDownload,
                    related_products: [],
                    featured: Math.random() > 0.8,
                    tags: generateProductTags(model, series),
                    content: `# ${title}\n\n${summary}`
                };
            } catch (error) {
                console.warn(`æ— æ³•ä»é¡µé¢åŠ è½½äº§å“ ${productId}:`, error);
                return generateBasicProductData(productId);
            }
        }

        // ä»é¡µé¢æå–å‚æ•°
        function extractParametersFromPage(doc) {
            const parameters = [];

            // æŸ¥æ‰¾å‚æ•°è¡¨æ ¼æˆ–åˆ—è¡¨
            const paramElements = doc.querySelectorAll('.parameter-item, .spec-item, .product-spec tr, .parameters-table tr');

            paramElements.forEach(element => {
                const nameEl = element.querySelector('.param-name, .spec-name, td:first-child, .parameter-name');
                const valueEl = element.querySelector('.param-value, .spec-value, td:last-child, .parameter-value');

                if (nameEl && valueEl) {
                    const name = nameEl.textContent.trim().replace('ï¼š', '').replace(':', '');
                    const value = valueEl.textContent.trim();
                    if (name && value) {
                        parameters.push({ name, value });
                    }
                }
            });

            // å¦‚æœæ²¡æœ‰æ‰¾åˆ°å‚æ•°ï¼Œè¿”å›é»˜è®¤çš„ç”µå­å†…çª¥é•œå‚æ•°æ¨¡æ¿
            if (parameters.length === 0) {
                return getDefaultEndoscopeParameters();
            }

            return parameters;
        }

        // è·å–é»˜è®¤çš„ç”µå­å†…çª¥é•œå‚æ•°æ¨¡æ¿ï¼ˆ8ç§å‚æ•°ï¼‰
        function getDefaultEndoscopeParameters() {
            return [
                { name: "ä¸»æœºå±å¹•", value: "6è‹±å¯¸" },
                { name: "å¾…æœºæ—¶é•¿", value: "8å°æ—¶" },
                { name: "æ¢å¤´ç›´å¾„", value: "1.0mm" },
                { name: "åƒç´ ", value: "16ä¸‡" },
                { name: "æ™¯æ·±", value: "3mm~70mm" },
                { name: "è§†åœºè§’", value: "120åº¦" },
                { name: "è§†å‘", value: "ç›´è§†" },
                { name: "å…‰æº", value: "å…‰çº¤å…‰æº" }
            ];
        }

        // ä»é¡µé¢æå–å›¾åº“
        function extractGalleryFromPage(doc) {
            const gallery = [];

            // æŸ¥æ‰¾ä¸»å›¾
            const mainImage = doc.querySelector('.main-product-image, .product-main-image, #main-product-image');
            if (mainImage) {
                gallery.push({
                    image: mainImage.src,
                    alt: mainImage.alt || 'ä¸»å›¾',
                    is_main: true
                });
            }

            // æŸ¥æ‰¾ç¼©ç•¥å›¾
            const thumbnails = doc.querySelectorAll('.thumbnail-image, .gallery-thumb, .product-thumb');
            thumbnails.forEach((thumb, index) => {
                if (thumb.src && thumb.src !== mainImage?.src) {
                    gallery.push({
                        image: thumb.getAttribute('data-full-image') || thumb.src,
                        alt: thumb.alt || `å‰¯å›¾${index + 1}`,
                        is_main: false
                    });
                }
            });

            return gallery;
        }

        // ä»é¡µé¢æå–åº”ç”¨åœºæ™¯
        function extractApplicationScenariosFromPage(doc) {
            const scenarioElements = doc.querySelectorAll('.application-scenarios, .product-applications, .scenarios-content');
            if (scenarioElements.length > 0) {
                return scenarioElements[0].innerHTML;
            }
            return '';
        }

        // ä»é¡µé¢æå–èµ„æ–™ä¸‹è½½
        function extractDataDownloadFromPage(doc) {
            const downloads = [];
            const downloadLinks = doc.querySelectorAll('.download-link, .data-download a, .product-downloads a');

            downloadLinks.forEach(link => {
                const title = link.textContent.trim() || link.getAttribute('title') || 'äº§å“èµ„æ–™';
                const path = link.href;
                if (path) {
                    downloads.push({
                        file_title: title,
                        file_path: path
                    });
                }
            });

            return downloads;
        }

        // ç”ŸæˆåŸºç¡€äº§å“æ•°æ®
        function generateBasicProductData(productId) {
            const title = generateProductTitle(productId);
            const model = extractModelFromTitle(title);
            const series = extractSeriesFromTitle(title);

            return {
                id: productId,
                title: title,
                summary: `${model} å·¥ä¸šå†…çª¥é•œï¼Œä¸“ä¸šæ£€æµ‹è®¾å¤‡`,
                model: model,
                series: series,
                supplier: 'æ·±åœ³å¸‚å¾®è§†å…‰ç”µç§‘æŠ€æœ‰é™å…¬å¸',
                primary_category: 'ç”µå­å†…çª¥é•œ',
                secondary_category: getSecondaryCategory(productId),
                status: 'published',
                statusName: 'å·²å‘å¸ƒ',
                published: new Date().toISOString(),
                thumbnail: getDefaultThumbnail(series),
                parameters: getDefaultEndoscopeParameters(),
                gallery: [
                    { image: getDefaultThumbnail(series), alt: "ä¸»å›¾", is_main: true }
                ],
                application_scenarios: `${model} ä¸“ä¸šå·¥ä¸šæ£€æµ‹è§£å†³æ–¹æ¡ˆ`,
                data_download: [],
                related_products: [],
                featured: Math.random() > 0.8,
                tags: generateProductTags(model, series),
                content: `# ${title}\n\n${model} æ˜¯ä¸€æ¬¾ä¸“ä¸šçš„å·¥ä¸šå†…çª¥é•œè®¾å¤‡ã€‚`
            };
        }

        // ç”Ÿæˆäº§å“æ ‡é¢˜
        function generateProductTitle(productId) {
            if (productId.startsWith('WS-K')) {
                const model = extractModelFromTitle('', productId);
                return `${model}è¶…ç»†å·¥ä¸šç”µå­å†…çª¥é•œ`;
            } else if (productId.startsWith('product-p')) {
                const model = extractModelFromTitle('', productId);
                return `${model}å·¥ä¸šå†…çª¥é•œ`;
            } else if (productId.includes('dz')) {
                return 'DZ60çˆ¬è¡Œæœºå™¨äºº';
            } else if (productId.includes('sample')) {
                return `æ ·å“äº§å“ ${productId.replace('sample-product-', '')}`;
            } else if (productId.includes('test')) {
                return `æµ‹è¯•äº§å“ ${productId.replace('test-product-', '')}`;
            } else {
                const model = extractModelFromTitle('', productId);
                return `${model}å·¥ä¸šå†…çª¥é•œ`;
            }
        }

        // ä»æ ‡é¢˜æˆ–IDæå–å‹å·
        function extractModelFromTitle(title, productId = '') {
            if (title) {
                const match = title.match(/([A-Z]{1,3}-?[A-Z]?\d{4,5}[A-Z]?)/);
                if (match) return match[1];
            }

            if (productId) {
                if (productId.startsWith('WS-')) {
                    return productId.split('-').slice(0, 2).join('-');
                } else if (productId.startsWith('product-')) {
                    const parts = productId.replace('product-', '').toUpperCase();
                    return parts.includes('P') ? parts : `P${parts}`;
                }
            }

            return 'MODEL-001';
        }

        // ä»æ ‡é¢˜æˆ–IDæå–ç³»åˆ—
        function extractSeriesFromTitle(title, productId = '') {
            if (title && title.includes('K')) return 'Kç³»åˆ—';
            if (title && title.includes('P')) return 'Pç³»åˆ—';
            if (title && title.includes('DZ')) return 'DZç³»åˆ—';

            if (productId) {
                if (productId.includes('K') || productId.includes('k')) return 'Kç³»åˆ—';
                if (productId.includes('p') || productId.includes('P')) return 'Pç³»åˆ—';
                if (productId.includes('dz') || productId.includes('DZ')) return 'DZç³»åˆ—';
            }

            return 'Kç³»åˆ—';
        }

        // è·å–æ¬¡çº§åˆ†ç±»
        function getSecondaryCategory(productId) {
            if (productId.includes('dz') || productId.includes('robot')) {
                return 'çˆ¬è¡Œæœºå™¨äºº';
            } else if (productId.includes('sample') || productId.includes('test')) {
                return 'æµ‹è¯•äº§å“';
            } else {
                return 'å·¥ä¸šè§†é¢‘å†…çª¥é•œ';
            }
        }

        // è·å–é»˜è®¤ç¼©ç•¥å›¾
        function getDefaultThumbnail(series) {
            switch(series) {
                case 'Kç³»åˆ—': return '/images/products/K-series/K-main.jpg';
                case 'Pç³»åˆ—': return '/images/products/P-series/P-main.jpg';
                case 'DZç³»åˆ—': return '/images/products/DZ-series/DZ-main.jpg';
                default: return '/images/products/default-product.jpg';
            }
        }

        // ç”Ÿæˆäº§å“æ ‡ç­¾
        function generateProductTags(model, series) {
            const tags = [series];

            if (model.includes('K08') || model.includes('K09')) {
                tags.push('è¶…ç»†æ¢å¤´', 'é«˜æ¸…æˆåƒ');
            } else if (model.includes('P')) {
                tags.push('ç»æµå‹', 'æ€§ä»·æ¯”');
            } else if (model.includes('DZ')) {
                tags.push('çˆ¬è¡Œæœºå™¨äºº', 'è¿œç¨‹æ“æ§');
            }

            tags.push('å·¥ä¸šçº§');
            return tags;
        }

        // ä¾§è¾¹æ åŠŸèƒ½
        function toggleSection(sectionId) {
            const section = document.getElementById(sectionId + '-section');
            const header = section.previousElementSibling;
            const icon = header.querySelector('i.fa-chevron-down, i.fa-chevron-up');

            section.classList.toggle('collapsed');

            if (section.classList.contains('collapsed')) {
                icon.className = 'fas fa-chevron-up';
            } else {
                icon.className = 'fas fa-chevron-down';
            }
        }

        // æ˜¾ç¤ºé€šçŸ¥
        function showNotification(message, type = 'info') {
            const toast = document.getElementById('notificationToast');
            const body = document.getElementById('notificationBody');

            body.textContent = message;

            // è®¾ç½®å›¾æ ‡å’Œé¢œè‰²
            const header = toast.querySelector('.toast-header');
            const icon = header.querySelector('i');

            switch (type) {
                case 'success':
                    icon.className = 'fas fa-check-circle me-2 text-success';
                    break;
                case 'warning':
                    icon.className = 'fas fa-exclamation-triangle me-2 text-warning';
                    break;
                case 'danger':
                    icon.className = 'fas fa-exclamation-circle me-2 text-danger';
                    break;
                default:
                    icon.className = 'fas fa-info-circle me-2 text-info';
            }

            const bsToast = new bootstrap.Toast(toast);
            bsToast.show();
        }

        // äº§å“ç®¡ç†åŠŸèƒ½
        async function showProductsList() {
            currentSection = 'products';

            // æ›´æ–°å¤´éƒ¨
            document.getElementById('contentTitle').textContent = 'äº§å“ç®¡ç†';
            document.getElementById('contentSubtitle').innerHTML = 'ç®¡ç†äº§å“ä¿¡æ¯ï¼ŒåŒ…æ‹¬äº§å“è¯¦æƒ…ã€æŠ€æœ¯å‚æ•°ã€ä¾›åº”å•†ç­‰<br><small class="text-info"><i class="fas fa-info-circle me-1"></i>æç¤ºï¼šä¿å­˜äº§å“åä¼šè‡ªåŠ¨ä¸‹è½½Hugo markdownæ–‡ä»¶ï¼Œè¯·å°†æ–‡ä»¶æ”¾å…¥ content/products/ ç›®å½•</small>';

            // æ›´æ–°æ“ä½œæŒ‰é’®
            const actionsHtml = `
                <button class="btn btn-primary" onclick="addProduct()">
                    <i class="fas fa-plus me-1"></i>æ·»åŠ äº§å“
                </button>
                <button class="btn btn-success" onclick="showImportExport()">
                    <i class="fas fa-file-import me-1"></i>å¯¼å…¥äº§å“
                </button>
                <button class="btn btn-warning" onclick="exportProducts()">
                    <i class="fas fa-file-export me-1"></i>å¯¼å‡ºäº§å“
                </button>
                <button class="btn btn-info" onclick="generateHugoFiles()">
                    <i class="fas fa-code me-1"></i>ç”ŸæˆHugoæ–‡ä»¶
                </button>
                <button class="btn btn-secondary" onclick="debugProductData()">
                    <i class="fas fa-bug me-1"></i>è°ƒè¯•æ•°æ®
                </button>
            `;
            document.getElementById('contentActions').innerHTML = actionsHtml;

            // åŠ è½½äº§å“æ•°æ®
            try {
                currentData = await loadAllProducts();
                filteredData = [...currentData];
                currentPage = 1; // é‡ç½®åˆ°ç¬¬ä¸€é¡µ
                renderProductsList();
            } catch (error) {
                console.error('åŠ è½½äº§å“åˆ—è¡¨å¤±è´¥:', error);
                showNotification('äº§å“åˆ—è¡¨åŠ è½½å¤±è´¥: ' + error.message, 'danger');
            }
        }

        // æ¸²æŸ“äº§å“åˆ—è¡¨
        function renderProductsList() {
            const contentBody = document.getElementById('contentBody');

            const toolbarHtml = `
                <div class="list-toolbar">
                    <div class="toolbar-left">
                        <div class="filter-group">
                            <select class="form-select form-select-sm filter-select" id="supplierFilter" onchange="filterBySupplier()">
                                <option value="">æ‰€æœ‰ä¾›åº”å•†</option>
                                ${getUniqueSuppliers().map(supplier => `<option value="${supplier}">${supplier}</option>`).join('')}
                            </select>
                            <select class="form-select form-select-sm filter-select" id="categoryFilter" onchange="filterByCategory()">
                                <option value="">æ‰€æœ‰åˆ†ç±»</option>
                                ${getUniqueCategories().map(category => `<option value="${category}">${category}</option>`).join('')}
                            </select>
                            <select class="form-select form-select-sm filter-select" id="statusFilter" onchange="filterByStatus()">
                                <option value="">æ‰€æœ‰çŠ¶æ€</option>
                                <option value="published">å·²å‘å¸ƒ</option>
                                <option value="draft">è‰ç¨¿</option>
                            </select>
                            <button class="btn btn-outline-secondary btn-sm" onclick="clearAllFilters()" title="æ¸…ç©ºç­›é€‰">
                                <i class="fas fa-times"></i>
                            </button>
                        </div>
                        <!-- å½“å‰ç­›é€‰çŠ¶æ€æ˜¾ç¤º -->
                        <div id="filterStatus" class="filter-status mt-2" style="display: none;">
                            <small class="text-muted">å½“å‰ç­›é€‰: </small>
                            <span id="filterTags"></span>
                        </div>
                    </div>
                    <div class="toolbar-right">
                        <div class="search-box">
                            <input type="text" class="search-input" id="productSearch" placeholder="æœç´¢äº§å“..." onkeyup="searchProducts()">
                            <i class="search-icon fas fa-search"></i>
                        </div>
                        <span class="badge bg-secondary">${filteredData.length} ä¸ªäº§å“</span>
                    </div>
                </div>
            `;

            // è·å–å½“å‰é¡µæ•°æ®
            const currentPageData = getCurrentPageData();

            const tableHtml = `
                <table class="content-table">
                    <thead>
                        <tr>
                            <th>äº§å“ç¼–å·</th>
                            <th>äº§å“åç§°</th>
                            <th>å‹å·</th>
                            <th>ä¾›åº”å•†</th>
                            <th>åˆ†ç±»</th>
                            <th>ç³»åˆ—</th>
                            <th>çŠ¶æ€</th>
                            <th>å‘å¸ƒæ—¶é—´</th>
                            <th>æ“ä½œ</th>
                        </tr>
                    </thead>
                    <tbody>
                        ${currentPageData.map(product => `
                            <tr>
                                <td>${product.id || 'æœªè®¾ç½®'}</td>
                                <td>
                                    <div class="d-flex align-items-center">
                                        <img src="${product.thumbnail || '/images/products/default-product.jpg'}"
                                             alt="${product.title}"
                                             style="width: 40px; height: 40px; object-fit: cover; border-radius: 4px; margin-right: 10px;">
                                        <div>
                                            <div class="fw-bold">${product.title}</div>
                                            <small class="text-muted">${product.summary || ''}</small>
                                        </div>
                                    </div>
                                </td>
                                <td>${product.model || ''}</td>
                                <td>${product.supplier || ''}</td>
                                <td>
                                    <span class="badge bg-primary">${product.primary_category || ''}</span>
                                    ${product.secondary_category ? `<br><span class="badge bg-secondary mt-1">${product.secondary_category}</span>` : ''}
                                </td>
                                <td>${product.series || ''}</td>
                                <td>
                                    <span class="status-badge ${product.status === 'published' ? 'status-published' : 'status-draft'}">
                                        ${product.statusName || product.status || 'è‰ç¨¿'}
                                    </span>
                                </td>
                                <td>${product.published ? new Date(product.published).toLocaleDateString() : ''}</td>
                                <td>
                                    <div class="action-buttons">
                                        <button class="action-btn view" onclick="viewProduct('${product.id}')" title="æŸ¥çœ‹">
                                            <i class="fas fa-eye"></i>
                                        </button>
                                        <button class="action-btn edit" onclick="editProduct('${product.id}')" title="ç¼–è¾‘">
                                            <i class="fas fa-edit"></i>
                                        </button>
                                        <button class="action-btn" onclick="copyProduct('${product.id}')" title="å¤åˆ¶">
                                            <i class="fas fa-copy"></i>
                                        </button>
                                        <button class="action-btn delete" onclick="deleteProduct('${product.id}')" title="åˆ é™¤">
                                            <i class="fas fa-trash"></i>
                                        </button>
                                    </div>
                                </td>
                            </tr>
                        `).join('')}
                    </tbody>
                </table>
            `;

            // ç”Ÿæˆåˆ†é¡µæ§ä»¶
            const paginationHtml = renderPagination();

            contentBody.innerHTML = toolbarHtml + tableHtml + paginationHtml;

            // è®¾ç½®æ´»åŠ¨çŠ¶æ€
            document.querySelectorAll('.sidebar-item').forEach(item => item.classList.remove('active'));
            document.querySelector('.sidebar-item[onclick="showProductsList()"]').classList.add('active');
        }

        // è°ƒè¯•äº§å“æ•°æ®
        function debugProductData() {
            console.log('=== äº§å“æ•°æ®è°ƒè¯•ä¿¡æ¯ ===');
            console.log('å½“å‰æ•°æ®æ•°é‡:', currentData.length);
            console.log('ç­›é€‰åæ•°æ®æ•°é‡:', filteredData.length);
            console.log('ä¾›åº”å•†åˆ—è¡¨:', suppliers);
            console.log('äº§å“åˆ†ç±»åˆ—è¡¨:', productCategories);

            if (currentData.length > 0) {
                console.log('ç¬¬ä¸€ä¸ªäº§å“æ•°æ®ç»“æ„:', currentData[0]);
                console.log('äº§å“å­—æ®µ:', Object.keys(currentData[0]));

                // ç»Ÿè®¡ä¾›åº”å•†
                const supplierStats = {};
                const categoryStats = {};
                currentData.forEach(product => {
                    supplierStats[product.supplier] = (supplierStats[product.supplier] || 0) + 1;
                    categoryStats[product.primary_category] = (categoryStats[product.primary_category] || 0) + 1;
                });
                console.log('å®é™…ä¾›åº”å•†åˆ†å¸ƒ:', supplierStats);
                console.log('å®é™…åˆ†ç±»åˆ†å¸ƒ:', categoryStats);
            }

            // æ˜¾ç¤ºè°ƒè¯•ä¿¡æ¯
            const debugInfo = `
                <div class="modal fade" id="debugModal" tabindex="-1">
                    <div class="modal-dialog modal-lg">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h5 class="modal-title">äº§å“æ•°æ®è°ƒè¯•ä¿¡æ¯</h5>
                                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                            </div>
                            <div class="modal-body">
                                <h6>æ•°æ®ç»Ÿè®¡</h6>
                                <p>å½“å‰æ•°æ®æ•°é‡: ${currentData.length}</p>
                                <p>ç­›é€‰åæ•°æ®æ•°é‡: ${filteredData.length}</p>

                                ${currentData.length > 0 ? `
                                    <h6>ç¤ºä¾‹äº§å“æ•°æ®</h6>
                                    <pre style="background: #f8f9fa; padding: 1rem; border-radius: 0.375rem; font-size: 0.875rem;">
${JSON.stringify(currentData[0], null, 2)}
                                    </pre>
                                ` : '<p>æš‚æ— äº§å“æ•°æ®</p>'}
                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">å…³é—­</button>
                            </div>
                        </div>
                    </div>
                </div>
            `;

            // ç§»é™¤å·²å­˜åœ¨çš„æ¨¡æ€æ¡†
            const existingModal = document.getElementById('debugModal');
            if (existingModal) {
                existingModal.remove();
            }

            // æ·»åŠ æ–°æ¨¡æ€æ¡†
            document.body.insertAdjacentHTML('beforeend', debugInfo);
            const modal = new bootstrap.Modal(document.getElementById('debugModal'));
            modal.show();
        }

        // ç­›é€‰åŠŸèƒ½
        function filterBySupplier() {
            const supplierFilter = document.getElementById('supplierFilter').value;
            applyFilters();
        }

        function filterByCategory() {
            const categoryFilter = document.getElementById('categoryFilter').value;
            applyFilters();
        }

        function filterByStatus() {
            const statusFilter = document.getElementById('statusFilter').value;
            applyFilters();
        }

        function searchProducts() {
            const searchTerm = document.getElementById('productSearch').value.toLowerCase();
            applyFilters();
        }

        function applyFilters() {
            const supplierFilter = document.getElementById('supplierFilter')?.value || '';
            const categoryFilter = document.getElementById('categoryFilter')?.value || '';
            const statusFilter = document.getElementById('statusFilter')?.value || '';
            const searchTerm = document.getElementById('productSearch')?.value.toLowerCase() || '';

            // æ›´æ–°ç­›é€‰çŠ¶æ€æ˜¾ç¤º
            updateFilterStatus(supplierFilter, categoryFilter, statusFilter, searchTerm);

            // å¦‚æœæ²¡æœ‰ä»»ä½•ç­›é€‰æ¡ä»¶ï¼Œæ˜¾ç¤ºæ‰€æœ‰æ•°æ®
            if (!supplierFilter && !categoryFilter && !statusFilter && !searchTerm) {
                filteredData = [...currentData];
                currentPage = 1; // é‡ç½®åˆ°ç¬¬ä¸€é¡µ
                renderProductsList();
                return;
            }

            filteredData = currentData.filter(product => {
                // ä¾›åº”å•†ç­›é€‰
                const matchesSupplier = !supplierFilter ||
                    (product.supplier && product.supplier.includes(supplierFilter));

                // åˆ†ç±»ç­›é€‰
                const matchesCategory = !categoryFilter ||
                    (product.primary_category && product.primary_category.includes(categoryFilter));

                // çŠ¶æ€ç­›é€‰ - æ ¹æ®publishedå­—æ®µåˆ¤æ–­
                let matchesStatus = true;
                if (statusFilter) {
                    if (statusFilter === 'published') {
                        matchesStatus = product.published && product.published !== 'false' && product.published !== false;
                    } else if (statusFilter === 'draft') {
                        matchesStatus = !product.published || product.published === 'false' || product.published === false;
                    }
                }

                // æœç´¢ç­›é€‰
                const matchesSearch = !searchTerm ||
                    (product.title && product.title.toLowerCase().includes(searchTerm)) ||
                    (product.model && product.model.toLowerCase().includes(searchTerm)) ||
                    (product.id && product.id.toLowerCase().includes(searchTerm)) ||
                    (product.summary && product.summary.toLowerCase().includes(searchTerm)) ||
                    (product.supplier && product.supplier.toLowerCase().includes(searchTerm)) ||
                    (product.primary_category && product.primary_category.toLowerCase().includes(searchTerm));

                return matchesSupplier && matchesCategory && matchesStatus && matchesSearch;
            });

            currentPage = 1; // é‡ç½®åˆ°ç¬¬ä¸€é¡µ
            renderProductsList();
        }

        // æ›´æ–°ç­›é€‰çŠ¶æ€æ˜¾ç¤º
        function updateFilterStatus(supplier, category, status, search) {
            const filterStatus = document.getElementById('filterStatus');
            const filterTags = document.getElementById('filterTags');

            if (!filterStatus || !filterTags) return;

            const tags = [];

            if (supplier) {
                tags.push(`<span class="filter-tag">ä¾›åº”å•†: ${supplier} <span class="remove" onclick="clearFilter('supplier')">&times;</span></span>`);
            }
            if (category) {
                tags.push(`<span class="filter-tag">åˆ†ç±»: ${category} <span class="remove" onclick="clearFilter('category')">&times;</span></span>`);
            }
            if (status) {
                const statusText = status === 'published' ? 'å·²å‘å¸ƒ' : 'è‰ç¨¿';
                tags.push(`<span class="filter-tag">çŠ¶æ€: ${statusText} <span class="remove" onclick="clearFilter('status')">&times;</span></span>`);
            }
            if (search) {
                tags.push(`<span class="filter-tag">æœç´¢: ${search} <span class="remove" onclick="clearFilter('search')">&times;</span></span>`);
            }

            if (tags.length > 0) {
                filterTags.innerHTML = tags.join('');
                filterStatus.style.display = 'block';
            } else {
                filterStatus.style.display = 'none';
            }
        }

        // æ¸…é™¤å•ä¸ªç­›é€‰æ¡ä»¶
        function clearFilter(type) {
            switch (type) {
                case 'supplier':
                    document.getElementById('supplierFilter').value = '';
                    break;
                case 'category':
                    document.getElementById('categoryFilter').value = '';
                    break;
                case 'status':
                    document.getElementById('statusFilter').value = '';
                    break;
                case 'search':
                    document.getElementById('productSearch').value = '';
                    break;
            }
            applyFilters();
        }

        // æ¸…ç©ºæ‰€æœ‰ç­›é€‰æ¡ä»¶
        function clearAllFilters() {
            document.getElementById('supplierFilter').value = '';
            document.getElementById('categoryFilter').value = '';
            document.getElementById('statusFilter').value = '';
            document.getElementById('productSearch').value = '';
            applyFilters();
        }

        // è·å–å”¯ä¸€ä¾›åº”å•†åˆ—è¡¨
        function getUniqueSuppliers() {
            const suppliers = [...new Set(currentData
                .map(product => product.supplier)
                .filter(supplier => supplier && supplier.trim() !== ''))];
            return suppliers.sort();
        }

        // è·å–å”¯ä¸€åˆ†ç±»åˆ—è¡¨
        function getUniqueCategories() {
            const categories = [...new Set(currentData
                .map(product => product.primary_category)
                .filter(category => category && category.trim() !== ''))];
            return categories.sort();
        }

        // åˆ†é¡µåŠŸèƒ½
        function getCurrentPageData() {
            const startIndex = (currentPage - 1) * ITEMS_PER_PAGE;
            const endIndex = startIndex + ITEMS_PER_PAGE;
            return filteredData.slice(startIndex, endIndex);
        }

        function getTotalPages() {
            return Math.ceil(filteredData.length / ITEMS_PER_PAGE);
        }

        function goToPage(page) {
            const totalPages = getTotalPages();
            if (page < 1 || page > totalPages) return;

            currentPage = page;
            renderProductsList();
        }

        function goToPreviousPage() {
            if (currentPage > 1) {
                goToPage(currentPage - 1);
            }
        }

        function goToNextPage() {
            const totalPages = getTotalPages();
            if (currentPage < totalPages) {
                goToPage(currentPage + 1);
            }
        }

        function renderPagination() {
            const totalPages = getTotalPages();
            if (totalPages <= 1) {
                return '';
            }

            let paginationHtml = `
                <div class="pagination-container mt-3">
                    <nav aria-label="äº§å“åˆ—è¡¨åˆ†é¡µ">
                        <ul class="pagination justify-content-center">
            `;

            // ä¸Šä¸€é¡µæŒ‰é’®
            if (currentPage > 1) {
                paginationHtml += `
                    <li class="page-item">
                        <a class="page-link" href="#" onclick="goToPreviousPage()" aria-label="ä¸Šä¸€é¡µ">
                            <span aria-hidden="true">&laquo;</span>
                        </a>
                    </li>
                `;
            }

            // é¡µç æŒ‰é’®
            const maxVisiblePages = 5;
            let startPage = Math.max(1, currentPage - Math.floor(maxVisiblePages / 2));
            let endPage = Math.min(totalPages, startPage + maxVisiblePages - 1);

            if (endPage - startPage + 1 < maxVisiblePages) {
                startPage = Math.max(1, endPage - maxVisiblePages + 1);
            }

            for (let i = startPage; i <= endPage; i++) {
                paginationHtml += `
                    <li class="page-item ${i === currentPage ? 'active' : ''}">
                        <a class="page-link" href="#" onclick="goToPage(${i})">${i}</a>
                    </li>
                `;
            }

            // ä¸‹ä¸€é¡µæŒ‰é’®
            if (currentPage < totalPages) {
                paginationHtml += `
                    <li class="page-item">
                        <a class="page-link" href="#" onclick="goToNextPage()" aria-label="ä¸‹ä¸€é¡µ">
                            <span aria-hidden="true">&raquo;</span>
                        </a>
                    </li>
                `;
            }

            paginationHtml += `
                        </ul>
                    </nav>
                    <div class="pagination-info text-center mt-2">
                        <small class="text-muted">
                            æ˜¾ç¤ºç¬¬ ${(currentPage - 1) * ITEMS_PER_PAGE + 1}-${Math.min(currentPage * ITEMS_PER_PAGE, filteredData.length)} æ¡ï¼Œ
                            å…± ${filteredData.length} æ¡è®°å½•ï¼Œç¬¬ ${currentPage} é¡µï¼Œå…± ${totalPages} é¡µ
                        </small>
                    </div>
                </div>
            `;

            return paginationHtml;
        }

        // äº§å“æ“ä½œåŠŸèƒ½
        function addProduct() {
            editingProduct = null;
            document.getElementById('productModalLabel').textContent = 'æ·»åŠ äº§å“';
            resetProductForm();
            generateProductId();
            const modal = new bootstrap.Modal(document.getElementById('productModal'));
            modal.show();
        }

        function editProduct(productId) {
            const product = currentData.find(p => p.id === productId);
            if (!product) {
                showNotification('äº§å“ä¸å­˜åœ¨', 'danger');
                return;
            }

            editingProduct = product;
            document.getElementById('productModalLabel').textContent = 'ç¼–è¾‘äº§å“';
            fillProductForm(product);
            const modal = new bootstrap.Modal(document.getElementById('productModal'));
            modal.show();
        }

        function viewProduct(productId) {
            const product = currentData.find(p => p.id === productId);
            if (!product) {
                showNotification('äº§å“ä¸å­˜åœ¨', 'danger');
                return;
            }

            // åœ¨æ–°çª—å£ä¸­æ‰“å¼€äº§å“è¯¦æƒ…é¡µ
            const productUrl = `/products/${productId}`;
            window.open(productUrl, '_blank');
        }

        function copyProduct(productId) {
            const product = currentData.find(p => p.id === productId);
            if (!product) {
                showNotification('äº§å“ä¸å­˜åœ¨', 'danger');
                return;
            }

            editingProduct = null;
            document.getElementById('productModalLabel').textContent = 'å¤åˆ¶äº§å“';

            // åˆ›å»ºäº§å“å‰¯æœ¬å¹¶å¤„ç†æ–‡ä»¶å¤åˆ¶
            const newProductData = {
                ...product,
                id: '', // å°†ç”Ÿæˆæ–°ID
                title: product.title + ' (å‰¯æœ¬)'
            };

            // å¤„ç†æ–‡ä»¶å¤åˆ¶
            const processedProduct = copyProductFiles(product, newProductData);

            fillProductForm(processedProduct);
            generateProductId(); // ç”Ÿæˆæ–°çš„äº§å“ç¼–å·
            document.getElementById('productTitle').value = processedProduct.title;
            const modal = new bootstrap.Modal(document.getElementById('productModal'));
            modal.show();
        }

        async function deleteProduct(productId) {
            const product = currentData.find(p => p.id === productId);
            if (!product) {
                showNotification('äº§å“ä¸å­˜åœ¨', 'danger');
                return;
            }

            if (confirm(`ç¡®å®šè¦åˆ é™¤äº§å“ "${product.title}" å—ï¼Ÿæ­¤æ“ä½œä¸å¯æ¢å¤ã€‚`)) {
                try {
                    // è°ƒç”¨APIåˆ é™¤äº§å“
                    const result = await window.ProductAPI.deleteProduct(productId);

                    if (result.success) {
                        // ä»å†…å­˜ä¸­åˆ é™¤
                        currentData = currentData.filter(p => p.id !== productId);
                        filteredData = filteredData.filter(p => p.id !== productId);
                        allProducts = allProducts.filter(p => p.id !== productId);

                        renderProductsList();
                        updateRelatedProductsOptions();
                        showNotification(result.message || 'äº§å“åˆ é™¤æˆåŠŸ', 'success');

                        // æ˜¾ç¤ºåˆ é™¤æŒ‡å¯¼
                        if (result.deleteInstructions && result.deleteInstructions.length > 0) {
                            showDeleteInstructions(result.deleteInstructions);
                        }
                    } else {
                        showNotification(result.message || 'äº§å“åˆ é™¤å¤±è´¥', 'danger');
                    }
                } catch (error) {
                    console.error('åˆ é™¤äº§å“å¤±è´¥:', error);
                    showNotification('åˆ é™¤äº§å“å¤±è´¥: ' + error.message, 'danger');
                }
            }
        }

        // æ˜¾ç¤ºåˆ é™¤æŒ‡å¯¼
        function showDeleteInstructions(instructions) {
            const modalHtml = `
                <div class="modal fade" id="deleteInstructionsModal" tabindex="-1">
                    <div class="modal-dialog">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h5 class="modal-title">
                                    <i class="fas fa-info-circle text-warning me-2"></i>
                                    åˆ é™¤æŒ‡å¯¼
                                </h5>
                                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                            </div>
                            <div class="modal-body">
                                <div class="alert alert-warning">
                                    <i class="fas fa-exclamation-triangle me-2"></i>
                                    äº§å“å·²ä»ç³»ç»Ÿä¸­åˆ é™¤ï¼Œä½†ç›¸å…³æ–‡ä»¶éœ€è¦æ‰‹åŠ¨åˆ é™¤ï¼š
                                </div>
                                <div class="delete-instructions">
                                    ${instructions.map(instruction => `<div class="mb-1">${instruction}</div>`).join('')}
                                </div>
                                <div class="mt-3">
                                    <small class="text-muted">
                                        <i class="fas fa-lightbulb me-1"></i>
                                        æç¤ºï¼šè¯·åœ¨é¡¹ç›®ç›®å½•ä¸­æ‰‹åŠ¨åˆ é™¤ä¸Šè¿°æ–‡ä»¶ï¼Œä»¥ä¿æŒé¡¹ç›®æ•´æ´ã€‚
                                    </small>
                                </div>
                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-primary" data-bs-dismiss="modal">æˆ‘çŸ¥é“äº†</button>
                            </div>
                        </div>
                    </div>
                </div>
            `;

            // ç§»é™¤å·²å­˜åœ¨çš„æ¨¡æ€æ¡†
            const existingModal = document.getElementById('deleteInstructionsModal');
            if (existingModal) {
                existingModal.remove();
            }

            // æ·»åŠ æ–°æ¨¡æ€æ¡†
            document.body.insertAdjacentHTML('beforeend', modalHtml);

            // æ˜¾ç¤ºæ¨¡æ€æ¡†
            const modal = new bootstrap.Modal(document.getElementById('deleteInstructionsModal'));
            modal.show();

            // æ¨¡æ€æ¡†å…³é—­åç§»é™¤DOM
            document.getElementById('deleteInstructionsModal').addEventListener('hidden.bs.modal', function() {
                this.remove();
            });
        }

        // æ˜¾ç¤ºæ–‡ä»¶ä¿å­˜æŒ‡å¯¼
        function showFileInstructions(title, instructions) {
            const modalHtml = `
                <div class="modal fade" id="fileInstructionsModal" tabindex="-1">
                    <div class="modal-dialog">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h5 class="modal-title">
                                    <i class="fas fa-info-circle text-info me-2"></i>
                                    ${title}
                                </h5>
                                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                            </div>
                            <div class="modal-body">
                                <div class="alert alert-info">
                                    <i class="fas fa-lightbulb me-2"></i>
                                    è¯·æŒ‰ç…§ä»¥ä¸‹æ­¥éª¤ä¿å­˜æ–‡ä»¶ï¼š
                                </div>
                                <div class="file-instructions">
                                    ${instructions.map(instruction => `<div class="mb-2">${instruction}</div>`).join('')}
                                </div>
                                <div class="mt-3">
                                    <small class="text-muted">
                                        <i class="fas fa-exclamation-triangle me-1"></i>
                                        æ³¨æ„ï¼šè¯·ç¡®ä¿æ–‡ä»¶è·¯å¾„å’Œæ–‡ä»¶åå®Œå…¨æ­£ç¡®ï¼Œä»¥ä¿è¯ç½‘ç«™æ­£å¸¸æ˜¾ç¤ºã€‚
                                    </small>
                                </div>
                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-primary" data-bs-dismiss="modal">æˆ‘çŸ¥é“äº†</button>
                            </div>
                        </div>
                    </div>
                </div>
            `;

            // ç§»é™¤å·²å­˜åœ¨çš„æ¨¡æ€æ¡†
            const existingModal = document.getElementById('fileInstructionsModal');
            if (existingModal) {
                existingModal.remove();
            }

            // æ·»åŠ æ–°æ¨¡æ€æ¡†
            document.body.insertAdjacentHTML('beforeend', modalHtml);

            // æ˜¾ç¤ºæ¨¡æ€æ¡†
            const modal = new bootstrap.Modal(document.getElementById('fileInstructionsModal'));
            modal.show();

            // æ¨¡æ€æ¡†å…³é—­åç§»é™¤DOM
            document.getElementById('fileInstructionsModal').addEventListener('hidden.bs.modal', function() {
                this.remove();
            });
        }

        // è¡¨å•æ“ä½œ
        function resetProductForm() {
            document.getElementById('productForm').reset();

            // é‡ç½®å‚æ•°å®¹å™¨
            document.getElementById('parametersContainer').innerHTML = '';
            loadDefaultParameters();

            // é‡ç½®èµ„æ–™ä¸‹è½½å®¹å™¨
            document.getElementById('dataDownloadContainer').innerHTML = '';

            // é‡ç½®ç›¸å…³äº§å“åˆ—è¡¨
            document.getElementById('relatedProductsList').innerHTML = '';

            // é‡ç½®å›¾åº“å®¹å™¨
            document.getElementById('galleryContainer').innerHTML = `
                <div class="col-md-3 mb-3">
                    <div class="image-upload-area" onclick="addGalleryImage()">
                        <div class="upload-placeholder">
                            <i class="fas fa-plus fa-2x mb-2"></i>
                            <p>æ·»åŠ å›¾ç‰‡</p>
                        </div>
                    </div>
                </div>
            `;

            // é‡ç½®å¯Œæ–‡æœ¬ç¼–è¾‘å™¨
            if (applicationScenariosEditor) {
                applicationScenariosEditor.setContents([]);
            }
            if (productDescriptionEditor) {
                productDescriptionEditor.setContents([]);
            }
        }

        function fillProductForm(product) {
            document.getElementById('productTitle').value = product.title || '';
            document.getElementById('productModel').value = product.model || '';
            document.getElementById('productId').value = product.id || '';
            document.getElementById('productSummary').value = product.summary || '';
            document.getElementById('primaryCategory').value = product.primary_category || '';
            document.getElementById('productSupplier').value = product.supplier || '';

            // æ›´æ–°äºŒçº§åˆ†ç±»å’Œç³»åˆ—é€‰é¡¹
            updateSecondaryCategories();
            updateProductSeries();

            setTimeout(() => {
                document.getElementById('secondaryCategory').value = product.secondary_category || '';
                document.getElementById('productSeries').value = product.series || '';
            }, 100);

            // å¡«å……å‚æ•°
            if (product.parameters && product.parameters.length > 0) {
                const container = document.getElementById('parametersContainer');
                container.innerHTML = '';
                product.parameters.forEach(param => {
                    addParameterRow(param.name, param.value);
                });
            }

            // å¡«å……å¯Œæ–‡æœ¬ç¼–è¾‘å™¨
            if (applicationScenariosEditor && product.application_scenarios) {
                applicationScenariosEditor.root.innerHTML = product.application_scenarios;
            }
            if (productDescriptionEditor && product.content) {
                productDescriptionEditor.root.innerHTML = product.content;
            }

            // å¡«å……èµ„æ–™ä¸‹è½½
            if (product.data_download && product.data_download.length > 0) {
                const downloadContainer = document.getElementById('dataDownloadContainer');
                downloadContainer.innerHTML = '';
                product.data_download.forEach(download => {
                    addDataDownloadRow(download.file_title, download.file_path);
                });
            }

            // å¡«å……ç›¸å…³äº§å“
            if (product.related_products && product.related_products.length > 0) {
                const relatedList = document.getElementById('relatedProductsList');
                relatedList.innerHTML = '';
                product.related_products.forEach(relatedId => {
                    const relatedProduct = allProducts.find(p => p.id === relatedId);
                    if (relatedProduct) {
                        addRelatedProductToList(relatedProduct);
                    }
                });
            }

            // å¡«å……å‘å¸ƒçŠ¶æ€å’Œæ—¶é—´
            if (product.status) {
                document.getElementById('publishStatus').value = product.status;
            }
            if (product.published) {
                const publishDate = new Date(product.published);
                if (!isNaN(publishDate.getTime())) {
                    // è½¬æ¢ä¸ºæœ¬åœ°æ—¶é—´æ ¼å¼ YYYY-MM-DDTHH:MM
                    const localDateTime = new Date(publishDate.getTime() - publishDate.getTimezoneOffset() * 60000)
                        .toISOString().slice(0, 16);
                    document.getElementById('publishDate').value = localDateTime;
                }
            }

            // å¡«å……å›¾ç‰‡åº“
            loadProductGallery(product);
        }

        // åŠ è½½äº§å“å›¾ç‰‡åº“
        function loadProductGallery(product) {
            const container = document.getElementById('galleryContainer');
            const addButton = container.querySelector('.image-upload-area').parentElement;

            // æ¸…é™¤ç°æœ‰å›¾ç‰‡ï¼ˆä¿ç•™æ·»åŠ æŒ‰é’®ï¼‰
            const existingImages = container.querySelectorAll('.col-md-3:not(:has(.image-upload-area))');
            existingImages.forEach(img => img.remove());

            // åŠ è½½äº§å“å›¾ç‰‡
            if (product.gallery && product.gallery.length > 0) {
                product.gallery.forEach((imageData, index) => {
                    let imageSrc, imageAlt, isMain = false;

                    // å¤„ç†ä¸åŒçš„å›¾ç‰‡æ•°æ®æ ¼å¼
                    if (typeof imageData === 'string') {
                        imageSrc = imageData;
                        imageAlt = `${product.title || product.model}å›¾ç‰‡${index + 1}`;
                    } else if (typeof imageData === 'object') {
                        imageSrc = imageData.image || imageData.src || imageData.url;
                        imageAlt = imageData.alt || `${product.title || product.model}å›¾ç‰‡${index + 1}`;
                        isMain = imageData.is_main || false;
                    }

                    if (imageSrc) {
                        addImageToGalleryForEdit(imageSrc, imageAlt, isMain, index === 0);
                    }
                });
            }
        }

        // ä¸ºç¼–è¾‘æ¨¡å¼æ·»åŠ å›¾ç‰‡åˆ°å›¾åº“ï¼ˆåŒ…å«åœ°å€æ˜¾ç¤ºé€‰é¡¹ï¼‰
        function addImageToGalleryForEdit(src, alt, isMain = false, isFirstImage = false) {
            const container = document.getElementById('galleryContainer');
            const addButton = container.querySelector('.image-upload-area').parentElement;

            const col = document.createElement('div');
            col.className = 'col-md-3 mb-3';

            // æ£€æŸ¥å›¾ç‰‡æ˜¯å¦å¯ä»¥æ­£å¸¸åŠ è½½
            const img = new Image();
            let imageLoadError = false;

            img.onerror = function() {
                imageLoadError = true;
                updateImageDisplay();
            };

            img.onload = function() {
                updateImageDisplay();
            };

            img.src = src;

            function updateImageDisplay() {
                col.innerHTML = `
                    <div class="gallery-image-item ${isMain || isFirstImage ? 'main-image' : ''}">
                        ${!imageLoadError ?
                            `<img src="${src}" alt="${alt}" class="img-fluid" style="cursor: pointer;" onclick="toggleImageDisplay(this)">` :
                            `<div class="image-placeholder" style="height: 120px; background: #f8f9fa; border: 2px dashed #dee2e6; display: flex; align-items: center; justify-content: center; cursor: pointer;" onclick="toggleImageDisplay(this)">
                                <div class="text-center">
                                    <i class="fas fa-image fa-2x text-muted mb-2"></i>
                                    <div><small class="text-muted">å›¾ç‰‡åŠ è½½å¤±è´¥</small></div>
                                    <div><small class="text-muted">ç‚¹å‡»æŸ¥çœ‹åœ°å€</small></div>
                                </div>
                            </div>`
                        }
                        <div class="image-controls">
                            <button type="button" class="btn btn-sm ${isMain || isFirstImage ? 'btn-warning' : 'btn-outline-primary'}" onclick="setAsMainImage(this)" title="è®¾ä¸ºä¸»å›¾">
                                <i class="fas fa-star"></i>
                            </button>
                            <button type="button" class="btn btn-sm btn-outline-info" onclick="showImageAddress(this)" title="æŸ¥çœ‹åœ°å€">
                                <i class="fas fa-link"></i>
                            </button>
                            <button type="button" class="btn btn-sm btn-outline-danger" onclick="removeGalleryImage(this)" title="åˆ é™¤">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                        <div class="image-info">
                            <input type="text" class="form-control form-control-sm" value="${alt}" placeholder="å›¾ç‰‡æè¿°" onchange="updateImageAlt(this)">
                            <input type="hidden" value="${src}" class="image-src">
                            <div class="form-check mt-1">
                                <input class="form-check-input" type="checkbox" onchange="markAsNewUpload(this)">
                                <label class="form-check-label">
                                    <small>æ–°ä¸Šä¼ </small>
                                </label>
                            </div>
                            <div class="image-address mt-1" style="display: none;">
                                <small class="text-muted">åœ°å€: ${src}</small>
                            </div>
                        </div>
                    </div>
                `;

                container.insertBefore(col, addButton);
            }
        }

        // ç”Ÿæˆäº§å“ç¼–å·
        function generateProductId() {
            const randomId = Math.floor(100000 + Math.random() * 900000).toString();
            document.getElementById('productId').value = randomId;
        }

        // æ›´æ–°ä¸‹æ‹‰é€‰é¡¹
        function updateCategoryOptions() {
            const primarySelect = document.getElementById('primaryCategory');
            if (primarySelect) {
                primarySelect.innerHTML = '<option value="">è¯·é€‰æ‹©ä¸€çº§åˆ†ç±»</option>';
                productCategories.forEach(category => {
                    primarySelect.innerHTML += `<option value="${category.title}">${category.title}</option>`;
                });
            }
        }

        function updateSecondaryCategories() {
            const primaryCategory = document.getElementById('primaryCategory').value;
            const secondarySelect = document.getElementById('secondaryCategory');

            secondarySelect.innerHTML = '<option value="">è¯·é€‰æ‹©äºŒçº§åˆ†ç±»</option>';

            if (primaryCategory) {
                const category = productCategories.find(cat => cat.title === primaryCategory);
                if (category && category.subcategories) {
                    category.subcategories.forEach(subcat => {
                        secondarySelect.innerHTML += `<option value="${subcat.title}">${subcat.title}</option>`;
                    });
                }
            }
        }

        function updateSupplierOptions() {
            const supplierSelect = document.getElementById('productSupplier');
            if (supplierSelect) {
                supplierSelect.innerHTML = '<option value="">è¯·é€‰æ‹©ä¾›åº”å•†</option>';
                suppliers.forEach(supplier => {
                    supplierSelect.innerHTML += `<option value="${supplier.title}">${supplier.title}</option>`;
                });
            }
        }

        function updateProductSeries() {
            const supplierName = document.getElementById('productSupplier').value;
            const seriesSelect = document.getElementById('productSeries');

            seriesSelect.innerHTML = '<option value="">è¯·é€‰æ‹©äº§å“ç³»åˆ—</option>';

            if (supplierName) {
                const supplier = suppliers.find(s => s.title === supplierName);
                if (supplier && supplier.series) {
                    supplier.series.forEach(series => {
                        seriesSelect.innerHTML += `<option value="${series}">${series}</option>`;
                    });
                }
            }
        }

        function updateRelatedProductsOptions() {
            const relatedSelect = document.getElementById('relatedProductsSelect');
            if (relatedSelect) {
                relatedSelect.innerHTML = '<option value="">è¯·é€‰æ‹©ç›¸å…³äº§å“</option>';
                allProducts.forEach(product => {
                    relatedSelect.innerHTML += `<option value="${product.id}">${product.title}</option>`;
                });
            }
        }

        // å‚æ•°ç®¡ç†
        function addParameter() {
            addParameterRow('', '');
        }

        function addParameterRow(name = '', value = '') {
            const container = document.getElementById('parametersContainer');
            const row = document.createElement('div');
            row.className = 'row parameter-row mb-2';
            row.innerHTML = `
                <div class="col-md-4">
                    <input type="text" class="form-control" placeholder="å‚æ•°åç§°" name="paramName[]" value="${name}">
                </div>
                <div class="col-md-6">
                    <input type="text" class="form-control" placeholder="å‚æ•°å€¼" name="paramValue[]" value="${value}">
                </div>
                <div class="col-md-2">
                    <button type="button" class="btn btn-outline-danger btn-sm" onclick="removeParameter(this)">
                        <i class="fas fa-trash"></i>
                    </button>
                </div>
            `;
            container.appendChild(row);
        }

        function removeParameter(button) {
            button.closest('.parameter-row').remove();
        }

        // åŠ è½½é»˜è®¤å‚æ•°æ¨¡æ¿
        function loadDefaultParameters() {
            const container = document.getElementById('parametersContainer');
            container.innerHTML = '';

            const defaultParams = getDefaultEndoscopeParameters();
            defaultParams.forEach(param => {
                addParameterRow(param.name, param.value);
            });

            showNotification('å·²åŠ è½½é»˜è®¤ç”µå­å†…çª¥é•œå‚æ•°æ¨¡æ¿', 'success');
        }

        // æ¸…ç©ºæ‰€æœ‰å‚æ•°
        function clearAllParameters() {
            if (confirm('ç¡®å®šè¦æ¸…ç©ºæ‰€æœ‰å‚æ•°å—ï¼Ÿ')) {
                document.getElementById('parametersContainer').innerHTML = '';
                showNotification('å·²æ¸…ç©ºæ‰€æœ‰å‚æ•°', 'info');
            }
        }

        // èµ„æ–™ä¸‹è½½ç®¡ç†
        function addDataDownload() {
            addDataDownloadRow('', '');
        }

        function addDataDownloadRow(title = '', path = '') {
            const container = document.getElementById('dataDownloadContainer');
            const row = document.createElement('div');
            row.className = 'row data-download-row mb-3 p-3 border rounded';
            row.innerHTML = `
                <div class="col-md-4">
                    <label class="form-label">æ–‡ä»¶æ ‡é¢˜</label>
                    <input type="text" class="form-control" placeholder="å¦‚ï¼šäº§å“è¯´æ˜ä¹¦" name="downloadTitle[]" value="${title}">
                </div>
                <div class="col-md-6">
                    <label class="form-label">æ–‡ä»¶ä¸Šä¼ </label>
                    <div class="d-flex gap-2 mb-2">
                        <button type="button" class="btn btn-outline-primary btn-sm" onclick="uploadDataFile(this)">
                            <i class="fas fa-upload me-1"></i>ä¸Šä¼ æ–‡ä»¶
                        </button>
                        <button type="button" class="btn btn-outline-success btn-sm" onclick="selectDataFileFromLibrary(this)">
                            <i class="fas fa-folder-open me-1"></i>ä»åª’ä½“åº“é€‰æ‹©
                        </button>
                    </div>
                    <input type="hidden" name="downloadPath[]" value="${path}">
                    <div class="form-text">æ”¯æŒ PDFã€Wordã€Excelã€å‹ç¼©åŒ…ç­‰æ ¼å¼</div>
                    ${path ? `<div class="mt-1"><small class="text-success">å·²é€‰æ‹©ï¼š${path}</small></div>` : ''}
                </div>
                <div class="col-md-2 d-flex align-items-end">
                    <button type="button" class="btn btn-outline-danger btn-sm" onclick="removeDataDownload(this)">
                        <i class="fas fa-trash"></i> åˆ é™¤
                    </button>
                </div>
            `;
            container.appendChild(row);
        }

        function removeDataDownload(button) {
            button.closest('.data-download-row').remove();
        }

        // ä¸Šä¼ èµ„æ–™æ–‡ä»¶
        function uploadDataFile(button) {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = '.pdf,.doc,.docx,.xls,.xlsx,.zip,.rar';
            input.onchange = function(e) {
                const file = e.target.files[0];
                if (file) {
                    handleDataFileUpload(file, button);
                }
            };
            input.click();
        }

        // ä»åª’ä½“åº“é€‰æ‹©èµ„æ–™æ–‡ä»¶
        function selectDataFileFromLibrary(button) {
            selectFromMediaLibrary((selectedFiles) => {
                if (selectedFiles.length > 0) {
                    const file = selectedFiles[0];
                    if (file.type === 'file') {
                        updateDataFileSelection(file.path, file.name, button);
                    }
                }
            });
        }

        // å¤„ç†èµ„æ–™æ–‡ä»¶ä¸Šä¼ 
        async function handleDataFileUpload(file, button) {
            const row = button.closest('.data-download-row');
            const hiddenInput = row.querySelector('input[name="downloadPath[]"]');

            // æ˜¾ç¤ºä¸Šä¼ ä¸­çŠ¶æ€
            const statusDiv = row.querySelector('.file-status') || document.createElement('div');
            statusDiv.className = 'mt-1 file-status';
            statusDiv.innerHTML = `<small class="text-info"><i class="fas fa-spinner fa-spin me-1"></i>ä¸Šä¼ ä¸­...</small>`;
            if (!row.querySelector('.file-status')) {
                button.parentElement.parentElement.appendChild(statusDiv);
            }

            try {
                // æ¨¡æ‹Ÿæ–‡ä»¶ä¸Šä¼  - åœ¨å®é™…åº”ç”¨ä¸­è¿™é‡Œåº”è¯¥è°ƒç”¨çœŸå®çš„ä¸Šä¼ API
                await new Promise(resolve => setTimeout(resolve, 1000));

                const fileName = `${Date.now()}_${file.name}`;
                const filePath = `/uploads/products/${fileName}`;

                updateDataFileSelection(filePath, file.name, button);

            } catch (error) {
                statusDiv.innerHTML = `<small class="text-danger"><i class="fas fa-exclamation-triangle me-1"></i>ä¸Šä¼ å¤±è´¥</small>`;
                console.error('æ–‡ä»¶ä¸Šä¼ å¤±è´¥:', error);
            }
        }

        // æ›´æ–°èµ„æ–™æ–‡ä»¶é€‰æ‹©
        function updateDataFileSelection(filePath, fileName, button) {
            const row = button.closest('.data-download-row');
            const hiddenInput = row.querySelector('input[name="downloadPath[]"]');

            hiddenInput.value = filePath;

            // æ›´æ–°æ˜¾ç¤ºçŠ¶æ€
            const existingStatus = row.querySelector('.file-status');
            if (existingStatus) {
                existingStatus.remove();
            }

            const statusDiv = document.createElement('div');
            statusDiv.className = 'mt-1 file-status';
            statusDiv.innerHTML = `<small class="text-success"><i class="fas fa-check me-1"></i>å·²é€‰æ‹©ï¼š${fileName}</small>`;
            button.parentElement.parentElement.appendChild(statusDiv);
        }

        // å¤„ç†æ–‡ä»¶ä¸Šä¼ 
        async function handleFileUpload(input) {
            const file = input.files[0];
            if (!file) return;

            // æ˜¾ç¤ºä¸Šä¼ ä¸­çŠ¶æ€
            const uploadingDiv = document.createElement('div');
            uploadingDiv.className = 'mt-1 uploading-status';
            uploadingDiv.innerHTML = `<small class="text-info"><i class="fas fa-spinner fa-spin me-1"></i>ä¸Šä¼ ä¸­...</small>`;
            input.parentElement.parentElement.appendChild(uploadingDiv);

            try {
                // å®é™…æ–‡ä»¶ä¸Šä¼ åˆ°æœåŠ¡å™¨
                const uploadResult = await uploadFileToServer(file);

                if (uploadResult.success) {
                    // æ›´æ–°éšè—çš„è·¯å¾„å­—æ®µ
                    const hiddenInput = input.parentElement.querySelector('input[type="hidden"]');
                    hiddenInput.value = uploadResult.filePath;

                    // ç§»é™¤ä¸Šä¼ ä¸­çŠ¶æ€
                    uploadingDiv.remove();

                    // æ˜¾ç¤ºä¸Šä¼ æˆåŠŸä¿¡æ¯
                    const existingSuccess = input.parentElement.parentElement.querySelector('.text-success');
                    if (existingSuccess) {
                        existingSuccess.remove();
                    }

                    const successDiv = document.createElement('div');
                    successDiv.className = 'mt-1';
                    successDiv.innerHTML = `<small class="text-success"><i class="fas fa-check me-1"></i>å·²ä¸Šä¼ ï¼š${file.name}</small>`;
                    input.parentElement.parentElement.appendChild(successDiv);

                    showNotification(`æ–‡ä»¶ "${file.name}" ä¸Šä¼ æˆåŠŸ`, 'success');
                } else {
                    throw new Error(uploadResult.message || 'ä¸Šä¼ å¤±è´¥');
                }
            } catch (error) {
                // ç§»é™¤ä¸Šä¼ ä¸­çŠ¶æ€
                uploadingDiv.remove();

                // æ˜¾ç¤ºé”™è¯¯ä¿¡æ¯
                const errorDiv = document.createElement('div');
                errorDiv.className = 'mt-1';
                errorDiv.innerHTML = `<small class="text-danger"><i class="fas fa-exclamation-triangle me-1"></i>ä¸Šä¼ å¤±è´¥ï¼š${error.message}</small>`;
                input.parentElement.parentElement.appendChild(errorDiv);

                showNotification(`æ–‡ä»¶ä¸Šä¼ å¤±è´¥: ${error.message}`, 'danger');
            }
        }

        // ä¸Šä¼ æ–‡ä»¶åˆ°æœåŠ¡å™¨
        async function uploadFileToServer(file) {
            try {
                const formData = new FormData();
                formData.append('file', file);
                formData.append('type', 'product-data');

                const response = await fetch('http://localhost:3001/api/upload', {
                    method: 'POST',
                    body: formData
                });

                if (response.ok) {
                    const result = await response.json();
                    return {
                        success: true,
                        filePath: result.filePath,
                        fileName: result.fileName
                    };
                } else {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
            } catch (error) {
                console.error('æ–‡ä»¶ä¸Šä¼ å¤±è´¥:', error);

                // å¦‚æœæœåŠ¡å™¨ä¸Šä¼ å¤±è´¥ï¼Œä½¿ç”¨æœ¬åœ°æ¨¡æ‹Ÿ
                const fileName = file.name;
                const timestamp = Date.now();
                const uploadPath = `/uploads/products/${timestamp}_${fileName}`;

                // æ¨¡æ‹Ÿä¿å­˜æ–‡ä»¶ä¿¡æ¯åˆ°localStorage
                const uploadedFiles = JSON.parse(localStorage.getItem('visndt_uploaded_files') || '{}');
                uploadedFiles[uploadPath] = {
                    originalName: fileName,
                    size: file.size,
                    type: file.type,
                    uploadTime: new Date().toISOString(),
                    synced: false
                };
                localStorage.setItem('visndt_uploaded_files', JSON.stringify(uploadedFiles));

                return {
                    success: true,
                    filePath: uploadPath,
                    fileName: fileName,
                    local: true
                };
            }
        }

        // å›¾ç‰‡ç®¡ç†

        function addGalleryImage() {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = 'image/*';
            input.onchange = function() {
                if (this.files && this.files[0]) {
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        addGalleryImagePreview(e.target.result);
                    };
                    reader.readAsDataURL(this.files[0]);
                }
            };
            input.click();
        }

        function addGalleryImagePreview(src) {
            const container = document.getElementById('galleryContainer');
            const addButton = container.querySelector('.image-upload-area').parentElement;

            const imageCol = document.createElement('div');
            imageCol.className = 'col-md-3 mb-3';
            imageCol.innerHTML = `
                <div class="position-relative">
                    <img src="${src}" class="img-fluid rounded" style="width: 100%; height: 150px; object-fit: cover;">
                    <button type="button" class="btn btn-danger btn-sm position-absolute top-0 end-0 m-1" onclick="removeGalleryImage(this)">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
            `;

            container.insertBefore(imageCol, addButton);
        }

        function removeGalleryImage(button) {
            button.closest('.col-md-3').remove();
        }

        // ç›¸å…³äº§å“ç®¡ç†
        function addRelatedProduct() {
            const select = document.getElementById('relatedProductsSelect');
            const productId = select.value;

            if (!productId) return;

            const product = allProducts.find(p => p.id === productId);
            if (!product) return;

            // æ£€æŸ¥æ˜¯å¦å·²ç»æ·»åŠ 
            const existingItems = document.querySelectorAll('#relatedProductsList .related-product-item');
            for (let item of existingItems) {
                if (item.dataset.productId === productId) {
                    showNotification('è¯¥äº§å“å·²ç»æ·»åŠ åˆ°ç›¸å…³äº§å“åˆ—è¡¨', 'warning');
                    return;
                }
            }

            addRelatedProductToList(product);
            select.value = '';
        }

        function addRelatedProductToList(product) {
            const container = document.getElementById('relatedProductsList');
            const item = document.createElement('div');
            item.className = 'related-product-item d-flex align-items-center justify-content-between p-2 border rounded mb-2';
            item.dataset.productId = product.id;
            item.innerHTML = `
                <div class="d-flex align-items-center">
                    <img src="${product.thumbnail || '/images/products/default-product.jpg'}"
                         alt="${product.title}"
                         style="width: 40px; height: 40px; object-fit: cover; border-radius: 4px; margin-right: 10px;">
                    <div>
                        <div class="fw-bold">${product.title}</div>
                        <small class="text-muted">${product.model || ''}</small>
                    </div>
                </div>
                <button type="button" class="btn btn-outline-danger btn-sm" onclick="removeRelatedProduct(this)">
                    <i class="fas fa-times"></i>
                </button>
            `;
            container.appendChild(item);
        }

        function removeRelatedProduct(button) {
            button.closest('.related-product-item').remove();
        }

        // ä¿å­˜äº§å“
        async function saveProduct() {
            // æ˜¾ç¤ºä¿å­˜ä¸­çŠ¶æ€
            const saveBtn = document.querySelector('button[onclick="saveProduct()"]');
            const originalText = saveBtn.innerHTML;
            saveBtn.innerHTML = '<i class="fas fa-spinner fa-spin me-1"></i>ä¿å­˜ä¸­...';
            saveBtn.disabled = true;

            try {
                // éªŒè¯è¡¨å•
                const form = document.getElementById('productForm');
                if (!form.checkValidity()) {
                    form.reportValidity();
                    return;
                }

                // æ”¶é›†è¡¨å•æ•°æ®
                const productData = {
                    id: document.getElementById('productId').value,
                    title: document.getElementById('productTitle').value,
                    model: document.getElementById('productModel').value,
                    summary: document.getElementById('productSummary').value,
                    primary_category: document.getElementById('primaryCategory').value,
                    secondary_category: document.getElementById('secondaryCategory').value,
                    supplier: document.getElementById('productSupplier').value,
                    series: document.getElementById('productSeries').value,
                    published: document.getElementById('publishStatus').value === 'published' ?
                        (document.getElementById('publishDate').value || new Date().toISOString()) : false,
                    status: document.getElementById('publishStatus').value,
                    parameters: [],
                    gallery: getGalleryData(),
                    application_scenarios: applicationScenariosEditor ?
                        (applicationScenariosEditor.root.innerHTML || '') : '',
                    content: productDescriptionEditor ?
                        (productDescriptionEditor.root.innerHTML || '') : '',
                    data_download: [],
                    related_products: []
                };

            // æ”¶é›†å‚æ•°
            const paramNames = document.querySelectorAll('input[name="paramName[]"]');
            const paramValues = document.querySelectorAll('input[name="paramValue[]"]');
            for (let i = 0; i < paramNames.length; i++) {
                if (paramNames[i].value.trim() && paramValues[i].value.trim()) {
                    productData.parameters.push({
                        name: paramNames[i].value.trim(),
                        value: paramValues[i].value.trim()
                    });
                }
            }

            // å¦‚æœæ²¡æœ‰å›¾ç‰‡ï¼Œæ·»åŠ é»˜è®¤å›¾ç‰‡
            if (productData.gallery.length === 0) {
                productData.gallery.push({
                    image: `/images/products/default-${productData.series || 'product'}.jpg`,
                    alt: `${productData.title}é»˜è®¤å›¾ç‰‡`,
                    is_main: true
                });
            }

            // æ”¶é›†èµ„æ–™ä¸‹è½½
            const downloadTitles = document.querySelectorAll('input[name="downloadTitle[]"]');
            const downloadPaths = document.querySelectorAll('input[name="downloadPath[]"]');
            for (let i = 0; i < downloadTitles.length; i++) {
                if (downloadTitles[i].value.trim() && downloadPaths[i].value.trim()) {
                    productData.data_download.push({
                        file_title: downloadTitles[i].value.trim(),
                        file_path: downloadPaths[i].value.trim()
                    });
                }
            }

                // æ”¶é›†ç›¸å…³äº§å“
                const relatedItems = document.querySelectorAll('.related-product-item');
                relatedItems.forEach(item => {
                    productData.related_products.push(item.dataset.productId);
                });

                // ç”Ÿæˆäº§å“æ ‡ç­¾
                productData.tags = generateProductTags(productData.model, productData.series);

                // å¤„ç†æ–‡ä»¶ä¸Šä¼ å’Œè·¯å¾„
                productData = processProductFiles(productData);

                // ä¿å­˜äº§å“åˆ°æ–‡ä»¶ç³»ç»Ÿ
                const result = await window.ProductAPI.saveProduct(productData);

                if (result.success) {
                    // æ›´æ–°å†…å­˜ä¸­çš„æ•°æ®
                    if (editingProduct) {
                        // æ›´æ–°ç°æœ‰äº§å“
                        const index = currentData.findIndex(p => p.id === editingProduct.id);
                        if (index !== -1) {
                            currentData[index] = { ...currentData[index], ...productData };
                        }
                        const allIndex = allProducts.findIndex(p => p.id === editingProduct.id);
                        if (allIndex !== -1) {
                            allProducts[allIndex] = { ...allProducts[allIndex], ...productData };
                        }
                        showNotification(result.message || 'äº§å“æ›´æ–°æˆåŠŸï¼Œå·²åŒæ­¥åˆ°å‰å°', 'success');
                    } else {
                        // æ·»åŠ æ–°äº§å“
                        currentData.push(productData);
                        allProducts.push(productData);
                        showNotification(result.message || 'äº§å“æ·»åŠ æˆåŠŸï¼Œå·²åŒæ­¥åˆ°å‰å°', 'success');
                    }

                    // æ›´æ–°ç›¸å…³äº§å“é€‰é¡¹
                    updateRelatedProductsOptions();

                    // é‡æ–°åº”ç”¨ç­›é€‰
                    applyFilters();

                    // å…³é—­å¼¹çª—
                    const modal = bootstrap.Modal.getInstance(document.getElementById('productModal'));
                    modal.hide();
                } else {
                    showNotification(result.message || 'äº§å“ä¿å­˜å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œè¿æ¥', 'danger');
                }

            } catch (error) {
                console.error('ä¿å­˜äº§å“å¤±è´¥:', error);
                showNotification('ä¿å­˜äº§å“å¤±è´¥: ' + error.message, 'danger');
            } finally {
                // æ¢å¤æŒ‰é’®çŠ¶æ€
                saveBtn.innerHTML = originalText;
                saveBtn.disabled = false;
            }
        }



        // å…¶ä»–ç®¡ç†åŠŸèƒ½
        function showProductCategories() {
            currentSection = 'categories';
            document.getElementById('contentTitle').textContent = 'äº§å“åˆ†ç±»ç®¡ç†';
            document.getElementById('contentSubtitle').textContent = 'ç®¡ç†äº§å“åˆ†ç±»ä½“ç³»ï¼ŒåŒ…æ‹¬ä¸»åˆ†ç±»å’Œå­åˆ†ç±»';

            const actionsHtml = `
                <button class="btn btn-primary" onclick="addCategory()">
                    <i class="fas fa-plus me-1"></i>æ·»åŠ åˆ†ç±»
                </button>
                <button class="btn btn-success" onclick="syncCategoriesToFrontend()">
                    <i class="fas fa-sync me-1"></i>åŒæ­¥åˆ°å‰å°
                </button>
            `;
            document.getElementById('contentActions').innerHTML = actionsHtml;

            const contentHtml = `
                <div class="row">
                    ${productCategories.map(category => `
                        <div class="col-md-6 mb-4">
                            <div class="card">
                                <div class="card-header d-flex justify-content-between align-items-center">
                                    <div class="d-flex align-items-center">
                                        <i class="${category.icon || 'fas fa-folder'} me-2 text-primary"></i>
                                        <h6 class="mb-0">${category.title}</h6>
                                    </div>
                                    <div>
                                        <button class="btn btn-sm btn-outline-primary" onclick="editCategory('${category.id}')">
                                            <i class="fas fa-edit"></i>
                                        </button>
                                        <button class="btn btn-sm btn-outline-danger" onclick="deleteCategory('${category.id}')">
                                            <i class="fas fa-trash"></i>
                                        </button>
                                    </div>
                                </div>
                                <div class="card-body">
                                    <p class="text-muted small mb-2">${category.description || ''}</p>
                                    <h6>å­åˆ†ç±» (${category.subcategories ? category.subcategories.length : 0})ï¼š</h6>
                                    ${category.subcategories ? category.subcategories.map(sub => `
                                        <div class="d-flex align-items-center mb-2 p-2 bg-light rounded">
                                            <i class="${sub.icon || 'fas fa-circle'} me-2 text-primary" style="font-size: 12px;"></i>
                                            <div class="flex-grow-1">
                                                <span class="badge bg-secondary me-2">${sub.title}</span>
                                                <small class="text-muted">${sub.description || ''}</small>
                                            </div>
                                        </div>
                                    `).join('') : '<span class="text-muted">æš‚æ— å­åˆ†ç±»</span>'}
                                </div>
                            </div>
                        </div>
                    `).join('')}
                </div>
            `;

            document.getElementById('contentBody').innerHTML = contentHtml;

            // è®¾ç½®æ´»åŠ¨çŠ¶æ€
            document.querySelectorAll('.sidebar-item').forEach(item => item.classList.remove('active'));
            document.querySelector('.sidebar-item[onclick="showProductCategories()"]').classList.add('active');
        }

        function showSuppliers() {
            currentSection = 'suppliers';
            document.getElementById('contentTitle').textContent = 'ä¾›åº”å•†ç®¡ç†';
            document.getElementById('contentSubtitle').textContent = 'ç®¡ç†ä¾›åº”å•†ä¿¡æ¯å’Œäº§å“ç³»åˆ—å…³ç³»';

            const actionsHtml = `
                <button class="btn btn-primary" onclick="addSupplier()">
                    <i class="fas fa-plus me-1"></i>æ·»åŠ ä¾›åº”å•†
                </button>
            `;
            document.getElementById('contentActions').innerHTML = actionsHtml;

            const contentHtml = `
                <div class="row">
                    ${suppliers.map(supplier => `
                        <div class="col-md-6 mb-4">
                            <div class="card">
                                <div class="card-header d-flex justify-content-between align-items-center">
                                    <h6 class="mb-0">${supplier.title}</h6>
                                    <div>
                                        <button class="btn btn-sm btn-outline-primary" onclick="editSupplier('${supplier.id}')">
                                            <i class="fas fa-edit"></i>
                                        </button>
                                        <button class="btn btn-sm btn-outline-danger" onclick="deleteSupplier('${supplier.id}')">
                                            <i class="fas fa-trash"></i>
                                        </button>
                                    </div>
                                </div>
                                <div class="card-body">
                                    <h6>äº§å“ç³»åˆ—ï¼š</h6>
                                    ${supplier.series ? supplier.series.map(series => `
                                        <span class="badge bg-primary me-1 mb-1">${series}</span>
                                    `).join('') : '<span class="text-muted">æš‚æ— äº§å“ç³»åˆ—</span>'}
                                </div>
                            </div>
                        </div>
                    `).join('')}
                </div>
            `;

            document.getElementById('contentBody').innerHTML = contentHtml;

            // è®¾ç½®æ´»åŠ¨çŠ¶æ€
            document.querySelectorAll('.sidebar-item').forEach(item => item.classList.remove('active'));
            document.querySelector('.sidebar-item[onclick="showSuppliers()"]').classList.add('active');
        }

        // å¯¼å…¥å¯¼å‡ºåŠŸèƒ½
        function showImportExport() {
            currentSection = 'import-export';
            document.getElementById('contentTitle').textContent = 'å¯¼å…¥å¯¼å‡ºç®¡ç†';
            document.getElementById('contentSubtitle').textContent = 'æ‰¹é‡å¯¼å…¥å¯¼å‡ºäº§å“ã€èµ„è®¯ã€æ¡ˆä¾‹ç­‰æ•°æ®';

            document.getElementById('contentActions').innerHTML = '';

            const contentHtml = `
                <div class="row">
                    <div class="col-md-6">
                        <div class="card">
                            <div class="card-header">
                                <h5><i class="fas fa-file-import me-2"></i>æ•°æ®å¯¼å…¥</h5>
                            </div>
                            <div class="card-body">
                                <div class="mb-3">
                                    <label for="importType" class="form-label">å¯¼å…¥ç±»å‹</label>
                                    <select class="form-select" id="importType">
                                        <option value="products">äº§å“æ•°æ®</option>
                                        <option value="news">èµ„è®¯æ•°æ®</option>
                                        <option value="cases">æ¡ˆä¾‹æ•°æ®</option>
                                        <option value="suppliers">ä¾›åº”å•†æ•°æ®</option>
                                    </select>
                                </div>
                                <div class="mb-3">
                                    <label for="importFile" class="form-label">é€‰æ‹©æ–‡ä»¶</label>
                                    <input type="file" class="form-control" id="importFile" accept=".json,.csv,.xlsx">
                                    <div class="form-text">æ”¯æŒ JSONã€CSVã€Excel æ ¼å¼</div>
                                </div>
                                <button class="btn btn-primary" onclick="importData()">
                                    <i class="fas fa-upload me-1"></i>å¼€å§‹å¯¼å…¥
                                </button>
                                <button class="btn btn-outline-secondary ms-2" onclick="downloadTemplate()">
                                    <i class="fas fa-download me-1"></i>ä¸‹è½½æ¨¡æ¿
                                </button>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="card">
                            <div class="card-header">
                                <h5><i class="fas fa-file-export me-2"></i>æ•°æ®å¯¼å‡º</h5>
                            </div>
                            <div class="card-body">
                                <div class="mb-3">
                                    <label for="exportType" class="form-label">å¯¼å‡ºç±»å‹</label>
                                    <select class="form-select" id="exportType">
                                        <option value="products">äº§å“æ•°æ®</option>
                                        <option value="news">èµ„è®¯æ•°æ®</option>
                                        <option value="cases">æ¡ˆä¾‹æ•°æ®</option>
                                        <option value="suppliers">ä¾›åº”å•†æ•°æ®</option>
                                        <option value="all">å…¨éƒ¨æ•°æ®</option>
                                    </select>
                                </div>
                                <div class="mb-3">
                                    <label for="exportFormat" class="form-label">å¯¼å‡ºæ ¼å¼</label>
                                    <select class="form-select" id="exportFormat">
                                        <option value="json">JSON æ ¼å¼</option>
                                        <option value="csv">CSV æ ¼å¼</option>
                                        <option value="xlsx">Excel æ ¼å¼</option>
                                    </select>
                                </div>
                                <button class="btn btn-success" onclick="exportData()">
                                    <i class="fas fa-download me-1"></i>å¼€å§‹å¯¼å‡º
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="row mt-4">
                    <div class="col-12">
                        <div class="card">
                            <div class="card-header">
                                <h5><i class="fas fa-history me-2"></i>æ“ä½œå†å²</h5>
                            </div>
                            <div class="card-body">
                                <div class="table-responsive">
                                    <table class="table table-sm">
                                        <thead>
                                            <tr>
                                                <th>æ—¶é—´</th>
                                                <th>æ“ä½œç±»å‹</th>
                                                <th>æ•°æ®ç±»å‹</th>
                                                <th>çŠ¶æ€</th>
                                                <th>è¯¦æƒ…</th>
                                            </tr>
                                        </thead>
                                        <tbody id="operationHistory">
                                            <tr>
                                                <td colspan="5" class="text-center text-muted">æš‚æ— æ“ä½œè®°å½•</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `;

            document.getElementById('contentBody').innerHTML = contentHtml;

            // è®¾ç½®æ´»åŠ¨çŠ¶æ€
            document.querySelectorAll('.sidebar-item').forEach(item => item.classList.remove('active'));
            document.querySelector('.sidebar-item[onclick="showImportExport()"]').classList.add('active');
        }

        function exportProducts() {
            exportDataByType('products');
        }

        // ç”ŸæˆHugoæ–‡ä»¶
        function generateHugoFiles() {
            if (currentData.length === 0) {
                showNotification('æ²¡æœ‰äº§å“æ•°æ®å¯ä»¥ç”Ÿæˆ', 'warning');
                return;
            }

            const confirmMsg = `ç¡®å®šè¦ä¸ºå½“å‰ ${currentData.length} ä¸ªäº§å“ç”ŸæˆHugo markdownæ–‡ä»¶å—ï¼Ÿ\n\nç”Ÿæˆçš„æ–‡ä»¶éœ€è¦æ‰‹åŠ¨æ”¾å…¥ content/products/ ç›®å½•ä¸­ã€‚`;

            if (!confirm(confirmMsg)) {
                return;
            }

            try {
                // æ˜¾ç¤ºè¿›åº¦æç¤º
                showNotification('æ­£åœ¨ç”ŸæˆHugoæ–‡ä»¶ï¼Œè¯·ç¨å€™...', 'info');

                // ä¸ºæ¯ä¸ªäº§å“ç”Ÿæˆmarkdownæ–‡ä»¶
                currentData.forEach((product, index) => {
                    setTimeout(() => {
                        const content = window.ProductAPI.generateHugoMarkdown(product);
                        window.ProductAPI.downloadMarkdownFile(product, content);

                        // æœ€åä¸€ä¸ªæ–‡ä»¶ä¸‹è½½å®Œæˆåæ˜¾ç¤ºæˆåŠŸæ¶ˆæ¯
                        if (index === currentData.length - 1) {
                            setTimeout(() => {
                                showNotification(`æˆåŠŸç”Ÿæˆ ${currentData.length} ä¸ªHugoæ–‡ä»¶ï¼è¯·å°†ä¸‹è½½çš„.mdæ–‡ä»¶æ”¾å…¥ content/products/ ç›®å½•`, 'success');
                            }, 500);
                        }
                    }, index * 300); // æ¯300msä¸‹è½½ä¸€ä¸ªæ–‡ä»¶ï¼Œé¿å…æµè§ˆå™¨é˜»æ­¢å¤šä¸ªä¸‹è½½
                });

            } catch (error) {
                showNotification('ç”ŸæˆHugoæ–‡ä»¶å¤±è´¥: ' + error.message, 'danger');
            }
        }

        function exportDataByType(type) {
            let data = [];
            let filename = '';

            switch (type) {
                case 'products':
                    data = currentData;
                    filename = 'products_export';
                    break;
                case 'news':
                    data = []; // è¿™é‡Œåº”è¯¥åŠ è½½èµ„è®¯æ•°æ®
                    filename = 'news_export';
                    break;
                case 'cases':
                    data = []; // è¿™é‡Œåº”è¯¥åŠ è½½æ¡ˆä¾‹æ•°æ®
                    filename = 'cases_export';
                    break;
                case 'suppliers':
                    data = suppliers;
                    filename = 'suppliers_export';
                    break;
                default:
                    data = {
                        products: currentData,
                        suppliers: suppliers,
                        categories: productCategories
                    };
                    filename = 'all_data_export';
            }

            // å¯¼å‡ºä¸ºJSONæ ¼å¼
            const jsonData = JSON.stringify(data, null, 2);
            const blob = new Blob([jsonData], { type: 'application/json' });
            const url = URL.createObjectURL(blob);

            const a = document.createElement('a');
            a.href = url;
            a.download = `${filename}_${new Date().toISOString().split('T')[0]}.json`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);

            showNotification('æ•°æ®å¯¼å‡ºæˆåŠŸ', 'success');

            // è®°å½•æ“ä½œå†å²
            addOperationHistory('å¯¼å‡º', type, 'æˆåŠŸ', `å¯¼å‡ºäº† ${data.length || Object.keys(data).length} æ¡è®°å½•`);
        }

        function exportData() {
            const type = document.getElementById('exportType').value;
            const format = document.getElementById('exportFormat').value;

            if (format === 'json') {
                exportDataByType(type);
            } else {
                showNotification('æš‚ä¸æ”¯æŒè¯¥æ ¼å¼å¯¼å‡ºï¼Œè¯·é€‰æ‹©JSONæ ¼å¼', 'warning');
            }
        }

        function importData() {
            const fileInput = document.getElementById('importFile');
            const type = document.getElementById('importType').value;

            if (!fileInput.files || !fileInput.files[0]) {
                showNotification('è¯·é€‰æ‹©è¦å¯¼å…¥çš„æ–‡ä»¶', 'warning');
                return;
            }

            const file = fileInput.files[0];
            const reader = new FileReader();

            reader.onload = function(e) {
                try {
                    const data = JSON.parse(e.target.result);

                    switch (type) {
                        case 'products':
                            importProducts(data);
                            break;
                        case 'suppliers':
                            importSuppliers(data);
                            break;
                        default:
                            showNotification('æš‚ä¸æ”¯æŒè¯¥ç±»å‹çš„å¯¼å…¥', 'warning');
                    }
                } catch (error) {
                    console.error('å¯¼å…¥å¤±è´¥:', error);
                    showNotification('æ–‡ä»¶æ ¼å¼é”™è¯¯ï¼Œè¯·æ£€æŸ¥æ–‡ä»¶å†…å®¹', 'danger');
                }
            };

            reader.readAsText(file);
        }

        function importProducts(data) {
            if (!Array.isArray(data)) {
                showNotification('äº§å“æ•°æ®æ ¼å¼é”™è¯¯ï¼Œåº”ä¸ºæ•°ç»„æ ¼å¼', 'danger');
                return;
            }

            let importCount = 0;
            data.forEach(product => {
                if (product.id && product.title) {
                    // æ£€æŸ¥æ˜¯å¦å·²å­˜åœ¨
                    const existingIndex = currentData.findIndex(p => p.id === product.id);
                    if (existingIndex !== -1) {
                        currentData[existingIndex] = { ...currentData[existingIndex], ...product };
                    } else {
                        currentData.push(product);
                        allProducts.push(product);
                    }
                    importCount++;
                }
            });

            // æ›´æ–°æ˜¾ç¤º
            if (currentSection === 'products') {
                applyFilters();
            }
            updateRelatedProductsOptions();

            showNotification(`æˆåŠŸå¯¼å…¥ ${importCount} ä¸ªäº§å“`, 'success');
            addOperationHistory('å¯¼å…¥', 'products', 'æˆåŠŸ', `å¯¼å…¥äº† ${importCount} ä¸ªäº§å“`);
        }

        function importSuppliers(data) {
            if (!Array.isArray(data)) {
                showNotification('ä¾›åº”å•†æ•°æ®æ ¼å¼é”™è¯¯ï¼Œåº”ä¸ºæ•°ç»„æ ¼å¼', 'danger');
                return;
            }

            let importCount = 0;
            data.forEach(supplier => {
                if (supplier.id && supplier.title) {
                    const existingIndex = suppliers.findIndex(s => s.id === supplier.id);
                    if (existingIndex !== -1) {
                        suppliers[existingIndex] = { ...suppliers[existingIndex], ...supplier };
                    } else {
                        suppliers.push(supplier);
                    }
                    importCount++;
                }
            });

            // æ›´æ–°ä¸‹æ‹‰é€‰é¡¹
            updateSupplierOptions();

            showNotification(`æˆåŠŸå¯¼å…¥ ${importCount} ä¸ªä¾›åº”å•†`, 'success');
            addOperationHistory('å¯¼å…¥', 'suppliers', 'æˆåŠŸ', `å¯¼å…¥äº† ${importCount} ä¸ªä¾›åº”å•†`);
        }

        function downloadTemplate() {
            const type = document.getElementById('importType').value;
            let template = {};

            switch (type) {
                case 'products':
                    template = [{
                        id: "000001",
                        title: "ç¤ºä¾‹äº§å“",
                        model: "EXAMPLE-001",
                        summary: "è¿™æ˜¯ä¸€ä¸ªç¤ºä¾‹äº§å“",
                        primary_category: "ç”µå­å†…çª¥é•œ",
                        secondary_category: "å·¥ä¸šè§†é¢‘å†…çª¥é•œ",
                        supplier: "ç¤ºä¾‹ä¾›åº”å•†",
                        series: "ç¤ºä¾‹ç³»åˆ—",
                        status: "published",
                        parameters: [
                            { name: "å‚æ•°1", value: "å€¼1" },
                            { name: "å‚æ•°2", value: "å€¼2" }
                        ],
                        application_scenarios: "åº”ç”¨åœºæ™¯æè¿°",
                        content: "äº§å“è¯¦ç»†æè¿°"
                    }];
                    break;
                case 'suppliers':
                    template = [{
                        id: "supplier1",
                        title: "ç¤ºä¾‹ä¾›åº”å•†",
                        series: ["ç³»åˆ—1", "ç³»åˆ—2"]
                    }];
                    break;
                default:
                    template = { message: "æš‚æ— è¯¥ç±»å‹çš„æ¨¡æ¿" };
            }

            const jsonData = JSON.stringify(template, null, 2);
            const blob = new Blob([jsonData], { type: 'application/json' });
            const url = URL.createObjectURL(blob);

            const a = document.createElement('a');
            a.href = url;
            a.download = `${type}_template.json`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);

            showNotification('æ¨¡æ¿ä¸‹è½½æˆåŠŸ', 'success');
        }

        function addOperationHistory(operation, type, status, details) {
            const tbody = document.getElementById('operationHistory');
            if (tbody.querySelector('td[colspan="5"]')) {
                tbody.innerHTML = '';
            }

            const row = document.createElement('tr');
            row.innerHTML = `
                <td>${new Date().toLocaleString()}</td>
                <td>${operation}</td>
                <td>${type}</td>
                <td><span class="badge ${status === 'æˆåŠŸ' ? 'bg-success' : 'bg-danger'}">${status}</span></td>
                <td>${details}</td>
            `;
            tbody.insertBefore(row, tbody.firstChild);
        }

        // å…¶ä»–ç®¡ç†åŠŸèƒ½çš„å ä½ç¬¦
        // èµ„è®¯ç®¡ç†åŠŸèƒ½
        let allNews = [];
        let filteredNews = [];
        let editingNews = null;

        async function showNewsList() {
            currentSection = 'news';
            document.getElementById('contentTitle').textContent = 'èµ„è®¯ç®¡ç†';
            document.getElementById('contentSubtitle').textContent = 'ç®¡ç†ç½‘ç«™æ–°é—»èµ„è®¯å†…å®¹';

            const actionsHtml = `
                <button class="btn btn-primary" onclick="addNews()">
                    <i class="fas fa-plus me-1"></i>æ·»åŠ èµ„è®¯
                </button>
                <button class="btn btn-success" onclick="refreshNewsList()">
                    <i class="fas fa-sync me-1"></i>åˆ·æ–°åˆ—è¡¨
                </button>
                <button class="btn btn-info" onclick="exportNews()">
                    <i class="fas fa-download me-1"></i>å¯¼å‡ºæ•°æ®
                </button>
                <button class="btn btn-warning" onclick="importNews()">
                    <i class="fas fa-upload me-1"></i>å¯¼å…¥æ•°æ®
                </button>
                <button class="btn btn-secondary" onclick="generateNewsHugoFiles()">
                    <i class="fas fa-code me-1"></i>ç”ŸæˆHugoæ–‡ä»¶
                </button>
            `;
            document.getElementById('contentActions').innerHTML = actionsHtml;

            try {
                // åŠ è½½èµ„è®¯æ•°æ®
                allNews = await loadAllNews();
                filteredNews = [...allNews];
                renderNewsList();
            } catch (error) {
                console.error('åŠ è½½èµ„è®¯åˆ—è¡¨å¤±è´¥:', error);
                document.getElementById('contentBody').innerHTML = `
                    <div class="alert alert-warning">
                        <i class="fas fa-exclamation-triangle me-2"></i>
                        åŠ è½½èµ„è®¯åˆ—è¡¨å¤±è´¥: ${error.message}
                        <button class="btn btn-outline-warning btn-sm ms-2" onclick="showNewsList()">é‡è¯•</button>
                    </div>
                `;
            }

            document.querySelectorAll('.sidebar-item').forEach(item => item.classList.remove('active'));
            document.querySelector('.sidebar-item[onclick="showNewsList()"]').classList.add('active');
        }

        // åŠ è½½æ‰€æœ‰èµ„è®¯
        async function loadAllNews() {
            try {
                // ä¼˜å…ˆä½¿ç”¨ContentSyncManageråŒæ­¥åçš„æ•°æ®
                const syncedNews = JSON.parse(localStorage.getItem('visndt_news') || '[]');
                if (syncedNews.length > 0) {
                    console.log(`âœ… åŠ è½½åŒæ­¥åçš„æ–°é—»æ•°æ®: ${syncedNews.length} æ¡æ–°é—»`);
                    return syncedNews;
                }

                // å¦‚æœæ²¡æœ‰åŒæ­¥æ•°æ®ï¼Œè¿”å›é»˜è®¤æ•°æ®
                return [
                    {
                        id: 'news-001',
                        title: 'å·¥ä¸šå†…çª¥é•œæŠ€æœ¯å‘å±•è¶‹åŠ¿',
                        summary: 'æ¢è®¨å·¥ä¸šå†…çª¥é•œåœ¨ç°ä»£åˆ¶é€ ä¸šä¸­çš„åº”ç”¨å‰æ™¯å’ŒæŠ€æœ¯å‘å±•æ–¹å‘',
                        content: 'éšç€å·¥ä¸š4.0çš„å‘å±•ï¼Œå·¥ä¸šå†…çª¥é•œæŠ€æœ¯æ­£åœ¨ç»å†å‰æ‰€æœªæœ‰çš„å˜é©...',
                        category: 'æŠ€æœ¯èµ„è®¯',
                        tags: ['å·¥ä¸šå†…çª¥é•œ', 'æŠ€æœ¯å‘å±•', 'åˆ¶é€ ä¸š'],
                        author: 'æŠ€æœ¯éƒ¨',
                        publishDate: '2024-06-20',
                        status: 'å·²å‘å¸ƒ',
                        views: 1250,
                        featured: true,
                        image: '/images/news/news-1.jpg'
                    },
                    {
                        id: 'news-002',
                        title: 'æ–°äº§å“å‘å¸ƒï¼šé«˜æ¸…ç”µå­å†…çª¥é•œç³»åˆ—',
                        summary: 'å…¬å¸æœ€æ–°æ¨å‡ºçš„é«˜æ¸…ç”µå­å†…çª¥é•œç³»åˆ—äº§å“æ­£å¼å‘å¸ƒ',
                        content: 'æˆ‘ä»¬å¾ˆé«˜å…´åœ°å®£å¸ƒï¼Œç»è¿‡ä¸¤å¹´çš„ç ”å‘ï¼Œæ–°ä¸€ä»£é«˜æ¸…ç”µå­å†…çª¥é•œç³»åˆ—äº§å“æ­£å¼å‘å¸ƒ...',
                        category: 'äº§å“å‘å¸ƒ',
                        tags: ['æ–°äº§å“', 'ç”µå­å†…çª¥é•œ', 'é«˜æ¸…'],
                        author: 'å¸‚åœºéƒ¨',
                        publishDate: '2024-06-18',
                        status: 'å·²å‘å¸ƒ',
                        views: 890,
                        featured: false,
                        image: '/images/news/news-2.jpg'
                    },
                    {
                        id: 'news-003',
                        title: 'å‚å±•2024å·¥ä¸šæ£€æµ‹è®¾å¤‡å±•è§ˆä¼š',
                        summary: 'å…¬å¸å°†å‚åŠ åœ¨ä¸Šæµ·ä¸¾åŠçš„2024å¹´å·¥ä¸šæ£€æµ‹è®¾å¤‡å±•è§ˆä¼š',
                        content: 'æˆ‘ä»¬å°†äº2024å¹´7æœˆåœ¨ä¸Šæµ·æ–°å›½é™…åšè§ˆä¸­å¿ƒå‚åŠ å·¥ä¸šæ£€æµ‹è®¾å¤‡å±•è§ˆä¼š...',
                        category: 'å…¬å¸åŠ¨æ€',
                        tags: ['å±•è§ˆä¼š', 'å·¥ä¸šæ£€æµ‹', 'ä¸Šæµ·'],
                        author: 'å¸‚åœºéƒ¨',
                        publishDate: '2024-06-15',
                        status: 'è‰ç¨¿',
                        views: 0,
                        featured: false,
                        image: '/images/news/news-3.jpg'
                    }
                ];
            } catch (error) {
                console.error('åŠ è½½èµ„è®¯æ•°æ®å¤±è´¥:', error);
                return [];
            }
        }

        // æ¸²æŸ“èµ„è®¯åˆ—è¡¨
        function renderNewsList() {
            const contentBody = document.getElementById('contentBody');

            const toolbarHtml = `
                <div class="list-toolbar">
                    <div class="toolbar-left">
                        <select class="form-select form-select-sm" id="categoryFilter" onchange="filterNewsByCategory()">
                            <option value="">æ‰€æœ‰åˆ†ç±»</option>
                            <option value="æŠ€æœ¯èµ„è®¯">æŠ€æœ¯èµ„è®¯</option>
                            <option value="äº§å“å‘å¸ƒ">äº§å“å‘å¸ƒ</option>
                            <option value="å…¬å¸åŠ¨æ€">å…¬å¸åŠ¨æ€</option>
                            <option value="è¡Œä¸šæ–°é—»">è¡Œä¸šæ–°é—»</option>
                        </select>
                        <select class="form-select form-select-sm" id="statusFilter" onchange="filterNewsByStatus()">
                            <option value="">æ‰€æœ‰çŠ¶æ€</option>
                            <option value="å·²å‘å¸ƒ">å·²å‘å¸ƒ</option>
                            <option value="è‰ç¨¿">è‰ç¨¿</option>
                            <option value="å¾…å®¡æ ¸">å¾…å®¡æ ¸</option>
                        </select>
                        <input type="text" class="form-control form-control-sm" id="searchInput" placeholder="æœç´¢æ ‡é¢˜æˆ–å†…å®¹..." onkeyup="searchNews()">
                    </div>
                    <div class="toolbar-right">
                        <span class="text-muted">å…± ${filteredNews.length} æ¡è®°å½•</span>
                    </div>
                </div>
            `;

            const tableHtml = `
                <table class="table table-hover">
                    <thead>
                        <tr>
                            <th width="50">
                                <input type="checkbox" id="selectAll" onchange="toggleSelectAll('news')">
                            </th>
                            <th width="80">å°é¢</th>
                            <th>æ ‡é¢˜</th>
                            <th width="100">åˆ†ç±»</th>
                            <th width="80">ä½œè€…</th>
                            <th width="100">å‘å¸ƒæ—¥æœŸ</th>
                            <th width="80">çŠ¶æ€</th>
                            <th width="80">æµè§ˆé‡</th>
                            <th width="120">æ“ä½œ</th>
                        </tr>
                    </thead>
                    <tbody>
                        ${filteredNews.map(news => `
                            <tr>
                                <td>
                                    <input type="checkbox" class="item-checkbox" value="${news.id}">
                                </td>
                                <td>
                                    <img src="${news.image}" alt="${news.title}" class="table-image">
                                </td>
                                <td>
                                    <div class="item-title">
                                        ${news.featured ? '<i class="fas fa-star text-warning me-1" title="æ¨è"></i>' : ''}
                                        ${news.title}
                                    </div>
                                    <div class="item-summary">${news.summary}</div>
                                </td>
                                <td>
                                    <span class="badge bg-secondary">${news.category}</span>
                                </td>
                                <td>${news.author}</td>
                                <td>${news.publishDate}</td>
                                <td>
                                    <span class="badge ${news.status === 'å·²å‘å¸ƒ' ? 'bg-success' : news.status === 'è‰ç¨¿' ? 'bg-warning' : 'bg-info'}">${news.status}</span>
                                </td>
                                <td>${news.views}</td>
                                <td>
                                    <div class="action-buttons">
                                        <button class="action-btn view" onclick="viewNews('${news.id}')" title="æŸ¥çœ‹">
                                            <i class="fas fa-eye"></i>
                                        </button>
                                        <button class="action-btn edit" onclick="editNews('${news.id}')" title="ç¼–è¾‘">
                                            <i class="fas fa-edit"></i>
                                        </button>
                                        <button class="action-btn" onclick="copyNews('${news.id}')" title="å¤åˆ¶">
                                            <i class="fas fa-copy"></i>
                                        </button>
                                        <button class="action-btn delete" onclick="deleteNews('${news.id}')" title="åˆ é™¤">
                                            <i class="fas fa-trash"></i>
                                        </button>
                                    </div>
                                </td>
                            </tr>
                        `).join('')}
                    </tbody>
                </table>
            `;

            contentBody.innerHTML = toolbarHtml + tableHtml;

            // è®¾ç½®æ´»åŠ¨çŠ¶æ€
            document.querySelectorAll('.sidebar-item').forEach(item => item.classList.remove('active'));
            document.querySelector('.sidebar-item[onclick="showNewsList()"]').classList.add('active');
        }

        // èµ„è®¯ç­›é€‰åŠŸèƒ½
        function filterNewsByCategory() {
            const category = document.getElementById('categoryFilter').value;
            applyNewsFilters();
        }

        function filterNewsByStatus() {
            const status = document.getElementById('statusFilter').value;
            applyNewsFilters();
        }

        function searchNews() {
            applyNewsFilters();
        }

        function applyNewsFilters() {
            const category = document.getElementById('categoryFilter')?.value || '';
            const status = document.getElementById('statusFilter')?.value || '';
            const search = document.getElementById('searchInput')?.value.toLowerCase() || '';

            filteredNews = allNews.filter(news => {
                const matchesCategory = !category || news.category === category;
                const matchesStatus = !status || news.status === status;
                const matchesSearch = !search ||
                    news.title.toLowerCase().includes(search) ||
                    news.summary.toLowerCase().includes(search) ||
                    news.content.toLowerCase().includes(search);

                return matchesCategory && matchesStatus && matchesSearch;
            });

            renderNewsList();
        }

        // æ¡ˆä¾‹ç®¡ç†åŠŸèƒ½
        let allCases = [];
        let filteredCases = [];
        let editingCase = null;

        function showCasesList() {
            currentSection = 'cases';
            document.getElementById('contentTitle').textContent = 'æ¡ˆä¾‹ç®¡ç†';
            document.getElementById('contentSubtitle').textContent = 'ç®¡ç†åº”ç”¨æ¡ˆä¾‹å†…å®¹';

            const actionsHtml = `
                <button class="btn btn-primary" onclick="addCase()">
                    <i class="fas fa-plus me-1"></i>æ·»åŠ æ¡ˆä¾‹
                </button>
                <button class="btn btn-success" onclick="refreshCasesList()">
                    <i class="fas fa-sync me-1"></i>åˆ·æ–°åˆ—è¡¨
                </button>
                <button class="btn btn-info" onclick="exportCases()">
                    <i class="fas fa-download me-1"></i>å¯¼å‡ºæ•°æ®
                </button>
                <button class="btn btn-warning" onclick="importCases()">
                    <i class="fas fa-upload me-1"></i>å¯¼å…¥æ•°æ®
                </button>
                <button class="btn btn-secondary" onclick="generateCaseHugoFiles()">
                    <i class="fas fa-code me-1"></i>ç”ŸæˆHugoæ–‡ä»¶
                </button>
            `;
            document.getElementById('contentActions').innerHTML = actionsHtml;

            try {
                // åŠ è½½æ¡ˆä¾‹æ•°æ®
                allCases = loadAllCases();
                filteredCases = [...allCases];
                renderCasesList();
            } catch (error) {
                console.error('åŠ è½½æ¡ˆä¾‹åˆ—è¡¨å¤±è´¥:', error);
                document.getElementById('contentBody').innerHTML = `
                    <div class="alert alert-warning">
                        <i class="fas fa-exclamation-triangle me-2"></i>
                        åŠ è½½æ¡ˆä¾‹åˆ—è¡¨å¤±è´¥: ${error.message}
                        <button class="btn btn-outline-warning btn-sm ms-2" onclick="showCasesList()">é‡è¯•</button>
                    </div>
                `;
            }

            document.querySelectorAll('.sidebar-item').forEach(item => item.classList.remove('active'));
            document.querySelector('.sidebar-item[onclick="showCasesList()"]').classList.add('active');
        }

        // åŠ è½½æ‰€æœ‰æ¡ˆä¾‹
        function loadAllCases() {
            try {
                // ä¼˜å…ˆä½¿ç”¨ContentSyncManageråŒæ­¥åçš„æ•°æ®
                const syncedCases = JSON.parse(localStorage.getItem('visndt_cases') || '[]');
                if (syncedCases.length > 0) {
                    console.log(`âœ… åŠ è½½åŒæ­¥åçš„æ¡ˆä¾‹æ•°æ®: ${syncedCases.length} ä¸ªæ¡ˆä¾‹`);
                    return syncedCases;
                }

                // å¦‚æœæ²¡æœ‰åŒæ­¥æ•°æ®ï¼Œè¿”å›é»˜è®¤æ•°æ®
                return [
                {
                    id: 'case-001',
                    title: 'èˆªç©ºå‘åŠ¨æœºå¶ç‰‡æ£€æµ‹æ¡ˆä¾‹',
                    summary: 'ä½¿ç”¨å·¥ä¸šå†…çª¥é•œå¯¹èˆªç©ºå‘åŠ¨æœºå¶ç‰‡è¿›è¡Œæ— æŸæ£€æµ‹ï¼Œå‘ç°å¹¶ä¿®å¤äº†å…³é”®ç¼ºé™·',
                    content: 'æŸèˆªç©ºå…¬å¸åœ¨ä¾‹è¡Œç»´æŠ¤ä¸­ï¼Œä½¿ç”¨æˆ‘ä»¬çš„é«˜æ¸…å·¥ä¸šå†…çª¥é•œå¯¹å‘åŠ¨æœºå¶ç‰‡è¿›è¡Œæ£€æµ‹...',
                    industry: 'èˆªç©ºèˆªå¤©',
                    productCategory: 'ç”µå­å†…çª¥é•œ',
                    productModel: 'WS-K1210',
                    applicationField: 'å‘åŠ¨æœºæ£€æµ‹',
                    client: 'æŸèˆªç©ºå…¬å¸',
                    projectDate: '2024-05-15',
                    status: 'å·²å‘å¸ƒ',
                    featured: true,
                    tags: ['èˆªç©º', 'å‘åŠ¨æœº', 'å¶ç‰‡æ£€æµ‹', 'æ— æŸæ£€æµ‹'],
                    images: [
                        '/images/cases/case-1.webp',
                        '/images/cases/case-2.webp',
                        '/images/cases/case-3.webp'
                    ],
                    results: 'æˆåŠŸå‘ç°3å¤„å¾®å°è£‚çº¹ï¼Œé¿å…äº†æ½œåœ¨çš„å®‰å…¨éšæ‚£',
                    benefits: 'æé«˜äº†æ£€æµ‹æ•ˆç‡50%ï¼Œé™ä½äº†ç»´æŠ¤æˆæœ¬30%'
                },
                {
                    id: 'case-002',
                    title: 'æ±½è½¦åˆ¶é€ ç„Šç¼è´¨é‡æ£€æµ‹',
                    summary: 'åœ¨æ±½è½¦ç”Ÿäº§çº¿ä¸Šä½¿ç”¨å†…çª¥é•œæ£€æµ‹ç„Šç¼è´¨é‡ï¼Œç¡®ä¿äº§å“å®‰å…¨æ€§',
                    content: 'æŸæ±½è½¦åˆ¶é€ å•†åœ¨ç”Ÿäº§è¿‡ç¨‹ä¸­ï¼Œé‡‡ç”¨æˆ‘ä»¬çš„å·¥ä¸šå†…çª¥é•œå¯¹å…³é”®ç„Šç¼è¿›è¡Œè´¨é‡æ£€æµ‹...',
                    industry: 'æ±½è½¦åˆ¶é€ ',
                    productCategory: 'ç”µå­å†…çª¥é•œ',
                    productModel: 'P1510',
                    applicationField: 'ç„Šç¼æ£€æµ‹',
                    client: 'æŸæ±½è½¦åˆ¶é€ å•†',
                    projectDate: '2024-04-20',
                    status: 'å·²å‘å¸ƒ',
                    featured: false,
                    tags: ['æ±½è½¦', 'ç„Šç¼', 'è´¨é‡æ£€æµ‹', 'ç”Ÿäº§çº¿'],
                    images: [
                        '/images/cases/case-4.webp',
                        '/images/cases/case-5.webp'
                    ],
                    results: 'æ£€æµ‹å‡º98%çš„ç„Šç¼ç¼ºé™·ï¼Œå¤§å¹…æå‡äº§å“è´¨é‡',
                    benefits: 'å‡å°‘äº†è¿”å·¥ç‡ï¼Œæé«˜äº†ç”Ÿäº§æ•ˆç‡'
                },
                {
                    id: 'case-003',
                    title: 'é£ç”µé½¿è½®ç®±å†…éƒ¨æ£€æµ‹',
                    summary: 'å¯¹é£åŠ›å‘ç”µæœºé½¿è½®ç®±è¿›è¡Œå†…éƒ¨æ£€æµ‹ï¼Œé¢„é˜²è®¾å¤‡æ•…éšœ',
                    content: 'æŸé£ç”µåœºä½¿ç”¨æˆ‘ä»¬çš„æŸ”æ€§å†…çª¥é•œå¯¹é£åŠ›å‘ç”µæœºé½¿è½®ç®±è¿›è¡Œå®šæœŸæ£€æµ‹...',
                    industry: 'æ–°èƒ½æº',
                    productCategory: 'å…‰çº¤å†…çª¥é•œ',
                    productModel: 'K1810',
                    applicationField: 'è®¾å¤‡ç»´æŠ¤',
                    client: 'æŸé£ç”µåœº',
                    projectDate: '2024-03-10',
                    status: 'è‰ç¨¿',
                    featured: false,
                    tags: ['é£ç”µ', 'é½¿è½®ç®±', 'è®¾å¤‡ç»´æŠ¤', 'é¢„é˜²æ€§æ£€æµ‹'],
                    images: [
                        '/images/cases/case-6.webp'
                    ],
                    results: 'æå‰å‘ç°é½¿è½®ç£¨æŸï¼Œé¿å…äº†è®¾å¤‡åœæœº',
                    benefits: 'å»¶é•¿äº†è®¾å¤‡ä½¿ç”¨å¯¿å‘½ï¼Œé™ä½äº†ç»´æŠ¤æˆæœ¬'
                }
            ];
        }

        // æ¸²æŸ“æ¡ˆä¾‹åˆ—è¡¨
        function renderCasesList() {
            const contentBody = document.getElementById('contentBody');

            const toolbarHtml = `
                <div class="list-toolbar">
                    <div class="toolbar-left">
                        <select class="form-select form-select-sm" id="industryFilter" onchange="filterCasesByIndustry()">
                            <option value="">æ‰€æœ‰è¡Œä¸š</option>
                            <option value="èˆªç©ºèˆªå¤©">èˆªç©ºèˆªå¤©</option>
                            <option value="æ±½è½¦åˆ¶é€ ">æ±½è½¦åˆ¶é€ </option>
                            <option value="æ–°èƒ½æº">æ–°èƒ½æº</option>
                            <option value="çŸ³æ²¹åŒ–å·¥">çŸ³æ²¹åŒ–å·¥</option>
                            <option value="ç”µåŠ›">ç”µåŠ›</option>
                        </select>
                        <select class="form-select form-select-sm" id="caseStatusFilter" onchange="filterCasesByStatus()">
                            <option value="">æ‰€æœ‰çŠ¶æ€</option>
                            <option value="å·²å‘å¸ƒ">å·²å‘å¸ƒ</option>
                            <option value="è‰ç¨¿">è‰ç¨¿</option>
                            <option value="å¾…å®¡æ ¸">å¾…å®¡æ ¸</option>
                        </select>
                        <input type="text" class="form-control form-control-sm" id="caseSearchInput" placeholder="æœç´¢æ¡ˆä¾‹æ ‡é¢˜æˆ–å†…å®¹..." onkeyup="searchCases()">
                    </div>
                    <div class="toolbar-right">
                        <span class="text-muted">å…± ${filteredCases.length} æ¡è®°å½•</span>
                    </div>
                </div>
            `;

            const tableHtml = `
                <table class="table table-hover">
                    <thead>
                        <tr>
                            <th width="50">
                                <input type="checkbox" id="selectAllCases" onchange="toggleSelectAll('cases')">
                            </th>
                            <th width="80">å°é¢</th>
                            <th>æ¡ˆä¾‹æ ‡é¢˜</th>
                            <th width="100">è¡Œä¸š</th>
                            <th width="100">äº§å“å‹å·</th>
                            <th width="100">å®¢æˆ·</th>
                            <th width="100">é¡¹ç›®æ—¥æœŸ</th>
                            <th width="80">çŠ¶æ€</th>
                            <th width="120">æ“ä½œ</th>
                        </tr>
                    </thead>
                    <tbody>
                        ${filteredCases.map(caseItem => `
                            <tr>
                                <td>
                                    <input type="checkbox" class="item-checkbox" value="${caseItem.id}">
                                </td>
                                <td>
                                    <img src="${caseItem.images[0]}" alt="${caseItem.title}" class="table-image">
                                </td>
                                <td>
                                    <div class="item-title">
                                        ${caseItem.featured ? '<i class="fas fa-star text-warning me-1" title="æ¨è"></i>' : ''}
                                        ${caseItem.title}
                                    </div>
                                    <div class="item-summary">${caseItem.summary}</div>
                                </td>
                                <td>
                                    <span class="badge bg-info">${caseItem.industry}</span>
                                </td>
                                <td>${caseItem.productModel}</td>
                                <td>${caseItem.client}</td>
                                <td>${caseItem.projectDate}</td>
                                <td>
                                    <span class="badge ${caseItem.status === 'å·²å‘å¸ƒ' ? 'bg-success' : caseItem.status === 'è‰ç¨¿' ? 'bg-warning' : 'bg-info'}">${caseItem.status}</span>
                                </td>
                                <td>
                                    <div class="action-buttons">
                                        <button class="action-btn view" onclick="viewCase('${caseItem.id}')" title="æŸ¥çœ‹">
                                            <i class="fas fa-eye"></i>
                                        </button>
                                        <button class="action-btn edit" onclick="editCase('${caseItem.id}')" title="ç¼–è¾‘">
                                            <i class="fas fa-edit"></i>
                                        </button>
                                        <button class="action-btn" onclick="copyCase('${caseItem.id}')" title="å¤åˆ¶">
                                            <i class="fas fa-copy"></i>
                                        </button>
                                        <button class="action-btn delete" onclick="deleteCase('${caseItem.id}')" title="åˆ é™¤">
                                            <i class="fas fa-trash"></i>
                                        </button>
                                    </div>
                                </td>
                            </tr>
                        `).join('')}
                    </tbody>
                </table>
            `;

            contentBody.innerHTML = toolbarHtml + tableHtml;

            // è®¾ç½®æ´»åŠ¨çŠ¶æ€
            document.querySelectorAll('.sidebar-item').forEach(item => item.classList.remove('active'));
            document.querySelector('.sidebar-item[onclick="showCasesList()"]').classList.add('active');
        }

        // æ¡ˆä¾‹ç­›é€‰åŠŸèƒ½
        function filterCasesByIndustry() {
            applyCasesFilters();
        }

        function filterCasesByStatus() {
            applyCasesFilters();
        }

        function searchCases() {
            applyCasesFilters();
        }

        function applyCasesFilters() {
            const industry = document.getElementById('industryFilter')?.value || '';
            const status = document.getElementById('caseStatusFilter')?.value || '';
            const search = document.getElementById('caseSearchInput')?.value.toLowerCase() || '';

            filteredCases = allCases.filter(caseItem => {
                const matchesIndustry = !industry || caseItem.industry === industry;
                const matchesStatus = !status || caseItem.status === status;
                const matchesSearch = !search ||
                    caseItem.title.toLowerCase().includes(search) ||
                    caseItem.summary.toLowerCase().includes(search) ||
                    caseItem.content.toLowerCase().includes(search) ||
                    caseItem.client.toLowerCase().includes(search);

                return matchesIndustry && matchesStatus && matchesSearch;
            });

            renderCasesList();
        }

        // åº”ç”¨é¢†åŸŸç®¡ç†åŠŸèƒ½
        let allApplications = [];
        let filteredApplications = [];
        let editingApplication = null;

        function showApplications() {
            currentSection = 'applications';
            document.getElementById('contentTitle').textContent = 'åº”ç”¨é¢†åŸŸç®¡ç†';
            document.getElementById('contentSubtitle').textContent = 'ç®¡ç†åº”ç”¨é¢†åŸŸå†…å®¹';

            const actionsHtml = `
                <button class="btn btn-primary" onclick="addApplication()">
                    <i class="fas fa-plus me-1"></i>æ·»åŠ åº”ç”¨é¢†åŸŸ
                </button>
                <button class="btn btn-success" onclick="refreshApplicationsList()">
                    <i class="fas fa-sync me-1"></i>åˆ·æ–°åˆ—è¡¨
                </button>
                <button class="btn btn-info" onclick="exportApplications()">
                    <i class="fas fa-download me-1"></i>å¯¼å‡ºæ•°æ®
                </button>
                <button class="btn btn-warning" onclick="importApplications()">
                    <i class="fas fa-upload me-1"></i>å¯¼å…¥æ•°æ®
                </button>
            `;
            document.getElementById('contentActions').innerHTML = actionsHtml;

            try {
                // åŠ è½½åº”ç”¨é¢†åŸŸæ•°æ®
                allApplications = loadAllApplications();
                filteredApplications = [...allApplications];
                renderApplicationsList();
            } catch (error) {
                console.error('åŠ è½½åº”ç”¨é¢†åŸŸåˆ—è¡¨å¤±è´¥:', error);
                document.getElementById('contentBody').innerHTML = `
                    <div class="alert alert-warning">
                        <i class="fas fa-exclamation-triangle me-2"></i>
                        åŠ è½½åº”ç”¨é¢†åŸŸåˆ—è¡¨å¤±è´¥: ${error.message}
                        <button class="btn btn-outline-warning btn-sm ms-2" onclick="showApplications()">é‡è¯•</button>
                    </div>
                `;
            }

            document.querySelectorAll('.sidebar-item').forEach(item => item.classList.remove('active'));
            document.querySelector('.sidebar-item[onclick="showApplications()"]').classList.add('active');
        }

        // åŠ è½½æ‰€æœ‰åº”ç”¨é¢†åŸŸ
        function loadAllApplications() {
            try {
                // ä¼˜å…ˆä½¿ç”¨ContentSyncManageråŒæ­¥åçš„æ•°æ®
                const syncedApplications = JSON.parse(localStorage.getItem('visndt_applications') || '[]');
                if (syncedApplications.length > 0) {
                    console.log(`âœ… åŠ è½½åŒæ­¥åçš„åº”ç”¨é¢†åŸŸæ•°æ®: ${syncedApplications.length} ä¸ªåº”ç”¨é¢†åŸŸ`);
                    return syncedApplications;
                }

                // å¦‚æœæ²¡æœ‰åŒæ­¥æ•°æ®ï¼Œè¿”å›é»˜è®¤æ•°æ®
                return [
                {
                    id: 'app-001',
                    title: 'èˆªç©ºèˆªå¤©æ£€æµ‹',
                    description: 'èˆªç©ºå‘åŠ¨æœºã€æœºèº«ç»“æ„ã€ç‡ƒæ²¹ç³»ç»Ÿç­‰å…³é”®éƒ¨ä»¶çš„æ— æŸæ£€æµ‹',
                    icon: 'fas fa-plane',
                    category: 'å·¥ä¸šæ£€æµ‹',
                    products: ['WS-K1210', 'WS-K1510', 'P1810'],
                    scenarios: [
                        'å‘åŠ¨æœºå¶ç‰‡æ£€æµ‹',
                        'ç‡ƒæ²¹ç®¡è·¯æ£€æµ‹',
                        'æœºèº«ç»“æ„æ£€æµ‹',
                        'èµ·è½æ¶æ£€æµ‹'
                    ],
                    advantages: [
                        'é«˜ç²¾åº¦æ£€æµ‹',
                        'æ— æŸæ£€æµ‹',
                        'å®æ—¶æˆåƒ',
                        'æ“ä½œç®€ä¾¿'
                    ],
                    status: 'å·²å‘å¸ƒ',
                    featured: true,
                    image: '/images/application/aviation.jpg',
                    content: 'èˆªç©ºèˆªå¤©é¢†åŸŸå¯¹å®‰å…¨æ€§è¦æ±‚æé«˜ï¼Œæˆ‘ä»¬çš„å·¥ä¸šå†…çª¥é•œäº§å“èƒ½å¤Ÿ...'
                },
                {
                    id: 'app-002',
                    title: 'æ±½è½¦åˆ¶é€ æ£€æµ‹',
                    description: 'æ±½è½¦å‘åŠ¨æœºã€å˜é€Ÿç®±ã€åˆ¶åŠ¨ç³»ç»Ÿç­‰éƒ¨ä»¶çš„è´¨é‡æ£€æµ‹',
                    icon: 'fas fa-car',
                    category: 'åˆ¶é€ ä¸š',
                    products: ['P1510', 'P2010', 'K1810'],
                    scenarios: [
                        'å‘åŠ¨æœºç¼¸ä½“æ£€æµ‹',
                        'å˜é€Ÿç®±æ£€æµ‹',
                        'ç„Šç¼è´¨é‡æ£€æµ‹',
                        'ç®¡è·¯æ£€æµ‹'
                    ],
                    advantages: [
                        'æé«˜ç”Ÿäº§æ•ˆç‡',
                        'é™ä½è¿”å·¥ç‡',
                        'ç¡®ä¿äº§å“è´¨é‡',
                        'å‡å°‘äººå·¥æˆæœ¬'
                    ],
                    status: 'å·²å‘å¸ƒ',
                    featured: true,
                    image: '/images/application/automotive.jpg',
                    content: 'æ±½è½¦åˆ¶é€ è¿‡ç¨‹ä¸­ï¼Œè´¨é‡æ§åˆ¶æ˜¯å…³é”®ç¯èŠ‚ï¼Œæˆ‘ä»¬çš„æ£€æµ‹è®¾å¤‡èƒ½å¤Ÿ...'
                },
                {
                    id: 'app-003',
                    title: 'çŸ³æ²¹åŒ–å·¥æ£€æµ‹',
                    description: 'ç®¡é“ã€å®¹å™¨ã€è®¾å¤‡å†…éƒ¨çš„è…èš€ã€è£‚çº¹ç­‰ç¼ºé™·æ£€æµ‹',
                    icon: 'fas fa-industry',
                    category: 'çŸ³åŒ–è¡Œä¸š',
                    products: ['K1210', 'P2410', 'DZ60'],
                    scenarios: [
                        'ç®¡é“è…èš€æ£€æµ‹',
                        'å®¹å™¨å†…å£æ£€æµ‹',
                        'å‚¬åŒ–å‰‚æ£€æµ‹',
                        'è®¾å¤‡ç»´æŠ¤æ£€æµ‹'
                    ],
                    advantages: [
                        'é˜²çˆ†å®‰å…¨',
                        'è€è…èš€',
                        'é«˜æ¸©é€‚åº”',
                        'è¿œç¨‹æ“ä½œ'
                    ],
                    status: 'å·²å‘å¸ƒ',
                    featured: false,
                    image: '/images/application/petrochemical.jpg',
                    content: 'çŸ³æ²¹åŒ–å·¥è¡Œä¸šç¯å¢ƒå¤æ‚ï¼Œå¯¹æ£€æµ‹è®¾å¤‡è¦æ±‚ä¸¥æ ¼ï¼Œæˆ‘ä»¬çš„äº§å“å…·å¤‡...'
                },
                {
                    id: 'app-004',
                    title: 'ç”µåŠ›è®¾å¤‡æ£€æµ‹',
                    description: 'å‘ç”µæœºã€å˜å‹å™¨ã€å¼€å…³è®¾å¤‡ç­‰ç”µåŠ›è®¾å¤‡çš„å†…éƒ¨æ£€æµ‹',
                    icon: 'fas fa-bolt',
                    category: 'ç”µåŠ›è¡Œä¸š',
                    products: ['K1510', 'P1810', 'P2210'],
                    scenarios: [
                        'å‘ç”µæœºæ£€æµ‹',
                        'å˜å‹å™¨æ£€æµ‹',
                        'å¼€å…³æŸœæ£€æµ‹',
                        'ç”µç¼†æ£€æµ‹'
                    ],
                    advantages: [
                        'ç»ç¼˜å®‰å…¨',
                        'é«˜æ¸…æˆåƒ',
                        'ä¾¿æºæ“ä½œ',
                        'å¿«é€Ÿè¯Šæ–­'
                    ],
                    status: 'è‰ç¨¿',
                    featured: false,
                    image: '/images/application/power.jpg',
                    content: 'ç”µåŠ›è®¾å¤‡çš„å¯é æ€§ç›´æ¥å…³ç³»åˆ°ä¾›ç”µå®‰å…¨ï¼Œæˆ‘ä»¬çš„æ£€æµ‹æ–¹æ¡ˆ...'
                }
            ];
        }

        // æ¸²æŸ“åº”ç”¨é¢†åŸŸåˆ—è¡¨
        function renderApplicationsList() {
            const contentBody = document.getElementById('contentBody');

            const toolbarHtml = `
                <div class="list-toolbar">
                    <div class="toolbar-left">
                        <select class="form-select form-select-sm" id="appCategoryFilter" onchange="filterApplicationsByCategory()">
                            <option value="">æ‰€æœ‰åˆ†ç±»</option>
                            <option value="å·¥ä¸šæ£€æµ‹">å·¥ä¸šæ£€æµ‹</option>
                            <option value="åˆ¶é€ ä¸š">åˆ¶é€ ä¸š</option>
                            <option value="çŸ³åŒ–è¡Œä¸š">çŸ³åŒ–è¡Œä¸š</option>
                            <option value="ç”µåŠ›è¡Œä¸š">ç”µåŠ›è¡Œä¸š</option>
                            <option value="å»ºç­‘å·¥ç¨‹">å»ºç­‘å·¥ç¨‹</option>
                        </select>
                        <select class="form-select form-select-sm" id="appStatusFilter" onchange="filterApplicationsByStatus()">
                            <option value="">æ‰€æœ‰çŠ¶æ€</option>
                            <option value="å·²å‘å¸ƒ">å·²å‘å¸ƒ</option>
                            <option value="è‰ç¨¿">è‰ç¨¿</option>
                            <option value="å¾…å®¡æ ¸">å¾…å®¡æ ¸</option>
                        </select>
                        <input type="text" class="form-control form-control-sm" id="appSearchInput" placeholder="æœç´¢åº”ç”¨é¢†åŸŸ..." onkeyup="searchApplications()">
                    </div>
                    <div class="toolbar-right">
                        <span class="text-muted">å…± ${filteredApplications.length} æ¡è®°å½•</span>
                    </div>
                </div>
            `;

            const tableHtml = `
                <table class="table table-hover">
                    <thead>
                        <tr>
                            <th width="50">
                                <input type="checkbox" id="selectAllApps" onchange="toggleSelectAll('applications')">
                            </th>
                            <th width="80">å›¾æ ‡</th>
                            <th>åº”ç”¨é¢†åŸŸ</th>
                            <th width="100">åˆ†ç±»</th>
                            <th width="120">é€‚ç”¨äº§å“</th>
                            <th width="80">çŠ¶æ€</th>
                            <th width="120">æ“ä½œ</th>
                        </tr>
                    </thead>
                    <tbody>
                        ${filteredApplications.map(app => `
                            <tr>
                                <td>
                                    <input type="checkbox" class="item-checkbox" value="${app.id}">
                                </td>
                                <td>
                                    <div class="app-icon">
                                        <i class="${app.icon} fa-2x text-primary"></i>
                                    </div>
                                </td>
                                <td>
                                    <div class="item-title">
                                        ${app.featured ? '<i class="fas fa-star text-warning me-1" title="æ¨è"></i>' : ''}
                                        ${app.title}
                                    </div>
                                    <div class="item-summary">${app.description}</div>
                                </td>
                                <td>
                                    <span class="badge bg-primary">${app.category}</span>
                                </td>
                                <td>
                                    <div class="product-tags">
                                        ${app.products.slice(0, 2).map(product => `<span class="badge bg-secondary me-1">${product}</span>`).join('')}
                                        ${app.products.length > 2 ? `<span class="text-muted">+${app.products.length - 2}</span>` : ''}
                                    </div>
                                </td>
                                <td>
                                    <span class="badge ${app.status === 'å·²å‘å¸ƒ' ? 'bg-success' : app.status === 'è‰ç¨¿' ? 'bg-warning' : 'bg-info'}">${app.status}</span>
                                </td>
                                <td>
                                    <div class="action-buttons">
                                        <button class="action-btn view" onclick="viewApplication('${app.id}')" title="æŸ¥çœ‹">
                                            <i class="fas fa-eye"></i>
                                        </button>
                                        <button class="action-btn edit" onclick="editApplication('${app.id}')" title="ç¼–è¾‘">
                                            <i class="fas fa-edit"></i>
                                        </button>
                                        <button class="action-btn" onclick="copyApplication('${app.id}')" title="å¤åˆ¶">
                                            <i class="fas fa-copy"></i>
                                        </button>
                                        <button class="action-btn delete" onclick="deleteApplication('${app.id}')" title="åˆ é™¤">
                                            <i class="fas fa-trash"></i>
                                        </button>
                                    </div>
                                </td>
                            </tr>
                        `).join('')}
                    </tbody>
                </table>
            `;

            contentBody.innerHTML = toolbarHtml + tableHtml;

            // è®¾ç½®æ´»åŠ¨çŠ¶æ€
            document.querySelectorAll('.sidebar-item').forEach(item => item.classList.remove('active'));
            document.querySelector('.sidebar-item[onclick="showApplications()"]').classList.add('active');
        }

        // åº”ç”¨é¢†åŸŸç­›é€‰åŠŸèƒ½
        function filterApplicationsByCategory() {
            applyApplicationsFilters();
        }

        function filterApplicationsByStatus() {
            applyApplicationsFilters();
        }

        function searchApplications() {
            applyApplicationsFilters();
        }

        function applyApplicationsFilters() {
            const category = document.getElementById('appCategoryFilter')?.value || '';
            const status = document.getElementById('appStatusFilter')?.value || '';
            const search = document.getElementById('appSearchInput')?.value.toLowerCase() || '';

            filteredApplications = allApplications.filter(app => {
                const matchesCategory = !category || app.category === category;
                const matchesStatus = !status || app.status === status;
                const matchesSearch = !search ||
                    app.title.toLowerCase().includes(search) ||
                    app.description.toLowerCase().includes(search) ||
                    app.content.toLowerCase().includes(search);

                return matchesCategory && matchesStatus && matchesSearch;
            });

            renderApplicationsList();
        }



        function showMediaLibrary() {
            currentSection = 'media';
            document.getElementById('contentTitle').textContent = 'åª’ä½“åº“ç®¡ç†';
            document.getElementById('contentSubtitle').textContent = 'ç®¡ç†å›¾ç‰‡ã€æ–‡æ¡£ç­‰åª’ä½“èµ„æº';
            document.getElementById('contentActions').innerHTML = `
                <button class="btn btn-primary" onclick="uploadMedia()">
                    <i class="fas fa-upload me-1"></i>ä¸Šä¼ åª’ä½“
                </button>
            `;
            document.getElementById('contentBody').innerHTML = `
                <div class="text-center py-5">
                    <i class="fas fa-images fa-4x text-muted mb-3"></i>
                    <h4>åª’ä½“åº“ç®¡ç†åŠŸèƒ½</h4>
                    <p class="text-muted">åª’ä½“åº“ç®¡ç†åŠŸèƒ½æ­£åœ¨å¼€å‘ä¸­...</p>
                </div>
            `;

            document.querySelectorAll('.sidebar-item').forEach(item => item.classList.remove('active'));
            document.querySelector('.sidebar-item[onclick="showMediaLibrary()"]').classList.add('active');
        }

        function showSystemSettings() {
            currentSection = 'settings';
            document.getElementById('contentTitle').textContent = 'ç³»ç»Ÿè®¾ç½®';
            document.getElementById('contentSubtitle').textContent = 'ç®¡ç†ç³»ç»Ÿé…ç½®å’Œå‚æ•°';
            document.getElementById('contentActions').innerHTML = '';
            document.getElementById('contentBody').innerHTML = `
                <div class="text-center py-5">
                    <i class="fas fa-sliders-h fa-4x text-muted mb-3"></i>
                    <h4>ç³»ç»Ÿè®¾ç½®åŠŸèƒ½</h4>
                    <p class="text-muted">ç³»ç»Ÿè®¾ç½®åŠŸèƒ½æ­£åœ¨å¼€å‘ä¸­...</p>
                </div>
            `;

            document.querySelectorAll('.sidebar-item').forEach(item => item.classList.remove('active'));
            document.querySelector('.sidebar-item[onclick="showSystemSettings()"]').classList.add('active');
        }

        // æœåŠ¡å™¨çŠ¶æ€æ£€æŸ¥
        async function checkServerStatus() {
            const statusElement = document.getElementById('serverStatus');
            const syncBtn = document.getElementById('syncBtn');

            try {
                const isOnline = await window.ProductAPI.checkServerStatus();

                if (isOnline) {
                    statusElement.innerHTML = '<i class="fas fa-circle text-success me-1"></i>æœåŠ¡å™¨åœ¨çº¿';
                    statusElement.title = 'äº§å“ç®¡ç†æœåŠ¡å™¨è¿è¡Œæ­£å¸¸';

                    // æ£€æŸ¥æ˜¯å¦æœ‰æœ¬åœ°æ•°æ®éœ€è¦åŒæ­¥
                    const localProducts = window.ProductAPI.getLocalProducts();
                    const unsyncedCount = localProducts.filter(p => !p.synced).length;

                    if (unsyncedCount > 0) {
                        syncBtn.style.display = 'inline-block';
                        syncBtn.innerHTML = `<i class="fas fa-sync me-1"></i>åŒæ­¥æ•°æ® (${unsyncedCount})`;
                    } else {
                        syncBtn.style.display = 'none';
                    }
                } else {
                    statusElement.innerHTML = '<i class="fas fa-circle text-warning me-1"></i>ç¦»çº¿æ¨¡å¼';
                    statusElement.title = 'æœåŠ¡å™¨ä¸å¯ç”¨ï¼Œæ•°æ®å°†ä¿å­˜åˆ°æœ¬åœ°';
                    syncBtn.style.display = 'none';
                }
            } catch (error) {
                statusElement.innerHTML = '<i class="fas fa-circle text-danger me-1"></i>è¿æ¥å¤±è´¥';
                statusElement.title = 'æ— æ³•è¿æ¥åˆ°æœåŠ¡å™¨';
                syncBtn.style.display = 'none';
            }
        }

        // åŒæ­¥æœ¬åœ°æ•°æ®
        async function syncLocalData() {
            const syncBtn = document.getElementById('syncBtn');
            const originalText = syncBtn.innerHTML;

            syncBtn.innerHTML = '<i class="fas fa-spinner fa-spin me-1"></i>åŒæ­¥ä¸­...';
            syncBtn.disabled = true;

            try {
                const result = await window.ProductAPI.syncLocalData();

                if (result.success) {
                    showNotification(result.message, 'success');
                    await checkServerStatus(); // é‡æ–°æ£€æŸ¥çŠ¶æ€
                } else {
                    showNotification(result.message, 'warning');
                }
            } catch (error) {
                showNotification('åŒæ­¥å¤±è´¥: ' + error.message, 'danger');
            } finally {
                syncBtn.innerHTML = originalText;
                syncBtn.disabled = false;
            }
        }

        // å®šæœŸæ£€æŸ¥æœåŠ¡å™¨çŠ¶æ€
        setInterval(checkServerStatus, 30000); // æ¯30ç§’æ£€æŸ¥ä¸€æ¬¡

        // åŒæ­¥åˆ†ç±»åˆ°å‰å°
        async function syncCategoriesToFrontend() {
            const syncBtn = event.target;
            const originalText = syncBtn.innerHTML;

            syncBtn.innerHTML = '<i class="fas fa-spinner fa-spin me-1"></i>åŒæ­¥ä¸­...';
            syncBtn.disabled = true;

            try {
                // å‡†å¤‡åˆ†ç±»æ•°æ®
                const categoriesData = productCategories.map((category, index) => ({
                    id: category.id,
                    title: category.title,
                    description: category.description || category.title + 'äº§å“åˆ†ç±»',
                    weight: (index + 1) * 10,
                    subcategories: category.subcategories || [],
                    icon: category.icon || getCategoryIcon(category.id)
                }));

                // è°ƒç”¨åŒæ­¥API
                const response = await fetch('http://localhost:3001/api/categories/sync', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        categories: categoriesData
                    })
                });

                if (response.ok) {
                    const result = await response.json();
                    showNotification(result.message || 'åˆ†ç±»åŒæ­¥æˆåŠŸ', 'success');

                    // æç¤ºç”¨æˆ·é‡æ–°åŠ è½½Hugo
                    setTimeout(() => {
                        showNotification('è¯·é‡æ–°åŠ è½½HugoæœåŠ¡å™¨ä»¥æŸ¥çœ‹å‰å°æ›´æ–°', 'info');
                    }, 2000);
                } else {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }

            } catch (error) {
                console.error('åŒæ­¥åˆ†ç±»å¤±è´¥:', error);
                showNotification('åŒæ­¥åˆ†ç±»å¤±è´¥: ' + error.message, 'danger');
            } finally {
                syncBtn.innerHTML = originalText;
                syncBtn.disabled = false;
            }
        }

        // è·å–åˆ†ç±»å›¾æ ‡
        function getCategoryIcon(categoryId) {
            const iconMap = {
                'electronic-endoscope': 'fas fa-video',
                'fiber-endoscope': 'fas fa-eye',
                'optical-endoscope': 'fas fa-search',
                'industrial-video-endoscope': 'fas fa-camera',
                'industrial-pipeline-endoscope': 'fas fa-pipe',
                'crawler-robot': 'fas fa-robot',
                'flexible-fiber': 'fas fa-wave-square',
                'rigid-fiber': 'fas fa-minus',
                'rigid-optical': 'fas fa-minus',
                'flexible-optical': 'fas fa-wave-square'
            };
            return iconMap[categoryId] || 'fas fa-folder';
        }

        // èµ„è®¯æ“ä½œåŠŸèƒ½
        function addNews() {
            editingNews = null;
            showNewsModal('æ·»åŠ èµ„è®¯');
        }

        function editNews(newsId) {
            const news = allNews.find(n => n.id === newsId);
            if (!news) {
                showNotification('èµ„è®¯ä¸å­˜åœ¨', 'danger');
                return;
            }
            editingNews = news;
            showNewsModal('ç¼–è¾‘èµ„è®¯', news);
        }

        function viewNews(newsId) {
            const news = allNews.find(n => n.id === newsId);
            if (!news) {
                showNotification('èµ„è®¯ä¸å­˜åœ¨', 'danger');
                return;
            }
            showNewsModal('æŸ¥çœ‹èµ„è®¯', news, true);
        }

        function copyNews(newsId) {
            const news = allNews.find(n => n.id === newsId);
            if (!news) {
                showNotification('èµ„è®¯ä¸å­˜åœ¨', 'danger');
                return;
            }

            const newNews = {
                ...news,
                id: 'news-' + Date.now(),
                title: news.title + ' (å‰¯æœ¬)',
                status: 'è‰ç¨¿',
                publishDate: new Date().toISOString().split('T')[0],
                views: 0
            };

            allNews.unshift(newNews);
            filteredNews = [...allNews];
            renderNewsList();
            showNotification('èµ„è®¯å¤åˆ¶æˆåŠŸ', 'success');
        }

        async function deleteNews(newsId) {
            const news = allNews.find(n => n.id === newsId);
            if (!news) {
                showNotification('èµ„è®¯ä¸å­˜åœ¨', 'danger');
                return;
            }

            if (confirm(`ç¡®å®šè¦åˆ é™¤èµ„è®¯ "${news.title}" å—ï¼Ÿæ­¤æ“ä½œä¸å¯æ¢å¤ã€‚`)) {
                try {
                    // ä»æ•°ç»„ä¸­åˆ é™¤
                    allNews = allNews.filter(n => n.id !== newsId);
                    filteredNews = filteredNews.filter(n => n.id !== newsId);

                    renderNewsList();
                    showNotification('èµ„è®¯åˆ é™¤æˆåŠŸ', 'success');
                } catch (error) {
                    console.error('åˆ é™¤èµ„è®¯å¤±è´¥:', error);
                    showNotification('åˆ é™¤èµ„è®¯å¤±è´¥: ' + error.message, 'danger');
                }
            }
        }

        function refreshNewsList() {
            showNewsList();
        }

        function exportNews() {
            try {
                const dataStr = JSON.stringify(allNews, null, 2);
                const dataBlob = new Blob([dataStr], {type: 'application/json'});
                const url = URL.createObjectURL(dataBlob);
                const link = document.createElement('a');
                link.href = url;
                link.download = `news_export_${new Date().toISOString().split('T')[0]}.json`;
                link.click();
                URL.revokeObjectURL(url);
                showNotification('èµ„è®¯æ•°æ®å¯¼å‡ºæˆåŠŸ', 'success');
            } catch (error) {
                showNotification('å¯¼å‡ºå¤±è´¥: ' + error.message, 'danger');
            }
        }

        // ç”Ÿæˆèµ„è®¯Hugoæ–‡ä»¶
        function generateNewsHugoFiles() {
            if (allNews.length === 0) {
                showNotification('æ²¡æœ‰èµ„è®¯æ•°æ®å¯ä»¥ç”Ÿæˆ', 'warning');
                return;
            }

            const confirmMsg = `ç¡®å®šè¦ä¸ºå½“å‰ ${allNews.length} æ¡èµ„è®¯ç”ŸæˆHugo markdownæ–‡ä»¶å—ï¼Ÿ\n\nç”Ÿæˆçš„æ–‡ä»¶éœ€è¦æ‰‹åŠ¨æ”¾å…¥ content/news/ ç›®å½•ä¸­ã€‚`;

            if (!confirm(confirmMsg)) {
                return;
            }

            try {
                // æ˜¾ç¤ºè¿›åº¦æç¤º
                showNotification('æ­£åœ¨ç”Ÿæˆèµ„è®¯Hugoæ–‡ä»¶ï¼Œè¯·ç¨å€™...', 'info');

                // ä¸ºæ¯æ¡èµ„è®¯ç”Ÿæˆmarkdownæ–‡ä»¶
                allNews.forEach((newsItem, index) => {
                    setTimeout(() => {
                        const content = window.ContentAPI.generateNewsMarkdown(newsItem);
                        window.ContentAPI.downloadNewsMarkdownFile(newsItem, content);

                        // æœ€åä¸€ä¸ªæ–‡ä»¶ä¸‹è½½å®Œæˆåæ˜¾ç¤ºæˆåŠŸæ¶ˆæ¯
                        if (index === allNews.length - 1) {
                            setTimeout(() => {
                                showNotification(`æˆåŠŸç”Ÿæˆ ${allNews.length} æ¡èµ„è®¯Hugoæ–‡ä»¶ï¼è¯·å°†ä¸‹è½½çš„.mdæ–‡ä»¶æ”¾å…¥ content/news/ ç›®å½•`, 'success');
                            }, 500);
                        }
                    }, index * 300); // æ¯300msä¸‹è½½ä¸€ä¸ªæ–‡ä»¶ï¼Œé¿å…æµè§ˆå™¨é˜»æ­¢å¤šä¸ªä¸‹è½½
                });

            } catch (error) {
                showNotification('ç”Ÿæˆèµ„è®¯Hugoæ–‡ä»¶å¤±è´¥: ' + error.message, 'danger');
            }
        }

        function importNews() {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = '.json';
            input.onchange = function(e) {
                const file = e.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        try {
                            const importedNews = JSON.parse(e.target.result);
                            if (Array.isArray(importedNews)) {
                                allNews = [...allNews, ...importedNews];
                                filteredNews = [...allNews];
                                renderNewsList();
                                showNotification(`æˆåŠŸå¯¼å…¥ ${importedNews.length} æ¡èµ„è®¯`, 'success');
                            } else {
                                showNotification('å¯¼å…¥æ–‡ä»¶æ ¼å¼é”™è¯¯', 'danger');
                            }
                        } catch (error) {
                            showNotification('å¯¼å…¥å¤±è´¥: ' + error.message, 'danger');
                        }
                    };
                    reader.readAsText(file);
                }
            };
            input.click();
        }

        // èµ„è®¯æ¨¡æ€æ¡†åŠŸèƒ½
        let newsContentEditor = null;

        function showNewsModal(title, news = null, readonly = false) {
            document.getElementById('newsModalLabel').textContent = title;

            // åˆå§‹åŒ–å¯Œæ–‡æœ¬ç¼–è¾‘å™¨ï¼ˆå¦‚æœè¿˜æ²¡æœ‰åˆå§‹åŒ–ï¼‰
            if (!newsContentEditor) {
                newsContentEditor = new Quill('#newsContentEditor', {
                    theme: 'snow',
                    modules: {
                        toolbar: [
                            ['bold', 'italic', 'underline'],
                            ['link', 'image'],
                            [{ 'list': 'ordered'}, { 'list': 'bullet' }],
                            [{ 'header': [1, 2, 3, false] }],
                            ['clean']
                        ]
                    },
                    readOnly: readonly
                });
            } else {
                newsContentEditor.enable(!readonly);
            }

            if (news) {
                // å¡«å……è¡¨å•æ•°æ®
                document.getElementById('newsTitle').value = news.title || '';
                document.getElementById('newsSummary').value = news.summary || '';
                document.getElementById('newsCategory').value = news.category || '';
                document.getElementById('newsAuthor').value = news.author || '';
                document.getElementById('newsPublishDate').value = news.publishDate || '';
                document.getElementById('newsStatus').value = news.status || 'è‰ç¨¿';
                document.getElementById('newsFeatured').checked = news.featured || false;
                document.getElementById('newsImage').value = news.image || '';
                document.getElementById('newsTags').value = news.tags ? news.tags.join(', ') : '';

                // è®¾ç½®å¯Œæ–‡æœ¬ç¼–è¾‘å™¨å†…å®¹
                newsContentEditor.root.innerHTML = news.content || '';

                // æ˜¾ç¤ºå›¾ç‰‡é¢„è§ˆ
                if (news.image) {
                    const preview = document.getElementById('newsImagePreview');
                    preview.src = news.image;
                    preview.style.display = 'block';
                }
            } else {
                // é‡ç½®è¡¨å•
                document.getElementById('newsForm').reset();
                document.getElementById('newsPublishDate').value = new Date().toISOString().split('T')[0];
                newsContentEditor.root.innerHTML = '';
                document.getElementById('newsImagePreview').style.display = 'none';
            }

            // è®¾ç½®è¡¨å•åªè¯»çŠ¶æ€
            const formElements = document.querySelectorAll('#newsForm input, #newsForm select, #newsForm textarea');
            formElements.forEach(element => {
                element.disabled = readonly;
            });

            // æ˜¾ç¤º/éšè—ä¿å­˜æŒ‰é’®
            const saveButton = document.querySelector('#newsModal .btn-primary');
            saveButton.style.display = readonly ? 'none' : 'inline-block';

            const modal = new bootstrap.Modal(document.getElementById('newsModal'));
            modal.show();
        }

        async function saveNews() {
            // æ˜¾ç¤ºä¿å­˜ä¸­çŠ¶æ€
            const saveBtn = document.querySelector('button[onclick="saveNews()"]');
            const originalText = saveBtn.innerHTML;
            saveBtn.innerHTML = '<i class="fas fa-spinner fa-spin me-1"></i>ä¿å­˜ä¸­...';
            saveBtn.disabled = true;

            try {
                const title = document.getElementById('newsTitle').value.trim();
                const summary = document.getElementById('newsSummary').value.trim();
                const content = newsContentEditor.root.innerHTML;
                const category = document.getElementById('newsCategory').value;
                const author = document.getElementById('newsAuthor').value.trim();
                const publishDate = document.getElementById('newsPublishDate').value;
                const status = document.getElementById('newsStatus').value;
                const featured = document.getElementById('newsFeatured').checked;
                const image = document.getElementById('newsImage').value.trim();
                const tagsText = document.getElementById('newsTags').value.trim();

                // éªŒè¯å¿…å¡«å­—æ®µ
                if (!title || !summary || !content || !category) {
                    showNotification('è¯·å¡«å†™æ‰€æœ‰å¿…å¡«å­—æ®µ', 'warning');
                    return;
                }

                // å¤„ç†æ ‡ç­¾
                const tags = tagsText ? tagsText.split(',').map(tag => tag.trim()).filter(tag => tag) : [];

                const newsData = {
                    id: editingNews ? editingNews.id : null,
                    title,
                    summary,
                    content,
                    categories: [category],
                    author: author || 'ç¼–è¾‘éƒ¨',
                    publishDate: publishDate || new Date().toISOString().split('T')[0],
                    status,
                    featured,
                    featured_image: image || `/images/news/default-news.jpg`,
                    tags,
                    views: editingNews ? editingNews.views : 0
                };

                // ä¿å­˜åˆ°æ–‡ä»¶ç³»ç»Ÿ
                const result = await window.ContentAPI.saveNews(newsData);

                if (result.success) {
                    // æ›´æ–°å†…å­˜ä¸­çš„æ•°æ®
                    if (editingNews) {
                        const index = allNews.findIndex(n => n.id === editingNews.id);
                        if (index !== -1) {
                            allNews[index] = { ...allNews[index], ...newsData };
                        }
                        showNotification(result.message || 'èµ„è®¯æ›´æ–°æˆåŠŸï¼Œå·²ç”ŸæˆHugoæ–‡ä»¶', 'success');
                    } else {
                        allNews.unshift({ ...newsData, id: result.data.id });
                        showNotification(result.message || 'èµ„è®¯æ·»åŠ æˆåŠŸï¼Œå·²ç”ŸæˆHugoæ–‡ä»¶', 'success');
                    }

                    // æ›´æ–°è¿‡æ»¤åçš„æ•°æ®å¹¶é‡æ–°æ¸²æŸ“
                    filteredNews = [...allNews];
                    renderNewsList();

                    // å…³é—­æ¨¡æ€æ¡†
                    const modal = bootstrap.Modal.getInstance(document.getElementById('newsModal'));
                    modal.hide();
                } else {
                    showNotification(result.message || 'èµ„è®¯ä¿å­˜å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œè¿æ¥', 'danger');
                }

            } catch (error) {
                console.error('ä¿å­˜èµ„è®¯å¤±è´¥:', error);
                showNotification('ä¿å­˜èµ„è®¯å¤±è´¥: ' + error.message, 'danger');
            } finally {
                // æ¢å¤æŒ‰é’®çŠ¶æ€
                saveBtn.innerHTML = originalText;
                saveBtn.disabled = false;
            }
        }

        // å›¾ç‰‡é¢„è§ˆåŠŸèƒ½
        document.addEventListener('DOMContentLoaded', function() {
            // èµ„è®¯å›¾ç‰‡é¢„è§ˆ
            const newsImageInput = document.getElementById('newsImage');
            if (newsImageInput) {
                newsImageInput.addEventListener('input', function() {
                    const url = this.value.trim();
                    const preview = document.getElementById('newsImagePreview');
                    if (url) {
                        preview.src = url;
                        preview.style.display = 'block';
                        preview.onerror = function() {
                            this.style.display = 'none';
                        };
                    } else {
                        preview.style.display = 'none';
                    }
                });
            }

            // æ¡ˆä¾‹å›¾ç‰‡é¢„è§ˆ
            const caseImageInput = document.getElementById('caseFeaturedImage');
            if (caseImageInput) {
                caseImageInput.addEventListener('input', function() {
                    const url = this.value.trim();
                    const preview = document.getElementById('caseImagePreview');
                    if (url && preview) {
                        const img = preview.querySelector('img');
                        if (img) {
                            img.src = url;
                            img.onload = () => preview.style.display = 'block';
                            img.onerror = () => preview.style.display = 'none';
                        }
                    } else if (preview) {
                        preview.style.display = 'none';
                    }
                });
            }
        });

        // å ä½ç¬¦å‡½æ•°
        function addCategory() { showNotification('æ·»åŠ åˆ†ç±»åŠŸèƒ½æ­£åœ¨å¼€å‘ä¸­', 'info'); }
        function editCategory(id) { showNotification('ç¼–è¾‘åˆ†ç±»åŠŸèƒ½æ­£åœ¨å¼€å‘ä¸­', 'info'); }
        function deleteCategory(id) { showNotification('åˆ é™¤åˆ†ç±»åŠŸèƒ½æ­£åœ¨å¼€å‘ä¸­', 'info'); }

        // ä¾›åº”å•†ç®¡ç†åŠŸèƒ½
        let editingSupplier = null;

        function addSupplier() {
            editingSupplier = null;
            showSupplierModal('æ·»åŠ ä¾›åº”å•†');
        }

        function editSupplier(id) {
            const supplier = suppliers.find(s => s.id === id);
            if (!supplier) {
                showNotification('ä¾›åº”å•†ä¸å­˜åœ¨', 'danger');
                return;
            }
            editingSupplier = supplier;
            showSupplierModal('ç¼–è¾‘ä¾›åº”å•†');
        }

        function deleteSupplier(id) {
            if (confirm('ç¡®å®šè¦åˆ é™¤è¿™ä¸ªä¾›åº”å•†å—ï¼Ÿåˆ é™¤åç›¸å…³äº§å“çš„ä¾›åº”å•†ä¿¡æ¯å°†è¢«æ¸…ç©ºã€‚')) {
                const index = suppliers.findIndex(s => s.id === id);
                if (index !== -1) {
                    const supplier = suppliers[index];
                    suppliers.splice(index, 1);

                    // æ›´æ–°ç›¸å…³äº§å“çš„ä¾›åº”å•†ä¿¡æ¯
                    currentData.forEach(product => {
                        if (product.supplier === supplier.title) {
                            product.supplier = '';
                        }
                    });

                    // åˆ é™¤æœ¬åœ°æ–‡ä»¶
                    deleteSupplierFile(supplier);

                    // æ›´æ–°æ˜¾ç¤º
                    updateSupplierOptions();
                    showSuppliers();
                    showNotification('ä¾›åº”å•†åˆ é™¤æˆåŠŸ', 'success');
                    addOperationHistory('åˆ é™¤', 'supplier', 'æˆåŠŸ', `åˆ é™¤ä¾›åº”å•†: ${supplier.title}`);
                }
            }
        }

        // æ˜¾ç¤ºä¾›åº”å•†æ¨¡æ€æ¡†
        function showSupplierModal(title) {
            const modalHtml = `
                <div class="modal fade" id="supplierModal" tabindex="-1">
                    <div class="modal-dialog modal-lg">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h5 class="modal-title">${title}</h5>
                                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                            </div>
                            <div class="modal-body">
                                <form id="supplierForm">
                                    <div class="row">
                                        <div class="col-md-6">
                                            <h6 class="text-primary mb-3">åŸºæœ¬ä¿¡æ¯</h6>
                                            <div class="mb-3">
                                                <label for="supplierTitle" class="form-label">ä¼ä¸šåç§° *</label>
                                                <input type="text" class="form-control" id="supplierTitle" required>
                                            </div>
                                            <div class="mb-3">
                                                <label for="supplierAddress" class="form-label">ä¼ä¸šåœ°å€</label>
                                                <input type="text" class="form-control" id="supplierAddress">
                                            </div>
                                            <div class="mb-3">
                                                <label for="supplierType" class="form-label">ä¼ä¸šç±»å‹</label>
                                                <select class="form-select" id="supplierType">
                                                    <option value="">è¯·é€‰æ‹©ä¼ä¸šç±»å‹</option>
                                                    <option value="åˆ¶é€ å•†">åˆ¶é€ å•†</option>
                                                    <option value="ä»£ç†å•†">ä»£ç†å•†</option>
                                                    <option value="ç»é”€å•†">ç»é”€å•†</option>
                                                    <option value="æœåŠ¡å•†">æœåŠ¡å•†</option>
                                                </select>
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <h6 class="text-primary mb-3">è”ç³»æ–¹å¼</h6>
                                            <div class="mb-3">
                                                <label for="supplierContactPerson" class="form-label">è”ç³»äºº</label>
                                                <input type="text" class="form-control" id="supplierContactPerson">
                                            </div>
                                            <div class="mb-3">
                                                <label for="supplierPosition" class="form-label">èŒåŠ¡</label>
                                                <input type="text" class="form-control" id="supplierPosition">
                                            </div>
                                            <div class="mb-3">
                                                <label for="supplierPhone" class="form-label">ç”µè¯</label>
                                                <input type="tel" class="form-control" id="supplierPhone">
                                            </div>
                                            <div class="mb-3">
                                                <label for="supplierEmail" class="form-label">é‚®ç®±</label>
                                                <input type="email" class="form-control" id="supplierEmail">
                                            </div>
                                        </div>
                                    </div>

                                    <div class="row">
                                        <div class="col-12">
                                            <h6 class="text-primary mb-3">äº§å“ä¿¡æ¯</h6>
                                            <div class="mb-3">
                                                <label for="supplierSeries" class="form-label">äº§å“ç³»åˆ—</label>
                                                <div class="input-group">
                                                    <input type="text" class="form-control" id="supplierSeriesInput" placeholder="è¾“å…¥äº§å“ç³»åˆ—åç§°">
                                                    <button type="button" class="btn btn-outline-secondary" onclick="addSupplierSeries()">
                                                        <i class="fas fa-plus"></i>
                                                    </button>
                                                </div>
                                                <div class="form-text">æŒ‰å›è½¦æˆ–ç‚¹å‡»+å·æ·»åŠ äº§å“ç³»åˆ—</div>
                                                <div id="supplierSeriesList" class="mt-2"></div>
                                            </div>
                                            <div class="mb-3">
                                                <label for="supplierModels" class="form-label">äº§å“å‹å·</label>
                                                <div class="input-group">
                                                    <input type="text" class="form-control" id="supplierModelsInput" placeholder="è¾“å…¥äº§å“å‹å·">
                                                    <button type="button" class="btn btn-outline-secondary" onclick="addSupplierModel()">
                                                        <i class="fas fa-plus"></i>
                                                    </button>
                                                </div>
                                                <div class="form-text">æŒ‰å›è½¦æˆ–ç‚¹å‡»+å·æ·»åŠ äº§å“å‹å·</div>
                                                <div id="supplierModelsList" class="mt-2"></div>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="row">
                                        <div class="col-12">
                                            <h6 class="text-primary mb-3">ä¼ä¸šç›¸å†Œ</h6>
                                            <div class="mb-3">
                                                <label for="supplierGallery" class="form-label">ç›¸å†Œå›¾ç‰‡</label>
                                                <div class="d-flex gap-2 mb-3">
                                                    <button type="button" class="btn btn-outline-primary btn-sm" onclick="uploadSupplierImage()">
                                                        <i class="fas fa-upload me-1"></i>ä¸Šä¼ å›¾ç‰‡
                                                    </button>
                                                    <button type="button" class="btn btn-outline-success btn-sm" onclick="selectSupplierImageFromLibrary()">
                                                        <i class="fas fa-folder-open me-1"></i>ä»åª’ä½“åº“é€‰æ‹©
                                                    </button>
                                                </div>
                                                <div id="supplierGalleryContainer" class="row">
                                                    <div class="col-md-4 mb-3">
                                                        <div class="supplier-image-upload-area" onclick="uploadSupplierImage()">
                                                            <div class="upload-placeholder">
                                                                <i class="fas fa-plus fa-2x mb-2"></i>
                                                                <p>æ·»åŠ å›¾ç‰‡</p>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="row">
                                        <div class="col-12">
                                            <h6 class="text-primary mb-3">å…¬å¸ç®€ä»‹</h6>
                                            <div class="mb-3">
                                                <label for="supplierDescription" class="form-label">å…¬å¸ç®€ä»‹</label>
                                                <textarea class="form-control" id="supplierDescription" rows="4" placeholder="è¯·è¾“å…¥å…¬å¸ç®€ä»‹..."></textarea>
                                            </div>
                                        </div>
                                    </div>
                                </form>
                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">å–æ¶ˆ</button>
                                <button type="button" class="btn btn-primary" onclick="saveSupplier()">ä¿å­˜</button>
                            </div>
                        </div>
                    </div>
                </div>
            `;

            // ç§»é™¤å·²å­˜åœ¨çš„æ¨¡æ€æ¡†
            const existingModal = document.getElementById('supplierModal');
            if (existingModal) {
                existingModal.remove();
            }

            // æ·»åŠ æ–°æ¨¡æ€æ¡†
            document.body.insertAdjacentHTML('beforeend', modalHtml);

            // å¦‚æœæ˜¯ç¼–è¾‘æ¨¡å¼ï¼Œå¡«å……æ•°æ®
            if (editingSupplier) {
                fillSupplierForm(editingSupplier);
            }

            // ç»‘å®šå›è½¦äº‹ä»¶
            document.getElementById('supplierSeriesInput').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    e.preventDefault();
                    addSupplierSeries();
                }
            });

            document.getElementById('supplierModelsInput').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    e.preventDefault();
                    addSupplierModel();
                }
            });

            // åˆå§‹åŒ–ä¾›åº”å•†å›¾åº“
            initializeSupplierGallery();

            // æ˜¾ç¤ºæ¨¡æ€æ¡†
            const modal = new bootstrap.Modal(document.getElementById('supplierModal'));
            modal.show();
        }

        // ä¾›åº”å•†è¡¨å•å¤„ç†å‡½æ•°
        let supplierSeries = [];
        let supplierModels = [];
        let supplierGallery = [];

        function addSupplierSeries() {
            const input = document.getElementById('supplierSeriesInput');
            const value = input.value.trim();
            if (value && !supplierSeries.includes(value)) {
                supplierSeries.push(value);
                input.value = '';
                updateSupplierSeriesList();
            }
        }

        function removeSupplierSeries(index) {
            supplierSeries.splice(index, 1);
            updateSupplierSeriesList();
        }

        function updateSupplierSeriesList() {
            const container = document.getElementById('supplierSeriesList');
            container.innerHTML = supplierSeries.map((series, index) => `
                <span class="badge bg-primary me-2 mb-2">
                    ${series}
                    <button type="button" class="btn-close btn-close-white ms-1" onclick="removeSupplierSeries(${index})" style="font-size: 0.7em;"></button>
                </span>
            `).join('');
        }

        function addSupplierModel() {
            const input = document.getElementById('supplierModelsInput');
            const value = input.value.trim();
            if (value && !supplierModels.includes(value)) {
                supplierModels.push(value);
                input.value = '';
                updateSupplierModelsList();
            }
        }

        function removeSupplierModel(index) {
            supplierModels.splice(index, 1);
            updateSupplierModelsList();
        }

        function updateSupplierModelsList() {
            const container = document.getElementById('supplierModelsList');
            container.innerHTML = supplierModels.map((model, index) => `
                <span class="badge bg-secondary me-2 mb-2">
                    ${model}
                    <button type="button" class="btn-close btn-close-white ms-1" onclick="removeSupplierModel(${index})" style="font-size: 0.7em;"></button>
                </span>
            `).join('');
        }

        // ä¾›åº”å•†å›¾åº“ç®¡ç†åŠŸèƒ½
        function initializeSupplierGallery() {
            supplierGallery = [];
            updateSupplierGalleryDisplay();
        }

        function uploadSupplierImage() {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = 'image/*';
            input.multiple = true;
            input.onchange = function(e) {
                const files = Array.from(e.target.files);
                files.forEach(file => {
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        addSupplierImageToGallery(e.target.result, file.name, true);
                    };
                    reader.readAsDataURL(file);
                });
            };
            input.click();
        }

        function selectSupplierImageFromLibrary() {
            selectFromMediaLibrary((selectedFiles) => {
                selectedFiles.forEach(file => {
                    if (file.type === 'image') {
                        addSupplierImageToGallery(file.path, file.name, false);
                    }
                });
            });
        }

        function addSupplierImageToGallery(src, alt, isNewUpload = false) {
            const container = document.getElementById('supplierGalleryContainer');
            const addButton = container.querySelector('.supplier-image-upload-area').parentElement;

            const col = document.createElement('div');
            col.className = 'col-md-4 mb-3';
            col.innerHTML = `
                <div class="supplier-image-item">
                    <img src="${src}" alt="${alt}" class="img-fluid">
                    <div class="image-controls">
                        <button type="button" class="btn btn-sm btn-outline-danger" onclick="removeSupplierImage(this)" title="åˆ é™¤">
                            <i class="fas fa-trash"></i>
                        </button>
                    </div>
                    <div class="image-info mt-2">
                        <input type="text" class="form-control form-control-sm" value="${alt}" placeholder="å›¾ç‰‡æè¿°">
                        <input type="hidden" value="${src}" class="supplier-image-path">
                        <input type="hidden" value="${isNewUpload}" class="supplier-image-new">
                    </div>
                </div>
            `;

            container.insertBefore(col, addButton);
        }

        function removeSupplierImage(button) {
            const col = button.closest('.col-md-4');
            col.remove();
        }

        function updateSupplierGalleryDisplay() {
            const container = document.getElementById('supplierGalleryContainer');
            // æ¸…é™¤é™¤äº†æ·»åŠ æŒ‰é’®ä¹‹å¤–çš„æ‰€æœ‰å›¾ç‰‡
            const addButton = container.querySelector('.supplier-image-upload-area').parentElement;
            container.innerHTML = '';
            container.appendChild(addButton);

            // é‡æ–°æ·»åŠ å›¾ç‰‡
            supplierGallery.forEach(imagePath => {
                addSupplierImageToGallery(imagePath, 'ä¾›åº”å•†å›¾ç‰‡', false);
            });
        }

        function getSupplierGalleryData() {
            const imageItems = document.querySelectorAll('.supplier-image-item');
            const gallery = [];

            imageItems.forEach(item => {
                const pathInput = item.querySelector('.supplier-image-path');
                if (pathInput) {
                    gallery.push(pathInput.value);
                }
            });

            return gallery;
        }

        function fillSupplierForm(supplier) {
            document.getElementById('supplierTitle').value = supplier.title || '';
            document.getElementById('supplierAddress').value = supplier.address || '';
            document.getElementById('supplierType').value = supplier.type || '';
            document.getElementById('supplierContactPerson').value = supplier.contact_person || '';
            document.getElementById('supplierPosition').value = supplier.position || '';
            document.getElementById('supplierPhone').value = supplier.phone || '';
            document.getElementById('supplierEmail').value = supplier.email || '';
            document.getElementById('supplierDescription').value = supplier.description || '';

            // å¡«å……æ•°ç»„æ•°æ®
            supplierSeries = [...(supplier.series || [])];
            supplierModels = [...(supplier.models || [])];
            supplierGallery = [...(supplier.gallery || [])];

            // æ›´æ–°æ˜¾ç¤º
            updateSupplierSeriesList();
            updateSupplierModelsList();
            updateSupplierGalleryDisplay();
        }

        function saveSupplier() {
            const form = document.getElementById('supplierForm');
            if (!form.checkValidity()) {
                form.reportValidity();
                return;
            }

            const supplierData = {
                id: editingSupplier ? editingSupplier.id : generateSupplierId(),
                title: document.getElementById('supplierTitle').value.trim(),
                address: document.getElementById('supplierAddress').value.trim(),
                type: document.getElementById('supplierType').value,
                contact_person: document.getElementById('supplierContactPerson').value.trim(),
                position: document.getElementById('supplierPosition').value.trim(),
                phone: document.getElementById('supplierPhone').value.trim(),
                email: document.getElementById('supplierEmail').value.trim(),
                description: document.getElementById('supplierDescription').value.trim(),
                series: [...supplierSeries],
                models: [...supplierModels],
                gallery: getSupplierGalleryData()
            };

            if (editingSupplier) {
                // æ›´æ–°ç°æœ‰ä¾›åº”å•†
                const index = suppliers.findIndex(s => s.id === editingSupplier.id);
                if (index !== -1) {
                    suppliers[index] = supplierData;
                }
            } else {
                // æ·»åŠ æ–°ä¾›åº”å•†
                suppliers.push(supplierData);
            }

            // ä¿å­˜åˆ°æœ¬åœ°æ–‡ä»¶
            saveSupplierToFile(supplierData);

            // æ›´æ–°ä¸‹æ‹‰é€‰é¡¹
            updateSupplierOptions();

            // åˆ·æ–°æ˜¾ç¤º
            showSuppliers();

            // å…³é—­æ¨¡æ€æ¡†
            const modal = bootstrap.Modal.getInstance(document.getElementById('supplierModal'));
            modal.hide();

            // æ¸…ç©ºè¡¨å•æ•°æ®
            supplierSeries = [];
            supplierModels = [];
            supplierGallery = [];

            showNotification(editingSupplier ? 'ä¾›åº”å•†æ›´æ–°æˆåŠŸ' : 'ä¾›åº”å•†æ·»åŠ æˆåŠŸ', 'success');
            addOperationHistory(editingSupplier ? 'ç¼–è¾‘' : 'æ·»åŠ ', 'supplier', 'æˆåŠŸ', `${editingSupplier ? 'ç¼–è¾‘' : 'æ·»åŠ '}ä¾›åº”å•†: ${supplierData.title}`);
        }

        function generateSupplierId() {
            const timestamp = Date.now();
            const random = Math.random().toString(36).substr(2, 5);
            return `supplier-${timestamp}-${random}`;
        }

        // ä¿å­˜ä¾›åº”å•†åˆ°æœ¬åœ°æ–‡ä»¶
        function saveSupplierToFile(supplierData) {
            try {
                // å¤„ç†ä¾›åº”å•†æ–‡ä»¶
                const processedData = processSupplierFiles(supplierData);

                // ç”Ÿæˆæ–‡ä»¶åï¼ˆåŸºäºä¼ä¸šåç§°ï¼‰
                const filename = generateSupplierFilename(processedData.title);

                // ç”ŸæˆHugo Markdownå†…å®¹
                const markdownContent = generateSupplierMarkdown(processedData);

                // åˆ›å»ºä¸‹è½½é“¾æ¥
                const blob = new Blob([markdownContent], { type: 'text/markdown' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = filename;
                a.style.display = 'none';
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);

                showNotification(`ä¾›åº”å•†æ–‡ä»¶å·²ç”Ÿæˆ: ${filename}ï¼Œè¯·ä¿å­˜åˆ° content/suppliers/ ç›®å½•`, 'info');

                // æ˜¾ç¤ºæ–‡ä»¶ä¿å­˜æŒ‡å¯¼
                showSupplierSaveInstructions(filename, processedData);

            } catch (error) {
                console.error('ä¿å­˜ä¾›åº”å•†æ–‡ä»¶å¤±è´¥:', error);
                showNotification('ä¿å­˜ä¾›åº”å•†æ–‡ä»¶å¤±è´¥: ' + error.message, 'danger');
            }
        }

        // å¤„ç†ä¾›åº”å•†æ–‡ä»¶
        function processSupplierFiles(supplierData) {
            const processedData = { ...supplierData };

            // å¤„ç†å›¾åº“ä¸­çš„æ–°ä¸Šä¼ æ–‡ä»¶
            if (processedData.gallery) {
                processedData.gallery = processedData.gallery.map((imagePath, index) => {
                    if (imagePath.startsWith('data:')) {
                        // è¿™æ˜¯ä¸€ä¸ªæ–°ä¸Šä¼ çš„base64å›¾ç‰‡ï¼Œéœ€è¦ä¿å­˜åˆ°æŒ‡å®šç›®å½•
                        const fileName = `${generateSupplierFilename(supplierData.title).replace('.md', '')}-${index + 1}.jpg`;
                        const targetPath = `/images/suppliers/${fileName}`;

                        console.log(`ä¾›åº”å•†å›¾ç‰‡å°†ä¿å­˜åˆ°: ${targetPath}`);
                        return targetPath;
                    }
                    return imagePath;
                });
            }

            return processedData;
        }

        // æ˜¾ç¤ºä¾›åº”å•†æ–‡ä»¶ä¿å­˜æŒ‡å¯¼
        function showSupplierSaveInstructions(filename, supplierData) {
            const instructions = [];
            instructions.push(`1. å°†ä¸‹è½½çš„ ${filename} æ–‡ä»¶ä¿å­˜åˆ°é¡¹ç›®çš„ content/suppliers/ ç›®å½•`);

            if (supplierData.gallery && supplierData.gallery.length > 0) {
                instructions.push(`2. ä¿å­˜ä¾›åº”å•†å›¾ç‰‡åˆ°ä»¥ä¸‹ä½ç½®:`);
                supplierData.gallery.forEach((imagePath, index) => {
                    if (imagePath.startsWith('/images/suppliers/')) {
                        instructions.push(`   - ${imagePath}`);
                    }
                });
            }

            instructions.push(`3. ç¡®ä¿æ‰€æœ‰å›¾ç‰‡æ–‡ä»¶éƒ½å·²æ­£ç¡®ä¿å­˜åˆ° static/images/suppliers/ ç›®å½•`);

            showFileInstructions('ä¾›åº”å•†æ–‡ä»¶ä¿å­˜æŒ‡å¯¼', instructions);
        }

        function generateSupplierFilename(title) {
            // å°†ä¸­æ–‡ä¼ä¸šåç§°è½¬æ¢ä¸ºé€‚åˆæ–‡ä»¶åçš„æ ¼å¼
            const pinyin = title
                .replace(/æ·±åœ³å¸‚å¾®è§†å…‰ç”µç§‘æŠ€æœ‰é™å…¬å¸/g, 'vsndt-supplier')
                .replace(/å¤©æ´¥ç»´æ£®ç§‘æŠ€æœ‰é™å…¬å¸/g, 'vis-supplier')
                .replace(/åŒ—äº¬/g, 'beijing')
                .replace(/ä¸Šæµ·/g, 'shanghai')
                .replace(/å¹¿å·/g, 'guangzhou')
                .replace(/æ·±åœ³/g, 'shenzhen')
                .replace(/å¤©æ´¥/g, 'tianjin')
                .replace(/æœ‰é™å…¬å¸/g, 'company')
                .replace(/ç§‘æŠ€/g, 'tech')
                .replace(/ç”µå­/g, 'electronic')
                .replace(/å…‰ç”µ/g, 'optoelectronic')
                .replace(/[^\w\-]/g, '-')
                .toLowerCase()
                .replace(/-+/g, '-')
                .replace(/^-|-$/g, '');

            return `${pinyin || 'supplier'}.md`;
        }

        function generateSupplierMarkdown(supplierData) {
            // ç”ŸæˆYAMLå‰ç½®æ•°æ®ï¼Œå®Œå…¨ç¬¦åˆvsndt-supplier.mdæ ¼å¼
            let yaml = '---\n';
            yaml += `title: "${supplierData.title}"\n`;
            yaml += `address: "${supplierData.address || ''}"\n`;
            yaml += `type: "${supplierData.type || ''}"\n`;

            // äº§å“ç³»åˆ—
            if (supplierData.series && supplierData.series.length > 0) {
                yaml += 'series:\n';
                supplierData.series.forEach(series => {
                    yaml += `  - "${series}"\n`;
                });
            } else {
                yaml += 'series: []\n';
            }

            // äº§å“å‹å·
            if (supplierData.models && supplierData.models.length > 0) {
                yaml += 'models:\n';
                supplierData.models.forEach(model => {
                    yaml += `  - "${model}"\n`;
                });
            } else {
                yaml += 'models: []\n';
            }

            // ä¼ä¸šç›¸å†Œ
            if (supplierData.gallery && supplierData.gallery.length > 0) {
                yaml += 'gallery:\n';
                supplierData.gallery.forEach(image => {
                    yaml += `  - "${image}"\n`;
                });
            } else {
                yaml += 'gallery: []\n';
            }

            yaml += `contact_person: "${supplierData.contact_person || ''}"\n`;
            yaml += `position: "${supplierData.position || ''}"\n`;
            yaml += `phone: "${supplierData.phone || ''}"\n`;
            yaml += `email: "${supplierData.email || ''}"\n`;
            yaml += `description: "${supplierData.description || ''}"\n`;
            yaml += '---\n\n';

            // æ·»åŠ ä¼ä¸šç®€ä»‹å†…å®¹
            if (supplierData.description) {
                yaml += `## ä¼ä¸šç®€ä»‹\n\n${supplierData.description}\n\n`;
            }

            // æ·»åŠ è”ç³»ä¿¡æ¯
            yaml += `## è”ç³»ä¿¡æ¯\n\n`;
            yaml += `**è”ç³»äººï¼š** ${supplierData.contact_person || 'å¾…è¡¥å……'}\n\n`;
            yaml += `**èŒä½ï¼š** ${supplierData.position || 'å¾…è¡¥å……'}\n\n`;
            yaml += `**ç”µè¯ï¼š** ${supplierData.phone || 'å¾…è¡¥å……'}\n\n`;
            yaml += `**é‚®ç®±ï¼š** ${supplierData.email || 'å¾…è¡¥å……'}\n\n`;
            yaml += `**åœ°å€ï¼š** ${supplierData.address || 'å¾…è¡¥å……'}\n\n`;

            // æ·»åŠ äº§å“ä¿¡æ¯
            if (supplierData.series && supplierData.series.length > 0) {
                yaml += `## äº§å“ç³»åˆ—\n\n`;
                supplierData.series.forEach(series => {
                    yaml += `- ${series}\n`;
                });
                yaml += '\n';
            }

            if (supplierData.models && supplierData.models.length > 0) {
                yaml += `## ä¸»è¦äº§å“å‹å·\n\n`;
                supplierData.models.forEach(model => {
                    yaml += `- ${model}\n`;
                });
                yaml += '\n';
            }

            return yaml;
        }

        function deleteSupplierFile(supplier) {
            // ç”±äºæµè§ˆå™¨é™åˆ¶ï¼Œæ— æ³•ç›´æ¥åˆ é™¤æœ¬åœ°æ–‡ä»¶
            // è¿™é‡Œåªæ˜¯æç¤ºç”¨æˆ·æ‰‹åŠ¨åˆ é™¤
            const filename = generateSupplierFilename(supplier.title);
            showNotification(`è¯·æ‰‹åŠ¨åˆ é™¤ä¾›åº”å•†æ–‡ä»¶: content/suppliers/${filename}`, 'warning');
        }

        // æ¡ˆä¾‹æ“ä½œåŠŸèƒ½
        function addCase() {
            editingCase = null;
            showCaseModal('æ·»åŠ æ¡ˆä¾‹');
        }

        function editCase(caseId) {
            const caseItem = allCases.find(c => c.id === caseId);
            if (!caseItem) {
                showNotification('æ¡ˆä¾‹ä¸å­˜åœ¨', 'danger');
                return;
            }
            editingCase = caseItem;
            showCaseModal('ç¼–è¾‘æ¡ˆä¾‹', caseItem);
        }

        function viewCase(caseId) {
            const caseItem = allCases.find(c => c.id === caseId);
            if (!caseItem) {
                showNotification('æ¡ˆä¾‹ä¸å­˜åœ¨', 'danger');
                return;
            }
            showCaseModal('æŸ¥çœ‹æ¡ˆä¾‹', caseItem, true);
        }

        function copyCase(caseId) {
            const caseItem = allCases.find(c => c.id === caseId);
            if (!caseItem) {
                showNotification('æ¡ˆä¾‹ä¸å­˜åœ¨', 'danger');
                return;
            }

            const newCase = {
                ...caseItem,
                id: 'case-' + Date.now(),
                title: caseItem.title + ' (å‰¯æœ¬)',
                status: 'è‰ç¨¿',
                projectDate: new Date().toISOString().split('T')[0]
            };

            allCases.unshift(newCase);
            filteredCases = [...allCases];
            renderCasesList();
            showNotification('æ¡ˆä¾‹å¤åˆ¶æˆåŠŸ', 'success');
        }

        async function deleteCase(caseId) {
            const caseItem = allCases.find(c => c.id === caseId);
            if (!caseItem) {
                showNotification('æ¡ˆä¾‹ä¸å­˜åœ¨', 'danger');
                return;
            }

            if (confirm(`ç¡®å®šè¦åˆ é™¤æ¡ˆä¾‹ "${caseItem.title}" å—ï¼Ÿæ­¤æ“ä½œä¸å¯æ¢å¤ã€‚`)) {
                try {
                    // ä»æ•°ç»„ä¸­åˆ é™¤
                    allCases = allCases.filter(c => c.id !== caseId);
                    filteredCases = filteredCases.filter(c => c.id !== caseId);

                    renderCasesList();
                    showNotification('æ¡ˆä¾‹åˆ é™¤æˆåŠŸ', 'success');
                } catch (error) {
                    console.error('åˆ é™¤æ¡ˆä¾‹å¤±è´¥:', error);
                    showNotification('åˆ é™¤æ¡ˆä¾‹å¤±è´¥: ' + error.message, 'danger');
                }
            }
        }

        function refreshCasesList() {
            showCasesList();
        }

        function exportCases() {
            try {
                const dataStr = JSON.stringify(allCases, null, 2);
                const dataBlob = new Blob([dataStr], {type: 'application/json'});
                const url = URL.createObjectURL(dataBlob);
                const link = document.createElement('a');
                link.href = url;
                link.download = `cases_export_${new Date().toISOString().split('T')[0]}.json`;
                link.click();
                URL.revokeObjectURL(url);
                showNotification('æ¡ˆä¾‹æ•°æ®å¯¼å‡ºæˆåŠŸ', 'success');
            } catch (error) {
                showNotification('å¯¼å‡ºå¤±è´¥: ' + error.message, 'danger');
            }
        }

        // ç”Ÿæˆæ¡ˆä¾‹Hugoæ–‡ä»¶
        function generateCaseHugoFiles() {
            if (allCases.length === 0) {
                showNotification('æ²¡æœ‰æ¡ˆä¾‹æ•°æ®å¯ä»¥ç”Ÿæˆ', 'warning');
                return;
            }

            const confirmMsg = `ç¡®å®šè¦ä¸ºå½“å‰ ${allCases.length} ä¸ªæ¡ˆä¾‹ç”ŸæˆHugo markdownæ–‡ä»¶å—ï¼Ÿ\n\nç”Ÿæˆçš„æ–‡ä»¶éœ€è¦æ‰‹åŠ¨æ”¾å…¥ content/cases/ ç›®å½•ä¸­ã€‚`;

            if (!confirm(confirmMsg)) {
                return;
            }

            try {
                // æ˜¾ç¤ºè¿›åº¦æç¤º
                showNotification('æ­£åœ¨ç”Ÿæˆæ¡ˆä¾‹Hugoæ–‡ä»¶ï¼Œè¯·ç¨å€™...', 'info');

                // ä¸ºæ¯ä¸ªæ¡ˆä¾‹ç”Ÿæˆmarkdownæ–‡ä»¶
                allCases.forEach((caseItem, index) => {
                    setTimeout(() => {
                        const content = window.ContentAPI.generateCaseMarkdown(caseItem);
                        window.ContentAPI.downloadCaseMarkdownFile(caseItem, content);

                        // æœ€åä¸€ä¸ªæ–‡ä»¶ä¸‹è½½å®Œæˆåæ˜¾ç¤ºæˆåŠŸæ¶ˆæ¯
                        if (index === allCases.length - 1) {
                            setTimeout(() => {
                                showNotification(`æˆåŠŸç”Ÿæˆ ${allCases.length} ä¸ªæ¡ˆä¾‹Hugoæ–‡ä»¶ï¼è¯·å°†ä¸‹è½½çš„.mdæ–‡ä»¶æ”¾å…¥ content/cases/ ç›®å½•`, 'success');
                            }, 500);
                        }
                    }, index * 300); // æ¯300msä¸‹è½½ä¸€ä¸ªæ–‡ä»¶ï¼Œé¿å…æµè§ˆå™¨é˜»æ­¢å¤šä¸ªä¸‹è½½
                });

            } catch (error) {
                showNotification('ç”Ÿæˆæ¡ˆä¾‹Hugoæ–‡ä»¶å¤±è´¥: ' + error.message, 'danger');
            }
        }

        function importCases() {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = '.json';
            input.onchange = function(e) {
                const file = e.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        try {
                            const importedCases = JSON.parse(e.target.result);
                            if (Array.isArray(importedCases)) {
                                allCases = [...allCases, ...importedCases];
                                filteredCases = [...allCases];
                                renderCasesList();
                                showNotification(`æˆåŠŸå¯¼å…¥ ${importedCases.length} æ¡æ¡ˆä¾‹`, 'success');
                            } else {
                                showNotification('å¯¼å…¥æ–‡ä»¶æ ¼å¼é”™è¯¯', 'danger');
                            }
                        } catch (error) {
                            showNotification('å¯¼å…¥å¤±è´¥: ' + error.message, 'danger');
                        }
                    };
                    reader.readAsText(file);
                }
            };
            input.click();
        }

        let caseContentEditor;

        function showCaseModal(title, caseItem = null, readonly = false) {
            // è®¾ç½®æ¨¡æ€æ¡†æ ‡é¢˜
            document.getElementById('caseModalLabel').textContent = title;

            // åˆå§‹åŒ–å¯Œæ–‡æœ¬ç¼–è¾‘å™¨ï¼ˆå¦‚æœè¿˜æ²¡æœ‰åˆå§‹åŒ–ï¼‰
            if (!caseContentEditor) {
                caseContentEditor = new Quill('#caseContentEditor', {
                    theme: 'snow',
                    modules: {
                        toolbar: [
                            [{ 'header': [1, 2, 3, false] }],
                            ['bold', 'italic', 'underline', 'strike'],
                            [{ 'list': 'ordered'}, { 'list': 'bullet' }],
                            [{ 'indent': '-1'}, { 'indent': '+1' }],
                            ['link', 'image'],
                            ['clean']
                        ]
                    }
                });
            }

            // å¡«å……è¡¨å•æ•°æ®
            if (caseItem) {
                document.getElementById('caseTitle').value = caseItem.title || '';
                document.getElementById('caseSummary').value = caseItem.summary || '';
                document.getElementById('caseClient').value = caseItem.client || '';
                document.getElementById('caseIndustry').value = caseItem.industry || '';
                document.getElementById('casePrimaryCategory').value = caseItem.productCategory || '';
                document.getElementById('caseApplicationField').value = caseItem.applicationField || '';
                document.getElementById('caseApplicationScenario').value = caseItem.applicationScenario || '';
                document.getElementById('caseDetectionObject').value = caseItem.detectionObject || '';
                document.getElementById('caseEquipmentUsed').value = caseItem.productModel || caseItem.equipmentUsed || '';
                document.getElementById('caseDate').value = caseItem.projectDate || caseItem.date || '';
                document.getElementById('caseFeaturedImage').value = caseItem.featured_image || '';

                // è®¾ç½®å¯Œæ–‡æœ¬ç¼–è¾‘å™¨å†…å®¹
                caseContentEditor.root.innerHTML = caseItem.content || '';

                // æ˜¾ç¤ºå›¾ç‰‡é¢„è§ˆ
                if (caseItem.featured_image) {
                    const preview = document.getElementById('caseImagePreview');
                    const img = preview.querySelector('img');
                    img.src = caseItem.featured_image;
                    preview.style.display = 'block';
                }
            } else {
                // æ¸…ç©ºè¡¨å•
                document.getElementById('caseForm').reset();
                caseContentEditor.root.innerHTML = '';
                document.getElementById('caseImagePreview').style.display = 'none';

                // è®¾ç½®é»˜è®¤æ—¥æœŸ
                document.getElementById('caseDate').value = new Date().toISOString().split('T')[0];
            }

            // è®¾ç½®åªè¯»æ¨¡å¼
            if (readonly) {
                document.querySelectorAll('#caseModal input, #caseModal select, #caseModal textarea').forEach(el => {
                    el.disabled = true;
                });
                caseContentEditor.disable();
                document.querySelector('#caseModal .btn-primary').style.display = 'none';
            } else {
                document.querySelectorAll('#caseModal input, #caseModal select, #caseModal textarea').forEach(el => {
                    el.disabled = false;
                });
                caseContentEditor.enable();
                document.querySelector('#caseModal .btn-primary').style.display = 'inline-block';
            }

            // æ˜¾ç¤ºæ¨¡æ€æ¡†
            const modal = new bootstrap.Modal(document.getElementById('caseModal'));
            modal.show();
        }

        async function saveCase() {
            // æ˜¾ç¤ºä¿å­˜ä¸­çŠ¶æ€
            const saveBtn = document.querySelector('button[onclick="saveCase()"]');
            const originalText = saveBtn.innerHTML;
            saveBtn.innerHTML = '<i class="fas fa-spinner fa-spin me-1"></i>ä¿å­˜ä¸­...';
            saveBtn.disabled = true;

            try {
                const title = document.getElementById('caseTitle').value.trim();
                const summary = document.getElementById('caseSummary').value.trim();
                const content = caseContentEditor.root.innerHTML;
                const client = document.getElementById('caseClient').value.trim();
                const industry = document.getElementById('caseIndustry').value;
                const primaryCategory = document.getElementById('casePrimaryCategory').value;
                const applicationField = document.getElementById('caseApplicationField').value;
                const applicationScenario = document.getElementById('caseApplicationScenario').value;
                const detectionObject = document.getElementById('caseDetectionObject').value.trim();
                const equipmentUsed = document.getElementById('caseEquipmentUsed').value.trim();
                const date = document.getElementById('caseDate').value;
                const featuredImage = document.getElementById('caseFeaturedImage').value.trim();

                // éªŒè¯å¿…å¡«å­—æ®µ
                if (!title || !summary || !content) {
                    showNotification('è¯·å¡«å†™æ‰€æœ‰å¿…å¡«å­—æ®µ', 'warning');
                    return;
                }

                const caseData = {
                    id: editingCase ? editingCase.id : null,
                    title,
                    summary,
                    content,
                    client,
                    industry,
                    primary_category: primaryCategory ? [primaryCategory] : [],
                    application_field: applicationField ? [applicationField] : [],
                    application_scenario: applicationScenario ? [applicationScenario] : [],
                    detection_object: detectionObject,
                    equipment_used: equipmentUsed,
                    date: date || new Date().toISOString().split('T')[0],
                    featured_image: featuredImage || `/images/cases/default-case.jpg`
                };

                // ä¿å­˜åˆ°æ–‡ä»¶ç³»ç»Ÿ
                const result = await window.ContentAPI.saveCase(caseData);

                if (result.success) {
                    // æ›´æ–°å†…å­˜ä¸­çš„æ•°æ®
                    if (editingCase) {
                        const index = allCases.findIndex(c => c.id === editingCase.id);
                        if (index !== -1) {
                            allCases[index] = { ...allCases[index], ...caseData };
                        }
                        showNotification(result.message || 'æ¡ˆä¾‹æ›´æ–°æˆåŠŸï¼Œå·²ç”ŸæˆHugoæ–‡ä»¶', 'success');
                    } else {
                        allCases.unshift({ ...caseData, id: result.data.id });
                        showNotification(result.message || 'æ¡ˆä¾‹æ·»åŠ æˆåŠŸï¼Œå·²ç”ŸæˆHugoæ–‡ä»¶', 'success');
                    }

                    // æ›´æ–°è¿‡æ»¤åçš„æ•°æ®å¹¶é‡æ–°æ¸²æŸ“
                    filteredCases = [...allCases];
                    renderCasesList();

                    // å…³é—­æ¨¡æ€æ¡†
                    const modal = bootstrap.Modal.getInstance(document.getElementById('caseModal'));
                    modal.hide();
                } else {
                    showNotification(result.message || 'æ¡ˆä¾‹ä¿å­˜å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œè¿æ¥', 'danger');
                }

            } catch (error) {
                console.error('ä¿å­˜æ¡ˆä¾‹å¤±è´¥:', error);
                showNotification('ä¿å­˜æ¡ˆä¾‹å¤±è´¥: ' + error.message, 'danger');
            } finally {
                // æ¢å¤æŒ‰é’®çŠ¶æ€
                saveBtn.innerHTML = originalText;
                saveBtn.disabled = false;
            }
        }
        // åº”ç”¨é¢†åŸŸæ“ä½œåŠŸèƒ½
        function addApplication() {
            editingApplication = null;
            showApplicationModal('æ·»åŠ åº”ç”¨é¢†åŸŸ');
        }

        function editApplication(appId) {
            const app = allApplications.find(a => a.id === appId);
            if (!app) {
                showNotification('åº”ç”¨é¢†åŸŸä¸å­˜åœ¨', 'danger');
                return;
            }
            editingApplication = app;
            showApplicationModal('ç¼–è¾‘åº”ç”¨é¢†åŸŸ', app);
        }

        function viewApplication(appId) {
            const app = allApplications.find(a => a.id === appId);
            if (!app) {
                showNotification('åº”ç”¨é¢†åŸŸä¸å­˜åœ¨', 'danger');
                return;
            }
            showApplicationModal('æŸ¥çœ‹åº”ç”¨é¢†åŸŸ', app, true);
        }

        function copyApplication(appId) {
            const app = allApplications.find(a => a.id === appId);
            if (!app) {
                showNotification('åº”ç”¨é¢†åŸŸä¸å­˜åœ¨', 'danger');
                return;
            }

            const newApp = {
                ...app,
                id: 'app-' + Date.now(),
                title: app.title + ' (å‰¯æœ¬)',
                status: 'è‰ç¨¿'
            };

            allApplications.unshift(newApp);
            filteredApplications = [...allApplications];
            renderApplicationsList();
            showNotification('åº”ç”¨é¢†åŸŸå¤åˆ¶æˆåŠŸ', 'success');
        }

        async function deleteApplication(appId) {
            const app = allApplications.find(a => a.id === appId);
            if (!app) {
                showNotification('åº”ç”¨é¢†åŸŸä¸å­˜åœ¨', 'danger');
                return;
            }

            if (confirm(`ç¡®å®šè¦åˆ é™¤åº”ç”¨é¢†åŸŸ "${app.title}" å—ï¼Ÿæ­¤æ“ä½œä¸å¯æ¢å¤ã€‚`)) {
                try {
                    // ä»æ•°ç»„ä¸­åˆ é™¤
                    allApplications = allApplications.filter(a => a.id !== appId);
                    filteredApplications = filteredApplications.filter(a => a.id !== appId);

                    renderApplicationsList();
                    showNotification('åº”ç”¨é¢†åŸŸåˆ é™¤æˆåŠŸ', 'success');
                } catch (error) {
                    console.error('åˆ é™¤åº”ç”¨é¢†åŸŸå¤±è´¥:', error);
                    showNotification('åˆ é™¤åº”ç”¨é¢†åŸŸå¤±è´¥: ' + error.message, 'danger');
                }
            }
        }

        function refreshApplicationsList() {
            showApplications();
        }

        function exportApplications() {
            try {
                const dataStr = JSON.stringify(allApplications, null, 2);
                const dataBlob = new Blob([dataStr], {type: 'application/json'});
                const url = URL.createObjectURL(dataBlob);
                const link = document.createElement('a');
                link.href = url;
                link.download = `applications_export_${new Date().toISOString().split('T')[0]}.json`;
                link.click();
                URL.revokeObjectURL(url);
                showNotification('åº”ç”¨é¢†åŸŸæ•°æ®å¯¼å‡ºæˆåŠŸ', 'success');
            } catch (error) {
                showNotification('å¯¼å‡ºå¤±è´¥: ' + error.message, 'danger');
            }
        }

        function importApplications() {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = '.json';
            input.onchange = function(e) {
                const file = e.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        try {
                            const importedApps = JSON.parse(e.target.result);
                            if (Array.isArray(importedApps)) {
                                allApplications = [...allApplications, ...importedApps];
                                filteredApplications = [...allApplications];
                                renderApplicationsList();
                                showNotification(`æˆåŠŸå¯¼å…¥ ${importedApps.length} æ¡åº”ç”¨é¢†åŸŸ`, 'success');
                            } else {
                                showNotification('å¯¼å…¥æ–‡ä»¶æ ¼å¼é”™è¯¯', 'danger');
                            }
                        } catch (error) {
                            showNotification('å¯¼å…¥å¤±è´¥: ' + error.message, 'danger');
                        }
                    };
                    reader.readAsText(file);
                }
            };
            input.click();
        }

        function showApplicationModal(title, app = null, readonly = false) {
            // è¿™é‡Œéœ€è¦æ·»åŠ åº”ç”¨é¢†åŸŸæ¨¡æ€æ¡†çš„HTMLå’Œç›¸å…³åŠŸèƒ½
            // æš‚æ—¶æ˜¾ç¤ºæç¤ºä¿¡æ¯
            showNotification('åº”ç”¨é¢†åŸŸç¼–è¾‘æ¨¡æ€æ¡†åŠŸèƒ½æ­£åœ¨å®Œå–„ä¸­', 'info');
        }
        function addSeries() { showNotification('æ·»åŠ ç³»åˆ—åŠŸèƒ½æ­£åœ¨å¼€å‘ä¸­', 'info'); }
        function uploadMedia() { showNotification('ä¸Šä¼ åª’ä½“åŠŸèƒ½æ­£åœ¨å¼€å‘ä¸­', 'info'); }




























        // å®šåˆ¶éœ€æ±‚ç®¡ç†å·²è¿ç§»åˆ°Netlify Forms

        // ContentAPI å®ç° - ç»Ÿä¸€çš„å†…å®¹ç®¡ç†API
        window.ContentAPI = {
            // ä¿å­˜äº§å“åˆ°localStorageå’Œç”ŸæˆHugoæ–‡ä»¶
            async saveProduct(productData) {
                try {
                    // ç”Ÿæˆäº§å“IDï¼ˆå¦‚æœæ²¡æœ‰ï¼‰
                    if (!productData.id) {
                        productData.id = 'product_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
                    }

                    // æ·»åŠ æ—¶é—´æˆ³
                    productData.createdAt = productData.createdAt || new Date().toISOString();
                    productData.updatedAt = new Date().toISOString();
                    productData.synced = false; // æ ‡è®°ä¸ºæœªåŒæ­¥

                    // ä¿å­˜åˆ°localStorage
                    let savedProducts = JSON.parse(localStorage.getItem('visndt_products') || '[]');

                    // æ£€æŸ¥æ˜¯å¦æ˜¯æ›´æ–°ç°æœ‰äº§å“
                    const existingIndex = savedProducts.findIndex(p => p.id === productData.id);
                    if (existingIndex !== -1) {
                        savedProducts[existingIndex] = productData;
                    } else {
                        savedProducts.push(productData);
                    }

                    localStorage.setItem('visndt_products', JSON.stringify(savedProducts));

                    // ç”ŸæˆHugo markdownæ–‡ä»¶å†…å®¹
                    const markdownContent = this.generateHugoMarkdown(productData);

                    // åˆ›å»ºä¸‹è½½é“¾æ¥
                    this.downloadMarkdownFile(productData, markdownContent);

                    return {
                        success: true,
                        message: 'äº§å“ä¿å­˜æˆåŠŸï¼è¯·ä¸‹è½½ç”Ÿæˆçš„markdownæ–‡ä»¶å¹¶æ”¾å…¥content/products/ç›®å½•',
                        data: productData
                    };

                } catch (error) {
                    console.error('ä¿å­˜äº§å“å¤±è´¥:', error);
                    return {
                        success: false,
                        message: 'ä¿å­˜å¤±è´¥: ' + error.message
                    };
                }
            },

            // ç”ŸæˆHugo markdownæ–‡ä»¶å†…å®¹
            generateHugoMarkdown(product) {
                // ç”ŸæˆYAML front matter
                let yaml = '---\n';
                yaml += `title: "${product.title}"\n`;
                yaml += `summary: ${product.summary || ''}\n`;
                yaml += `primary_category: "${product.primary_category}"\n`;
                if (product.secondary_category) {
                    yaml += `secondary_category: "${product.secondary_category}"\n`;
                }
                yaml += `model: "${product.model}"\n`;
                yaml += `series: "${product.series}"\n`;
                yaml += `supplier: "${product.supplier}"\n`;

                // å‘å¸ƒæ—¶é—´
                if (product.published && product.published !== false) {
                    const publishDate = typeof product.published === 'string' ?
                        product.published : new Date().toISOString();
                    yaml += `published: ${publishDate}\n`;
                }

                // å›¾åº“
                if (product.gallery && product.gallery.length > 0) {
                    yaml += `gallery:\n`;
                    product.gallery.forEach(img => {
                        yaml += `  - image: "${img.image}"\n`;
                        yaml += `    alt: "${img.alt}"\n`;
                        if (img.is_main) {
                            yaml += `    is_main: true\n`;
                        }
                    });
                }

                // å‚æ•°
                if (product.parameters && product.parameters.length > 0) {
                    yaml += `parameters:\n`;
                    product.parameters.forEach(param => {
                        yaml += `  - name: "${param.name}"\n`;
                        yaml += `    value: "${param.value}"\n`;
                    });
                }

                // åº”ç”¨åœºæ™¯
                if (product.application_scenarios) {
                    yaml += `application_scenarios: |\n`;
                    const scenarios = product.application_scenarios.replace(/\n/g, '\n  ');
                    yaml += `  ${scenarios}\n`;
                }

                // èµ„æ–™ä¸‹è½½
                if (product.data_download && product.data_download.length > 0) {
                    yaml += `data_download:\n`;
                    product.data_download.forEach(download => {
                        yaml += `  - file_title: "${download.file_title}"\n`;
                        yaml += `    file_path: "${download.file_path}"\n`;
                    });
                }

                // ç›¸å…³äº§å“
                if (product.related_products && product.related_products.length > 0) {
                    yaml += `related_products:\n`;
                    product.related_products.forEach(relatedId => {
                        yaml += `  - "${relatedId}"\n`;
                    });
                }

                yaml += '---\n\n';

                // æ·»åŠ äº§å“æè¿°å†…å®¹
                let content = '';
                if (product.content) {
                    // æ¸…ç†HTMLæ ‡ç­¾ï¼Œä¿ç•™åŸºæœ¬æ ¼å¼
                    content = product.content
                        .replace(/<p>/g, '')
                        .replace(/<\/p>/g, '\n\n')
                        .replace(/<br>/g, '\n')
                        .replace(/<strong>/g, '**')
                        .replace(/<\/strong>/g, '**')
                        .replace(/<em>/g, '*')
                        .replace(/<\/em>/g, '*')
                        .replace(/<[^>]*>/g, '')
                        .trim();
                } else {
                    content = `**${product.title}æ˜¯ä¸€æ¬¾ä¸“ä¸šçš„å·¥ä¸šæ£€æµ‹è®¾å¤‡ï¼Œå…·æœ‰ä¼˜å¼‚çš„æ€§èƒ½å’Œå¯é æ€§ã€‚**\n\n`;

                    // å¦‚æœæœ‰å›¾åº“ï¼Œæ·»åŠ å›¾ç‰‡å±•ç¤º
                    if (product.gallery && product.gallery.length > 1) {
                        content += product.gallery.slice(1).map(img =>
                            `- ![${img.alt}](${img.image})`
                        ).join('\n') + '\n';
                    }
                }

                return yaml + content;
            },

            // ä¸‹è½½markdownæ–‡ä»¶
            downloadMarkdownFile(product, content) {
                const filename = `${product.model || product.id || 'product'}.md`;
                const blob = new Blob([content], { type: 'text/markdown;charset=utf-8' });
                const url = URL.createObjectURL(blob);

                const link = document.createElement('a');
                link.href = url;
                link.download = filename;
                link.style.display = 'none';

                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);

                URL.revokeObjectURL(url);
            },

            // åˆ é™¤äº§å“
            async deleteProduct(productId) {
                try {
                    let savedProducts = JSON.parse(localStorage.getItem('visndt_products') || '[]');
                    const productIndex = savedProducts.findIndex(p => p.id === productId);

                    if (productIndex === -1) {
                        return {
                            success: false,
                            message: 'äº§å“ä¸å­˜åœ¨'
                        };
                    }

                    const product = savedProducts[productIndex];
                    savedProducts.splice(productIndex, 1);
                    localStorage.setItem('visndt_products', JSON.stringify(savedProducts));

                    // ç”Ÿæˆåˆ é™¤æŒ‡å¯¼ä¿¡æ¯
                    const deleteInstructions = this.generateDeleteInstructions(product);

                    return {
                        success: true,
                        message: `äº§å“ "${product.title || product.model}" åˆ é™¤æˆåŠŸï¼`,
                        deleteInstructions: deleteInstructions
                    };

                } catch (error) {
                    return {
                        success: false,
                        message: 'åˆ é™¤å¤±è´¥: ' + error.message
                    };
                }
            },

            // ç”Ÿæˆåˆ é™¤æŒ‡å¯¼ä¿¡æ¯
            generateDeleteInstructions(product) {
                const instructions = [];

                // MDæ–‡ä»¶åˆ é™¤æŒ‡å¯¼
                const mdFileName = `${product.model || product.id}.md`;
                instructions.push(`1. åˆ é™¤markdownæ–‡ä»¶: content/products/${mdFileName}`);

                // å›¾ç‰‡æ–‡ä»¶åˆ é™¤æŒ‡å¯¼
                if (product.gallery && product.gallery.length > 0) {
                    instructions.push(`2. åˆ é™¤äº§å“å›¾ç‰‡:`);
                    product.gallery.forEach((img, index) => {
                        if (img.image && !img.image.startsWith('http') && !img.image.includes('picsum')) {
                            instructions.push(`   - ${img.image}`);
                        }
                    });
                }

                // èµ„æ–™æ–‡ä»¶åˆ é™¤æŒ‡å¯¼
                if (product.data_download && product.data_download.length > 0) {
                    instructions.push(`3. åˆ é™¤èµ„æ–™æ–‡ä»¶:`);
                    product.data_download.forEach(download => {
                        if (download.file_path && !download.file_path.startsWith('http')) {
                            instructions.push(`   - ${download.file_path}`);
                        }
                    });
                }

                return instructions;
            },

            // è·å–æœ¬åœ°äº§å“
            getLocalProducts() {
                return JSON.parse(localStorage.getItem('visndt_products') || '[]');
            },

            // æ£€æŸ¥æœåŠ¡å™¨çŠ¶æ€ï¼ˆæ¨¡æ‹Ÿï¼‰
            async checkServerStatus() {
                // æ¨¡æ‹ŸæœåŠ¡å™¨æ£€æŸ¥ï¼Œæ€»æ˜¯è¿”å›falseï¼ˆç¦»çº¿æ¨¡å¼ï¼‰
                return false;
            },

            // åŒæ­¥æœ¬åœ°æ•°æ®ï¼ˆç”Ÿæˆæ‰€æœ‰äº§å“çš„markdownæ–‡ä»¶ï¼‰
            async syncLocalData() {
                try {
                    const localProducts = this.getLocalProducts();
                    const unsyncedProducts = localProducts.filter(p => !p.synced);

                    if (unsyncedProducts.length === 0) {
                        return {
                            success: true,
                            message: 'æ²¡æœ‰éœ€è¦åŒæ­¥çš„æ•°æ®'
                        };
                    }

                    // ç”ŸæˆZIPæ–‡ä»¶åŒ…å«æ‰€æœ‰markdownæ–‡ä»¶
                    this.downloadAllMarkdownFiles(unsyncedProducts);

                    // æ ‡è®°ä¸ºå·²åŒæ­¥
                    localProducts.forEach(p => p.synced = true);
                    localStorage.setItem('visndt_products', JSON.stringify(localProducts));

                    return {
                        success: true,
                        message: `å·²ç”Ÿæˆ ${unsyncedProducts.length} ä¸ªäº§å“çš„markdownæ–‡ä»¶ï¼Œè¯·è§£å‹åˆ°content/products/ç›®å½•`
                    };

                } catch (error) {
                    return {
                        success: false,
                        message: 'åŒæ­¥å¤±è´¥: ' + error.message
                    };
                }
            },

            // ä¸‹è½½æ‰€æœ‰markdownæ–‡ä»¶ï¼ˆç®€åŒ–ç‰ˆï¼Œé€ä¸ªä¸‹è½½ï¼‰
            downloadAllMarkdownFiles(products) {
                products.forEach((product, index) => {
                    setTimeout(() => {
                        const content = this.generateHugoMarkdown(product);
                        this.downloadMarkdownFile(product, content);
                    }, index * 500); // æ¯500msä¸‹è½½ä¸€ä¸ªæ–‡ä»¶
                });
            },

            // ä¿å­˜èµ„è®¯
            async saveNews(newsData) {
                try {
                    if (!newsData.id) {
                        newsData.id = 'news_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
                    }

                    newsData.createdAt = newsData.createdAt || new Date().toISOString();
                    newsData.updatedAt = new Date().toISOString();
                    newsData.synced = false;

                    let savedNews = JSON.parse(localStorage.getItem('visndt_news') || '[]');

                    const existingIndex = savedNews.findIndex(n => n.id === newsData.id);
                    if (existingIndex !== -1) {
                        savedNews[existingIndex] = newsData;
                    } else {
                        savedNews.push(newsData);
                    }

                    localStorage.setItem('visndt_news', JSON.stringify(savedNews));

                    const markdownContent = this.generateNewsMarkdown(newsData);
                    this.downloadNewsMarkdownFile(newsData, markdownContent);

                    return {
                        success: true,
                        message: 'èµ„è®¯ä¿å­˜æˆåŠŸï¼è¯·ä¸‹è½½ç”Ÿæˆçš„markdownæ–‡ä»¶å¹¶æ”¾å…¥content/news/ç›®å½•',
                        data: newsData
                    };

                } catch (error) {
                    console.error('ä¿å­˜èµ„è®¯å¤±è´¥:', error);
                    return {
                        success: false,
                        message: 'ä¿å­˜å¤±è´¥: ' + error.message
                    };
                }
            },

            // ç”Ÿæˆèµ„è®¯Hugo markdownæ–‡ä»¶å†…å®¹
            generateNewsMarkdown(news) {
                const frontMatter = {
                    title: news.title,
                    date: news.publishDate || new Date().toISOString().split('T')[0],
                    summary: news.summary || '',
                    categories: news.categories || [],
                    tags: news.tags || [],
                    author: news.author || 'ç¼–è¾‘éƒ¨',
                    views: news.views || 0,
                    featured_image: news.featured_image || ''
                };

                let yaml = '---\n';
                for (const [key, value] of Object.entries(frontMatter)) {
                    if (Array.isArray(value)) {
                        if (value.length > 0) {
                            yaml += `${key}:\n`;
                            value.forEach(item => {
                                yaml += `- ${item}\n`;
                            });
                        } else {
                            yaml += `${key}: []\n`;
                        }
                    } else {
                        yaml += `${key}: "${value}"\n`;
                    }
                }
                yaml += '---\n\n';

                const content = news.content || `# ${news.title}

${news.summary || ''}

## æ­£æ–‡å†…å®¹

è¯·åœ¨æ­¤å¤„æ·»åŠ è¯¦ç»†å†…å®¹...
`;

                return yaml + content;
            },

            // ä¸‹è½½èµ„è®¯markdownæ–‡ä»¶
            downloadNewsMarkdownFile(news, content) {
                const filename = `${news.publishDate || new Date().toISOString().split('T')[0]}-${(news.title || 'news').replace(/[^a-zA-Z0-9\u4e00-\u9fa5]/g, '-')}.md`;
                const blob = new Blob([content], { type: 'text/markdown;charset=utf-8' });
                const url = URL.createObjectURL(blob);

                const link = document.createElement('a');
                link.href = url;
                link.download = filename;
                link.style.display = 'none';

                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);

                URL.revokeObjectURL(url);
            },

            // ä¿å­˜æ¡ˆä¾‹
            async saveCase(caseData) {
                try {
                    if (!caseData.id) {
                        caseData.id = 'case_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
                    }

                    caseData.createdAt = caseData.createdAt || new Date().toISOString();
                    caseData.updatedAt = new Date().toISOString();
                    caseData.synced = false;

                    let savedCases = JSON.parse(localStorage.getItem('visndt_cases') || '[]');

                    const existingIndex = savedCases.findIndex(c => c.id === caseData.id);
                    if (existingIndex !== -1) {
                        savedCases[existingIndex] = caseData;
                    } else {
                        savedCases.push(caseData);
                    }

                    localStorage.setItem('visndt_cases', JSON.stringify(savedCases));

                    const markdownContent = this.generateCaseMarkdown(caseData);
                    this.downloadCaseMarkdownFile(caseData, markdownContent);

                    return {
                        success: true,
                        message: 'æ¡ˆä¾‹ä¿å­˜æˆåŠŸï¼è¯·ä¸‹è½½ç”Ÿæˆçš„markdownæ–‡ä»¶å¹¶æ”¾å…¥content/cases/ç›®å½•',
                        data: caseData
                    };

                } catch (error) {
                    console.error('ä¿å­˜æ¡ˆä¾‹å¤±è´¥:', error);
                    return {
                        success: false,
                        message: 'ä¿å­˜å¤±è´¥: ' + error.message
                    };
                }
            },

            // ç”Ÿæˆæ¡ˆä¾‹Hugo markdownæ–‡ä»¶å†…å®¹
            generateCaseMarkdown(caseData) {
                const frontMatter = {
                    title: caseData.title,
                    primary_category: caseData.primary_category || [],
                    application_field: caseData.application_field || [],
                    application_scenario: caseData.application_scenario || [],
                    featured_image: caseData.featured_image || '',
                    summary: caseData.summary || '',
                    date: caseData.date || new Date().toISOString().split('T')[0],
                    client: caseData.client || '',
                    industry: caseData.industry || '',
                    detection_object: caseData.detection_object || '',
                    equipment_used: caseData.equipment_used || ''
                };

                let yaml = '---\n';
                for (const [key, value] of Object.entries(frontMatter)) {
                    if (Array.isArray(value)) {
                        if (value.length > 0) {
                            yaml += `${key}:\n`;
                            value.forEach(item => {
                                yaml += `  - "${item}"\n`;
                            });
                        } else {
                            yaml += `${key}: []\n`;
                        }
                    } else {
                        yaml += `${key}: "${value}"\n`;
                    }
                }
                yaml += '---\n\n';

                const content = caseData.content || `# ${caseData.title}

## é¡¹ç›®æ¦‚è¿°

${caseData.summary || ''}

## è§£å†³æ–¹æ¡ˆ

è¯·åœ¨æ­¤å¤„æ·»åŠ è¯¦ç»†çš„è§£å†³æ–¹æ¡ˆå†…å®¹...

## å®æ–½æ•ˆæœ

è¯·åœ¨æ­¤å¤„æ·»åŠ é¡¹ç›®å®æ–½æ•ˆæœ...

## å®¢æˆ·è¯„ä»·

è¯·åœ¨æ­¤å¤„æ·»åŠ å®¢æˆ·è¯„ä»·...
`;

                return yaml + content;
            },

            // ä¸‹è½½æ¡ˆä¾‹markdownæ–‡ä»¶
            downloadCaseMarkdownFile(caseData, content) {
                const filename = `${(caseData.title || 'case').replace(/[^a-zA-Z0-9\u4e00-\u9fa5]/g, '-')}.md`;
                const blob = new Blob([content], { type: 'text/markdown;charset=utf-8' });
                const url = URL.createObjectURL(blob);

                const link = document.createElement('a');
                link.href = url;
                link.download = filename;
                link.style.display = 'none';

                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);

                URL.revokeObjectURL(url);
            }
        };

        // ä¸ºäº†å‘åå…¼å®¹ï¼Œä¿ç•™ProductAPIåˆ«å
        window.ProductAPI = window.ContentAPI;

        // å†…å®¹åŒæ­¥ç®¡ç†å™¨
        window.ContentSyncManager = {
            // åŒæ­¥çŠ¶æ€
            syncStatus: {
                products: { lastSync: null, status: 'pending' },
                suppliers: { lastSync: null, status: 'pending' },
                cases: { lastSync: null, status: 'pending' },
                news: { lastSync: null, status: 'pending' },
                applications: { lastSync: null, status: 'pending' }
            },

            // åˆå§‹åŒ–åŒæ­¥
            async initSync() {
                console.log('ğŸ”„ å¼€å§‹å†…å®¹åŒæ­¥...');
                showNotification('æ­£åœ¨åŒæ­¥é¡¹ç›®å†…å®¹...', 'info');

                try {
                    await this.syncAllContent();
                    showNotification('å†…å®¹åŒæ­¥å®Œæˆï¼', 'success');
                } catch (error) {
                    console.error('åŒæ­¥å¤±è´¥:', error);
                    showNotification('å†…å®¹åŒæ­¥å¤±è´¥: ' + error.message, 'danger');
                }
            },

            // åŒæ­¥æ‰€æœ‰å†…å®¹
            async syncAllContent() {
                const syncTasks = [
                    this.syncProducts(),
                    this.syncSuppliers(),
                    this.syncCases(),
                    this.syncNews(),
                    this.syncApplications()
                ];

                await Promise.all(syncTasks);
                this.updateSyncStatus();
            },

            // åŒæ­¥äº§å“å†…å®¹
            async syncProducts() {
                try {
                    this.syncStatus.products.status = 'syncing';

                    // ä»é¡¹ç›®çš„æœç´¢ç´¢å¼•è¯»å–äº§å“æ•°æ®
                    const projectProducts = await this.loadProjectProducts();
                    const localProducts = JSON.parse(localStorage.getItem('visndt_products') || '[]');

                    // åˆå¹¶å’ŒåŒæ­¥æ•°æ®
                    const syncedProducts = this.mergeProductData(projectProducts, localProducts);

                    // ä¿å­˜åŒæ­¥åçš„æ•°æ®
                    localStorage.setItem('visndt_products', JSON.stringify(syncedProducts));

                    this.syncStatus.products.status = 'completed';
                    this.syncStatus.products.lastSync = new Date().toISOString();

                    console.log(`âœ… äº§å“åŒæ­¥å®Œæˆ: ${syncedProducts.length} ä¸ªäº§å“`);

                } catch (error) {
                    this.syncStatus.products.status = 'error';
                    console.error('äº§å“åŒæ­¥å¤±è´¥:', error);
                    // ä¸æŠ›å‡ºé”™è¯¯ï¼Œå…è®¸å…¶ä»–åŒæ­¥ç»§ç»­
                }
            },

            // åŒæ­¥ä¾›åº”å•†å†…å®¹
            async syncSuppliers() {
                try {
                    this.syncStatus.suppliers.status = 'syncing';

                    const projectSuppliers = await this.loadProjectSuppliers();
                    const localSuppliers = JSON.parse(localStorage.getItem('visndt_suppliers') || '[]');

                    const syncedSuppliers = this.mergeSupplierData(projectSuppliers, localSuppliers);
                    localStorage.setItem('visndt_suppliers', JSON.stringify(syncedSuppliers));

                    this.syncStatus.suppliers.status = 'completed';
                    this.syncStatus.suppliers.lastSync = new Date().toISOString();

                    console.log(`âœ… ä¾›åº”å•†åŒæ­¥å®Œæˆ: ${syncedSuppliers.length} ä¸ªä¾›åº”å•†`);

                } catch (error) {
                    this.syncStatus.suppliers.status = 'error';
                    throw new Error(`ä¾›åº”å•†åŒæ­¥å¤±è´¥: ${error.message}`);
                }
            },

            // åŒæ­¥æ¡ˆä¾‹å†…å®¹
            async syncCases() {
                try {
                    this.syncStatus.cases.status = 'syncing';

                    const projectCases = await this.loadProjectCases();
                    const localCases = JSON.parse(localStorage.getItem('visndt_cases') || '[]');

                    const syncedCases = this.mergeCaseData(projectCases, localCases);
                    localStorage.setItem('visndt_cases', JSON.stringify(syncedCases));

                    this.syncStatus.cases.status = 'completed';
                    this.syncStatus.cases.lastSync = new Date().toISOString();

                    console.log(`âœ… æ¡ˆä¾‹åŒæ­¥å®Œæˆ: ${syncedCases.length} ä¸ªæ¡ˆä¾‹`);

                } catch (error) {
                    this.syncStatus.cases.status = 'error';
                    throw new Error(`æ¡ˆä¾‹åŒæ­¥å¤±è´¥: ${error.message}`);
                }
            },

            // åŒæ­¥æ–°é—»å†…å®¹
            async syncNews() {
                try {
                    this.syncStatus.news.status = 'syncing';

                    const projectNews = await this.loadProjectNews();
                    const localNews = JSON.parse(localStorage.getItem('visndt_news') || '[]');

                    const syncedNews = this.mergeNewsData(projectNews, localNews);
                    localStorage.setItem('visndt_news', JSON.stringify(syncedNews));

                    this.syncStatus.news.status = 'completed';
                    this.syncStatus.news.lastSync = new Date().toISOString();

                    console.log(`âœ… æ–°é—»åŒæ­¥å®Œæˆ: ${syncedNews.length} æ¡æ–°é—»`);

                } catch (error) {
                    this.syncStatus.news.status = 'error';
                    throw new Error(`æ–°é—»åŒæ­¥å¤±è´¥: ${error.message}`);
                }
            },

            // åŒæ­¥åº”ç”¨é¢†åŸŸå†…å®¹
            async syncApplications() {
                try {
                    this.syncStatus.applications.status = 'syncing';

                    const projectApplications = await this.loadProjectApplications();
                    const localApplications = JSON.parse(localStorage.getItem('visndt_applications') || '[]');

                    const syncedApplications = this.mergeApplicationData(projectApplications, localApplications);
                    localStorage.setItem('visndt_applications', JSON.stringify(syncedApplications));

                    this.syncStatus.applications.status = 'completed';
                    this.syncStatus.applications.lastSync = new Date().toISOString();

                    console.log(`âœ… åº”ç”¨é¢†åŸŸåŒæ­¥å®Œæˆ: ${syncedApplications.length} ä¸ªåº”ç”¨é¢†åŸŸ`);

                } catch (error) {
                    this.syncStatus.applications.status = 'error';
                    throw new Error(`åº”ç”¨é¢†åŸŸåŒæ­¥å¤±è´¥: ${error.message}`);
                }
            },

            // åŠ è½½é¡¹ç›®äº§å“æ•°æ®ï¼ˆä»æœç´¢ç´¢å¼•è¯»å–çœŸå®æ•°æ®ï¼‰
            async loadProjectProducts() {
                try {
                    // é¦–å…ˆå°è¯•ä»æœç´¢ç´¢å¼•è¯»å–çœŸå®æ•°æ®
                    const realProducts = await this.loadProductsFromSearchIndex();
                    if (realProducts.length > 0) {
                        console.log(`ğŸ“¦ ä»æœç´¢ç´¢å¼•åŠ è½½äº§å“æ•°æ®: ${realProducts.length} ä¸ªäº§å“`);
                        return realProducts;
                    }

                    // å¦‚æœæœç´¢ç´¢å¼•ä¸å¯ç”¨ï¼Œä½¿ç”¨å¤‡ç”¨æ•°æ®
                    console.log('æœç´¢ç´¢å¼•ä¸å¯ç”¨ï¼Œä½¿ç”¨å¤‡ç”¨äº§å“æ•°æ®');
                    const productFiles = [
                        'WS-K08510-a', 'WS-K08510-b', 'WS-K09510-a', 'WS-K1010-a',
                        'WS-K1210-a', 'WS-K1210-b', 'WS-K1510-a', 'WS-K1510-b',
                        'WS-K1510-c', 'WS-K1810-a', 'ZB-K3920', 'product-dz60',
                        'product-p08510', 'product-p09510', 'product-p1010-model',
                        'product-p1210', 'product-p1510', 'product-p1810', 'product-p2010',
                        'product-p2210', 'product-p2410', 'product-p2810', 'product-p3910',
                        'product-p6010', 'product-p8020', 'test-backend-product', 'test-no-supplier'
                    ];

                    const projectProducts = [];

                    // ä¸ºæ¯ä¸ªäº§å“æ–‡ä»¶åˆ›å»ºåŸºç¡€æ•°æ®ç»“æ„
                    productFiles.forEach(filename => {
                        const id = filename.toLowerCase();
                        const isWSSeries = filename.startsWith('WS-');
                        const isZBSeries = filename.startsWith('ZB-');
                        const isPSeries = filename.startsWith('product-p');
                        const isDZSeries = filename.includes('dz');

                        let title, model, series, supplier, category;

                        if (isWSSeries) {
                            model = filename.toUpperCase();
                            title = `${model} å·¥ä¸šå†…çª¥é•œ`;
                            series = model.includes('K') ? 'Kç³»åˆ—' : 'WSç³»åˆ—';
                            supplier = 'æ·±åœ³å¸‚å¾®è§†å…‰ç”µç§‘æŠ€æœ‰é™å…¬å¸';
                            category = 'ç”µå­å†…çª¥é•œ';
                        } else if (isZBSeries) {
                            model = filename.toUpperCase();
                            title = `${model} çˆ¬è¡Œæœºå™¨äºº`;
                            series = 'ZBç³»åˆ—';
                            supplier = 'æ·±åœ³å¸‚å¾®è§†å…‰ç”µç§‘æŠ€æœ‰é™å…¬å¸';
                            category = 'çˆ¬è¡Œæœºå™¨äºº';
                        } else if (isPSeries) {
                            const pModel = filename.replace('product-p', 'P').toUpperCase();
                            model = pModel;
                            title = `${pModel} å·¥ä¸šå†…çª¥é•œ`;
                            series = 'Pç³»åˆ—';
                            supplier = 'å¤©æ´¥ç»´æ£®ç§‘æŠ€æœ‰é™å…¬å¸';
                            category = isDZSeries ? 'ç”µå­å†…çª¥é•œ' : 'å…‰çº¤å†…çª¥é•œ';
                        } else {
                            model = filename.toUpperCase();
                            title = `${filename} äº§å“`;
                            series = 'å…¶ä»–ç³»åˆ—';
                            supplier = 'æ·±åœ³å¸‚å¾®è§†å…‰ç”µç§‘æŠ€æœ‰é™å…¬å¸';
                            category = 'ç”µå­å†…çª¥é•œ';
                        }

                        projectProducts.push({
                            id: id,
                            title: title,
                            model: model,
                            series: series,
                            supplier: supplier,
                            primary_category: category,
                            secondary_category: category === 'ç”µå­å†…çª¥é•œ' ? 'å·¥ä¸šè§†é¢‘å†…çª¥é•œ' : 'å·¥ä¸šå†…çª¥é•œ',
                            status: 'published',
                            published: '2024-01-15T10:00:00Z',
                            summary: `${title}ï¼Œé€‚ç”¨äºå„ç§å·¥ä¸šæ£€æµ‹åœºæ™¯`,
                            gallery: [
                                { image: `/images/products/${series}/${filename}-main.jpg`, alt: `${title}ä¸»å›¾`, is_main: true }
                            ],
                            parameters: [
                                { name: 'æ¢å¤´ç›´å¾„', value: '10mm' },
                                { name: 'å·¥ä½œé•¿åº¦', value: '1000mm' }
                            ],
                            application_scenarios: 'é€‚ç”¨äºå·¥ä¸šæ£€æµ‹åœºæ™¯',
                            content: `**${title}**æ˜¯ä¸€æ¬¾ä¸“ä¸šçš„å·¥ä¸šæ£€æµ‹è®¾å¤‡ã€‚`,
                            data_download: [],
                            related_products: [],
                            source: 'project'
                        });
                    });

                    console.log(`ğŸ“¦ åŠ è½½é¡¹ç›®äº§å“æ•°æ®: ${projectProducts.length} ä¸ªäº§å“`);
                    return projectProducts;

                } catch (error) {
                    console.error('åŠ è½½é¡¹ç›®äº§å“æ•°æ®å¤±è´¥:', error);
                    return [];
                }
            },

            // ä»æœç´¢ç´¢å¼•åŠ è½½çœŸå®äº§å“æ•°æ®
            async loadProductsFromSearchIndex() {
                try {
                    const response = await fetch('/search-index.json');
                    if (!response.ok) {
                        throw new Error('æ— æ³•åŠ è½½æœç´¢ç´¢å¼•');
                    }

                    const searchIndex = await response.json();
                    const projectProducts = [];

                    // è¿‡æ»¤å‡ºäº§å“é¡µé¢
                    const productPages = searchIndex.filter(page =>
                        page.uri && page.uri.includes('/products/') &&
                        !page.uri.includes('/products/index') &&
                        page.title && page.title.trim() !== ''
                    );

                    productPages.forEach(page => {
                        const productId = page.uri.replace('/products/', '').replace('/', '');

                        projectProducts.push({
                            id: productId,
                            title: page.title || `äº§å“ ${productId}`,
                            model: this.extractModelFromTitle(page.title),
                            series: this.extractSeriesFromTitle(page.title),
                            supplier: this.extractSupplierFromContent(page.content),
                            primary_category: this.extractCategoryFromContent(page.content),
                            secondary_category: 'æ£€æµ‹è®¾å¤‡',
                            status: 'published',
                            published: new Date().toISOString(),
                            summary: page.summary || this.extractSummaryFromContent(page.content),
                            gallery: [
                                { image: `/images/products/${productId}/main.jpg`, alt: `${page.title}ä¸»å›¾`, is_main: true }
                            ],
                            parameters: this.extractParametersFromContent(page.content),
                            application_scenarios: 'é€‚ç”¨äºå·¥ä¸šæ£€æµ‹åœºæ™¯',
                            content: page.content || '',
                            data_download: [],
                            related_products: [],
                            source: 'search-index',
                            uri: page.uri
                        });
                    });

                    return projectProducts;

                } catch (error) {
                    console.error('ä»æœç´¢ç´¢å¼•åŠ è½½äº§å“æ•°æ®å¤±è´¥:', error);
                    return [];
                }
            },

            // ä»æ ‡é¢˜æå–å‹å·
            extractModelFromTitle(title) {
                if (!title) return '';
                const match = title.match(/WS-K\d+[A-Z]?|P\d+|ZB-K\d+/i);
                return match ? match[0] : '';
            },

            // ä»æ ‡é¢˜æå–ç³»åˆ—
            extractSeriesFromTitle(title) {
                if (!title) return 'å…¶ä»–ç³»åˆ—';
                if (title.includes('WS-K')) return 'Kç³»åˆ—';
                if (title.includes('ZB-K')) return 'ZBç³»åˆ—';
                if (title.includes('P')) return 'Pç³»åˆ—';
                return 'å…¶ä»–ç³»åˆ—';
            },

            // ä»å†…å®¹æå–ä¾›åº”å•†
            extractSupplierFromContent(content) {
                if (!content) return 'ç»´æ£®ç§‘æŠ€';
                if (content.includes('æ·±åœ³å¸‚å¾®è§†å…‰ç”µ')) return 'æ·±åœ³å¸‚å¾®è§†å…‰ç”µç§‘æŠ€æœ‰é™å…¬å¸';
                if (content.includes('å¤©æ´¥ç»´æ£®')) return 'å¤©æ´¥ç»´æ£®ç§‘æŠ€æœ‰é™å…¬å¸';
                return 'ç»´æ£®ç§‘æŠ€';
            },

            // ä»å†…å®¹æå–åˆ†ç±»
            extractCategoryFromContent(content) {
                if (!content) return 'å·¥ä¸šå†…çª¥é•œ';
                if (content.includes('ç”µå­å†…çª¥é•œ')) return 'ç”µå­å†…çª¥é•œ';
                if (content.includes('ä¾¿æºå¼')) return 'ä¾¿æºå¼å†…çª¥é•œ';
                if (content.includes('é«˜æ¸…')) return 'é«˜æ¸…å†…çª¥é•œ';
                if (content.includes('å¤šåŠŸèƒ½')) return 'å¤šåŠŸèƒ½å†…çª¥é•œ';
                if (content.includes('çˆ¬è¡Œæœºå™¨äºº')) return 'çˆ¬è¡Œæœºå™¨äºº';
                return 'å·¥ä¸šå†…çª¥é•œ';
            },

            // ä»å†…å®¹æå–æ‘˜è¦
            extractSummaryFromContent(content) {
                if (!content) return 'ä¸“ä¸šçš„å·¥ä¸šæ£€æµ‹è®¾å¤‡';
                const sentences = content.split('ã€‚');
                const firstSentence = sentences[0];
                return firstSentence.length > 100 ? firstSentence.substring(0, 100) + '...' : firstSentence + 'ã€‚';
            },

            // ä»å†…å®¹æå–å‚æ•°
            extractParametersFromContent(content) {
                const defaultParams = [
                    { name: 'æ¢å¤´ç›´å¾„', value: '10mm' },
                    { name: 'å·¥ä½œé•¿åº¦', value: '1000mm' }
                ];

                // è¿™é‡Œå¯ä»¥æ·»åŠ æ›´å¤æ‚çš„å‚æ•°æå–é€»è¾‘
                if (content && content.includes('å‚æ•°')) {
                    // å°è¯•æå–å®é™…å‚æ•°
                    const paramMatches = content.match(/(\d+mm|\d+Â°|\d+x\d+)/g);
                    if (paramMatches) {
                        return paramMatches.slice(0, 4).map((value, index) => ({
                            name: ['æ¢å¤´ç›´å¾„', 'å·¥ä½œé•¿åº¦', 'è§†è§’', 'åˆ†è¾¨ç‡'][index] || 'å‚æ•°',
                            value: value
                        }));
                    }
                }

                return defaultParams;
            },

            // åŠ è½½é¡¹ç›®ä¾›åº”å•†æ•°æ®
            async loadProjectSuppliers() {
                try {
                    // å®é™…é¡¹ç›®ä¸­çš„ä¾›åº”å•†æ–‡ä»¶åˆ—è¡¨
                    const supplierFiles = ['hs-supplier', 'vis', 'vsndt-supplier'];

                    const projectSuppliers = [
                        {
                            id: 'vsndt-supplier',
                            title: 'æ·±åœ³å¸‚å¾®è§†å…‰ç”µç§‘æŠ€æœ‰é™å…¬å¸',
                            address: 'æ·±åœ³å¸‚å—å±±åŒºç§‘æŠ€å›­',
                            type: 'åˆ¶é€ å•†',
                            series: ['Kç³»åˆ—', 'WSç³»åˆ—', 'ZBç³»åˆ—'],
                            models: ['WS-K1010-A', 'WS-K1210-A', 'WS-K1510-A', 'ZB-K3920'],
                            gallery: ['/images/suppliers/vsndt-company.jpg'],
                            contact_person: 'å¼ ç»ç†',
                            position: 'é”€å”®æ€»ç›‘',
                            phone: '0755-12345678',
                            email: 'sales@vsndt.com',
                            description: 'ä¸“ä¸šçš„å·¥ä¸šå†…çª¥é•œåˆ¶é€ å•†ï¼Œæ‹¥æœ‰å¤šå¹´è¡Œä¸šç»éªŒ',
                            source: 'project'
                        },
                        {
                            id: 'vis',
                            title: 'å¤©æ´¥ç»´æ£®ç§‘æŠ€æœ‰é™å…¬å¸',
                            address: 'å¤©æ´¥å¸‚æ»¨æµ·æ–°åŒº',
                            type: 'åˆ¶é€ å•†',
                            series: ['Pç³»åˆ—', 'VISç³»åˆ—'],
                            models: ['P08510', 'P09510', 'P1210', 'P1510'],
                            gallery: ['/images/suppliers/vis-company.jpg'],
                            contact_person: 'æç»ç†',
                            position: 'æŠ€æœ¯æ€»ç›‘',
                            phone: '022-12345678',
                            email: 'info@vis.com',
                            description: 'ä¸“ä¸šçš„æ£€æµ‹è®¾å¤‡åˆ¶é€ å•†',
                            source: 'project'
                        },
                        {
                            id: 'hs-supplier',
                            title: 'åç››æ£€æµ‹è®¾å¤‡æœ‰é™å…¬å¸',
                            address: 'åŒ—äº¬å¸‚æµ·æ·€åŒº',
                            type: 'åˆ¶é€ å•†',
                            series: ['HSç³»åˆ—'],
                            models: ['HS-1000', 'HS-2000'],
                            gallery: ['/images/suppliers/hs-company.jpg'],
                            contact_person: 'ç‹ç»ç†',
                            position: 'é”€å”®ç»ç†',
                            phone: '010-12345678',
                            email: 'sales@hs.com',
                            description: 'ä¸“ä¸šçš„å·¥ä¸šæ£€æµ‹è®¾å¤‡ä¾›åº”å•†',
                            source: 'project'
                        }
                    ];

                    console.log(`ğŸ¢ åŠ è½½é¡¹ç›®ä¾›åº”å•†æ•°æ®: ${projectSuppliers.length} ä¸ªä¾›åº”å•†`);
                    return projectSuppliers;

                } catch (error) {
                    console.error('åŠ è½½é¡¹ç›®ä¾›åº”å•†æ•°æ®å¤±è´¥:', error);
                    return [];
                }
            },

            // åŠ è½½é¡¹ç›®æ¡ˆä¾‹æ•°æ®
            async loadProjectCases() {
                try {
                    // å®é™…é¡¹ç›®ä¸­çš„æ¡ˆä¾‹æ–‡ä»¶åˆ—è¡¨
                    const caseFiles = [
                        'automotive-manufacturing', 'aviation-blade-inspection', 'case-1', 'case-2',
                        'case-3', 'gas-turbine-inspection', 'industrial-pipeline', 'wind-turbine-gearbox'
                    ];

                    const projectCases = caseFiles.map(filename => {
                        let title, category, summary;

                        switch(filename) {
                            case 'automotive-manufacturing':
                                title = 'æ±½è½¦åˆ¶é€ ä¸šæ£€æµ‹æ¡ˆä¾‹';
                                category = 'æ±½è½¦åˆ¶é€ ';
                                summary = 'ä½¿ç”¨å·¥ä¸šå†…çª¥é•œæ£€æµ‹æ±½è½¦å‘åŠ¨æœºå†…éƒ¨ç»“æ„';
                                break;
                            case 'aviation-blade-inspection':
                                title = 'èˆªç©ºå¶ç‰‡æ£€æµ‹æ¡ˆä¾‹';
                                category = 'èˆªç©ºèˆªå¤©';
                                summary = 'èˆªç©ºå‘åŠ¨æœºå¶ç‰‡ç¼ºé™·æ£€æµ‹åº”ç”¨';
                                break;
                            case 'gas-turbine-inspection':
                                title = 'ç‡ƒæ°”è½®æœºæ£€æµ‹æ¡ˆä¾‹';
                                category = 'èƒ½æºç”µåŠ›';
                                summary = 'ç‡ƒæ°”è½®æœºå†…éƒ¨æ£€æµ‹ç»´æŠ¤æ¡ˆä¾‹';
                                break;
                            case 'industrial-pipeline':
                                title = 'å·¥ä¸šç®¡é“æ£€æµ‹æ¡ˆä¾‹';
                                category = 'çŸ³æ²¹åŒ–å·¥';
                                summary = 'å·¥ä¸šç®¡é“å†…éƒ¨ç¼ºé™·æ£€æµ‹';
                                break;
                            case 'wind-turbine-gearbox':
                                title = 'é£åŠ›å‘ç”µæœºé½¿è½®ç®±æ£€æµ‹';
                                category = 'æ–°èƒ½æº';
                                summary = 'é£åŠ›å‘ç”µæœºé½¿è½®ç®±å†…éƒ¨æ£€æµ‹';
                                break;
                            default:
                                title = `${filename.replace(/-/g, ' ')} æ£€æµ‹æ¡ˆä¾‹`;
                                category = 'å·¥ä¸šæ£€æµ‹';
                                summary = `${title}çš„è¯¦ç»†åº”ç”¨è¯´æ˜`;
                        }

                        return {
                            id: filename,
                            title: title,
                            category: category,
                            date: '2024-01-10',
                            summary: summary,
                            content: `${title}çš„è¯¦ç»†æè¿°å’Œåº”ç”¨è¿‡ç¨‹...`,
                            images: [`/images/cases/${filename}.webp`],
                            products_used: ['ws-k1010-a'],
                            source: 'project'
                        };
                    });

                    console.log(`ğŸ“‹ åŠ è½½é¡¹ç›®æ¡ˆä¾‹æ•°æ®: ${projectCases.length} ä¸ªæ¡ˆä¾‹`);
                    return projectCases;

                } catch (error) {
                    console.error('åŠ è½½é¡¹ç›®æ¡ˆä¾‹æ•°æ®å¤±è´¥:', error);
                    return [];
                }
            },

            // åŠ è½½é¡¹ç›®æ–°é—»æ•°æ®
            async loadProjectNews() {
                try {
                    // å®é™…é¡¹ç›®ä¸­çš„æ–°é—»æ–‡ä»¶åˆ—è¡¨
                    const newsFiles = [
                        '2024-01-15-industry-news-example', '2024-01-16-exhibition-news',
                        '2024-01-20-product-launch', '2024-03-14-tech-trends',
                        'exhibition-news-1', 'exhibition-news-2', 'exhibition-news-3', 'exhibition-news-4',
                        'exhibition-news-5', 'exhibition-news-6', 'exhibition-news-7', 'exhibition-news-8',
                        'exhibition-news-9', 'exhibition-news-10', 'exhibition-news-11', 'exhibition-news-12',
                        'industry-news-1', 'industry-news-2', 'industry-news-3', 'industry-news-4', 'industry-news-5',
                        'tech-article-1', 'tech-article-2', 'tech-article-3', 'tech-article-4', 'tech-article-5'
                    ];

                    const projectNews = newsFiles.map(filename => {
                        let title, category, summary;

                        if (filename.includes('exhibition')) {
                            title = `å±•ä¼šèµ„è®¯ - ${filename.replace('exhibition-news-', 'ç¬¬')}æœŸ`;
                            category = 'å±•ä¼šèµ„è®¯';
                            summary = 'æœ€æ–°å±•ä¼šä¿¡æ¯å’Œè¡Œä¸šåŠ¨æ€';
                        } else if (filename.includes('industry')) {
                            title = `è¡Œä¸šèµ„è®¯ - ${filename.replace('industry-news-', 'ç¬¬')}æœŸ`;
                            category = 'è¡Œä¸šèµ„è®¯';
                            summary = 'è¡Œä¸šå‘å±•è¶‹åŠ¿å’Œå¸‚åœºåŠ¨æ€';
                        } else if (filename.includes('tech')) {
                            title = `æŠ€æœ¯æ–‡ç«  - ${filename.replace('tech-article-', 'ç¬¬')}æœŸ`;
                            category = 'æŠ€æœ¯æ–‡ç« ';
                            summary = 'æŠ€æœ¯å‘å±•å’Œåˆ›æ–°åº”ç”¨';
                        } else if (filename.includes('product-launch')) {
                            title = 'æ–°äº§å“å‘å¸ƒ';
                            category = 'ä¼ä¸šæ–°é—»';
                            summary = 'æœ€æ–°äº§å“å‘å¸ƒå’ŒæŠ€æœ¯åˆ›æ–°';
                        } else {
                            title = filename.replace(/-/g, ' ').replace(/\d{4} \d{2} \d{2} /, '');
                            category = 'è¡Œä¸šèµ„è®¯';
                            summary = 'ç›¸å…³æ–°é—»èµ„è®¯';
                        }

                        // æå–æ—¥æœŸ
                        const dateMatch = filename.match(/(\d{4}-\d{2}-\d{2})/);
                        const date = dateMatch ? dateMatch[1] : '2024-01-15';

                        return {
                            id: filename,
                            title: title,
                            category: category,
                            date: date,
                            summary: summary,
                            content: `${title}çš„è¯¦ç»†å†…å®¹...`,
                            featured_image: `/images/news/${filename}.jpeg`,
                            tags: [category, 'å·¥ä¸šæ£€æµ‹'],
                            source: 'project'
                        };
                    });

                    console.log(`ğŸ“° åŠ è½½é¡¹ç›®æ–°é—»æ•°æ®: ${projectNews.length} æ¡æ–°é—»`);
                    return projectNews;

                } catch (error) {
                    console.error('åŠ è½½é¡¹ç›®æ–°é—»æ•°æ®å¤±è´¥:', error);
                    return [];
                }
            },

            // åŠ è½½é¡¹ç›®åº”ç”¨é¢†åŸŸæ•°æ®
            async loadProjectApplications() {
                try {
                    // å®é™…é¡¹ç›®ä¸­çš„åº”ç”¨é¢†åŸŸæ–‡ä»¶åˆ—è¡¨
                    const applicationFiles = ['aerospace', 'automotive', 'casting', 'energy', 'machinery', 'research'];

                    const projectApplications = applicationFiles.map(filename => {
                        let title, description, icon;

                        switch(filename) {
                            case 'aerospace':
                                title = 'èˆªç©ºèˆªå¤©';
                                description = 'èˆªç©ºå‘åŠ¨æœºã€é£æœºéƒ¨ä»¶æ£€æµ‹';
                                icon = 'fas fa-plane';
                                break;
                            case 'automotive':
                                title = 'æ±½è½¦åˆ¶é€ ';
                                description = 'å‘åŠ¨æœºã€å˜é€Ÿç®±ã€åˆ¶åŠ¨ç³»ç»Ÿæ£€æµ‹';
                                icon = 'fas fa-car';
                                break;
                            case 'casting':
                                title = 'é“¸é€ è¡Œä¸š';
                                description = 'é“¸ä»¶å†…éƒ¨ç¼ºé™·æ£€æµ‹';
                                icon = 'fas fa-industry';
                                break;
                            case 'energy':
                                title = 'èƒ½æºç”µåŠ›';
                                description = 'å‘ç”µè®¾å¤‡ã€ç®¡é“æ£€æµ‹';
                                icon = 'fas fa-bolt';
                                break;
                            case 'machinery':
                                title = 'æœºæ¢°åˆ¶é€ ';
                                description = 'æœºæ¢°è®¾å¤‡å†…éƒ¨æ£€æµ‹';
                                icon = 'fas fa-cogs';
                                break;
                            case 'research':
                                title = 'ç§‘ç ”é™¢æ‰€';
                                description = 'ç§‘ç ”è®¾å¤‡å’Œå®éªŒæ£€æµ‹';
                                icon = 'fas fa-microscope';
                                break;
                            default:
                                title = filename;
                                description = `${filename}åº”ç”¨é¢†åŸŸ`;
                                icon = 'fas fa-industry';
                        }

                        return {
                            id: filename,
                            title: title,
                            description: description,
                            icon: icon,
                            image: `/images/applications/${filename}.jpg`,
                            content: `${title}é¢†åŸŸçš„è¯¦ç»†åº”ç”¨ä»‹ç»...`,
                            products: ['ws-k1010-a', 'ws-k1210-a'],
                            cases: ['case-1', 'case-2'],
                            source: 'project'
                        };
                    });

                    console.log(`ğŸ­ åŠ è½½é¡¹ç›®åº”ç”¨é¢†åŸŸæ•°æ®: ${projectApplications.length} ä¸ªåº”ç”¨é¢†åŸŸ`);
                    return projectApplications;

                } catch (error) {
                    console.error('åŠ è½½é¡¹ç›®åº”ç”¨é¢†åŸŸæ•°æ®å¤±è´¥:', error);
                    return [];
                }
            },

            // åˆå¹¶äº§å“æ•°æ®
            mergeProductData(projectProducts, localProducts) {
                const merged = [...projectProducts];

                // æ·»åŠ æœ¬åœ°åˆ›å»ºçš„äº§å“ï¼ˆä¸åœ¨é¡¹ç›®ä¸­çš„ï¼‰
                localProducts.forEach(localProduct => {
                    if (!projectProducts.find(p => p.id === localProduct.id)) {
                        merged.push({ ...localProduct, source: 'local' });
                    }
                });

                return merged;
            },

            // åˆå¹¶ä¾›åº”å•†æ•°æ®
            mergeSupplierData(projectSuppliers, localSuppliers) {
                const merged = [...projectSuppliers];

                localSuppliers.forEach(localSupplier => {
                    if (!projectSuppliers.find(s => s.id === localSupplier.id)) {
                        merged.push({ ...localSupplier, source: 'local' });
                    }
                });

                return merged;
            },

            // åˆå¹¶æ¡ˆä¾‹æ•°æ®
            mergeCaseData(projectCases, localCases) {
                const merged = [...projectCases];

                localCases.forEach(localCase => {
                    if (!projectCases.find(c => c.id === localCase.id)) {
                        merged.push({ ...localCase, source: 'local' });
                    }
                });

                return merged;
            },

            // åˆå¹¶æ–°é—»æ•°æ®
            mergeNewsData(projectNews, localNews) {
                const merged = [...projectNews];

                localNews.forEach(localNewsItem => {
                    if (!projectNews.find(n => n.id === localNewsItem.id)) {
                        merged.push({ ...localNewsItem, source: 'local' });
                    }
                });

                return merged;
            },

            // åˆå¹¶åº”ç”¨é¢†åŸŸæ•°æ®
            mergeApplicationData(projectApplications, localApplications) {
                const merged = [...projectApplications];

                localApplications.forEach(localApplication => {
                    if (!projectApplications.find(a => a.id === localApplication.id)) {
                        merged.push({ ...localApplication, source: 'local' });
                    }
                });

                return merged;
            },

            // æ›´æ–°åŒæ­¥çŠ¶æ€æ˜¾ç¤º
            updateSyncStatus() {
                const statusContainer = document.getElementById('syncStatusContainer');
                if (statusContainer) {
                    const lastSyncTime = new Date().toLocaleString();
                    statusContainer.innerHTML = `
                        <div class="alert alert-success">
                            <i class="fas fa-sync-alt me-2"></i>
                            å†…å®¹åŒæ­¥å®Œæˆ - ${lastSyncTime}
                        </div>
                    `;
                }
            },

            // æ‰‹åŠ¨è§¦å‘åŒæ­¥
            async manualSync() {
                await this.initSync();

                // åˆ·æ–°å½“å‰æ˜¾ç¤ºçš„æ•°æ®
                if (currentSection === 'products') {
                    await showProductsList();
                } else if (currentSection === 'suppliers') {
                    showSuppliers();
                } else if (currentSection === 'cases') {
                    showCases();
                } else if (currentSection === 'news') {
                    showNews();
                } else if (currentSection === 'applications') {
                    showApplications();
                }
            }
        };

        // åª’ä½“åº“ç®¡ç†åŠŸèƒ½
        let selectedMediaFiles = [];
        let currentMediaCallback = null;

        // æ‰“å¼€åª’ä½“åº“é€‰æ‹©å™¨
        function selectFromMediaLibrary(callback) {
            currentMediaCallback = callback;
            selectedMediaFiles = [];
            loadMediaFolder('images/products');
            const modal = new bootstrap.Modal(document.getElementById('mediaLibraryModal'));
            modal.show();
        }

        // åŠ è½½åª’ä½“æ–‡ä»¶å¤¹
        async function loadMediaFolder(folderPath) {
            try {
                // æ¨¡æ‹Ÿåª’ä½“æ–‡ä»¶æ•°æ® - åœ¨å®é™…åº”ç”¨ä¸­è¿™é‡Œåº”è¯¥ä»æœåŠ¡å™¨è·å–
                const mediaFiles = await getMediaFiles(folderPath);
                renderMediaGrid(mediaFiles);

                // æ›´æ–°æ´»åŠ¨æ–‡ä»¶å¤¹
                document.querySelectorAll('#mediaFolderList .list-group-item').forEach(item => {
                    item.classList.remove('active');
                    if (item.dataset.folder === folderPath) {
                        item.classList.add('active');
                    }
                });
            } catch (error) {
                console.error('åŠ è½½åª’ä½“æ–‡ä»¶å¤±è´¥:', error);
                showNotification('åŠ è½½åª’ä½“æ–‡ä»¶å¤±è´¥', 'danger');
            }
        }

        // è·å–åª’ä½“æ–‡ä»¶åˆ—è¡¨ï¼ˆæ¨¡æ‹Ÿæ•°æ®ï¼‰
        async function getMediaFiles(folderPath) {
            // è¿™é‡Œåº”è¯¥æ˜¯å®é™…çš„APIè°ƒç”¨ï¼Œç°åœ¨è¿”å›æ¨¡æ‹Ÿæ•°æ®
            const mockFiles = {
                'images/products': [
                    { name: 'K-main.jpg', path: '/images/products/K-series/K-main.jpg', type: 'image' },
                    { name: 'K-1.jpg', path: '/images/products/K-series/K-1.jpg', type: 'image' },
                    { name: 'K-2.jpg', path: '/images/products/K-series/K-2.jpg', type: 'image' },
                    { name: 'P60-main.jpg', path: '/images/products/P60/P60-main.jpg', type: 'image' },
                    { name: 'DZ-main.jpg', path: '/images/products/DZ/DZ-main.jpg', type: 'image' }
                ],
                'images/cases': [
                    { name: 'case-1.webp', path: '/images/cases/case-1.webp', type: 'image' },
                    { name: 'case-2.webp', path: '/images/cases/case-2.webp', type: 'image' }
                ],
                'images/news': [
                    { name: 'news-1.jpeg', path: '/images/news/news-1.jpeg', type: 'image' },
                    { name: 'news-2.jpeg', path: '/images/news/news-2.jpeg', type: 'image' }
                ],
                'uploads': [
                    { name: 'WS-K1010-spec.pdf', path: '/uploads/WS-K1010-spec.pdf', type: 'file' },
                    { name: 'product-manual.pdf', path: '/uploads/product-manual.pdf', type: 'file' }
                ]
            };

            return mockFiles[folderPath] || [];
        }

        // æ¸²æŸ“åª’ä½“æ–‡ä»¶ç½‘æ ¼
        function renderMediaGrid(files) {
            const grid = document.getElementById('mediaFileGrid');
            grid.innerHTML = '';

            files.forEach(file => {
                const col = document.createElement('div');
                col.className = 'col-md-3 mb-3';

                const isImage = file.type === 'image';
                const isSelected = selectedMediaFiles.some(f => f.path === file.path);

                col.innerHTML = `
                    <div class="media-file-item ${isSelected ? 'selected' : ''}" onclick="toggleMediaSelection('${file.path}', '${file.name}', '${file.type}')">
                        <div class="media-preview">
                            ${isImage ?
                                `<img src="${file.path}" alt="${file.name}" class="img-fluid">` :
                                `<div class="file-icon"><i class="fas fa-file-pdf fa-3x"></i></div>`
                            }
                        </div>
                        <div class="media-info">
                            <small class="text-truncate d-block">${file.name}</small>
                        </div>
                        <div class="selection-indicator">
                            <i class="fas fa-check"></i>
                        </div>
                    </div>
                `;

                grid.appendChild(col);
            });
        }

        // åˆ‡æ¢åª’ä½“æ–‡ä»¶é€‰æ‹©çŠ¶æ€
        function toggleMediaSelection(path, name, type) {
            const existingIndex = selectedMediaFiles.findIndex(f => f.path === path);

            if (existingIndex > -1) {
                selectedMediaFiles.splice(existingIndex, 1);
            } else {
                selectedMediaFiles.push({ path, name, type });
            }

            // æ›´æ–°UI
            const item = document.querySelector(`[onclick*="${path}"]`);
            if (item) {
                item.classList.toggle('selected');
            }

            // æ›´æ–°é€‰æ‹©æŒ‰é’®çŠ¶æ€
            const selectBtn = document.getElementById('selectMediaBtn');
            selectBtn.disabled = selectedMediaFiles.length === 0;
            selectBtn.textContent = selectedMediaFiles.length > 0 ?
                `é€‰æ‹©æ–‡ä»¶ (${selectedMediaFiles.length})` : 'é€‰æ‹©æ–‡ä»¶';
        }

        // ç¡®è®¤åª’ä½“é€‰æ‹©
        function confirmMediaSelection() {
            if (selectedMediaFiles.length > 0 && currentMediaCallback) {
                currentMediaCallback(selectedMediaFiles);
            }

            const modal = bootstrap.Modal.getInstance(document.getElementById('mediaLibraryModal'));
            modal.hide();

            selectedMediaFiles = [];
            currentMediaCallback = null;
        }

        // å›¾åº“ç®¡ç†åŠŸèƒ½
        function addGalleryImage() {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = 'image/*';
            input.multiple = true;
            input.onchange = function(e) {
                const files = Array.from(e.target.files);
                files.forEach(file => {
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        addImageToGallery(e.target.result, file.name, true);
                    };
                    reader.readAsDataURL(file);
                });
            };
            input.click();
        }

        // ä»åª’ä½“åº“é€‰æ‹©å›¾ç‰‡
        function selectFromMediaLibrary() {
            selectFromMediaLibrary((selectedFiles) => {
                selectedFiles.forEach(file => {
                    if (file.type === 'image') {
                        addImageToGallery(file.path, file.name, false);
                    }
                });
            });
        }

        // æ·»åŠ å›¾ç‰‡åˆ°å›¾åº“
        function addImageToGallery(src, alt, isNewUpload = false) {
            const container = document.getElementById('galleryContainer');
            const addButton = container.querySelector('.image-upload-area').parentElement;

            const col = document.createElement('div');
            col.className = 'col-md-3 mb-3';
            col.innerHTML = `
                <div class="gallery-image-item">
                    <img src="${src}" alt="${alt}" class="img-fluid">
                    <div class="image-controls">
                        <button type="button" class="btn btn-sm btn-outline-primary" onclick="setAsMainImage(this)" title="è®¾ä¸ºä¸»å›¾">
                            <i class="fas fa-star"></i>
                        </button>
                        <button type="button" class="btn btn-sm btn-outline-danger" onclick="removeGalleryImage(this)" title="åˆ é™¤">
                            <i class="fas fa-trash"></i>
                        </button>
                    </div>
                    <div class="image-info">
                        <input type="text" class="form-control form-control-sm" value="${alt}" placeholder="å›¾ç‰‡æè¿°" onchange="updateImageAlt(this)">
                        <div class="form-check mt-1">
                            <input class="form-check-input" type="checkbox" ${isNewUpload ? '' : ''} onchange="markAsNewUpload(this)">
                            <label class="form-check-label">
                                <small>æ–°ä¸Šä¼ </small>
                            </label>
                        </div>
                    </div>
                </div>
            `;

            container.insertBefore(col, addButton);
        }

        // è®¾ç½®ä¸ºä¸»å›¾
        function setAsMainImage(button) {
            // ç§»é™¤å…¶ä»–ä¸»å›¾æ ‡è®°
            document.querySelectorAll('.gallery-image-item').forEach(item => {
                item.classList.remove('main-image');
                const starBtn = item.querySelector('.btn-outline-primary, .btn-primary, .btn-warning, .btn-outline-warning');
                if (starBtn && starBtn.querySelector('.fa-star')) {
                    starBtn.innerHTML = '<i class="fas fa-star"></i>';
                    starBtn.classList.remove('btn-primary', 'btn-warning');
                    starBtn.classList.add('btn-outline-primary');
                }
            });

            // è®¾ç½®å½“å‰ä¸ºä¸»å›¾
            const imageItem = button.closest('.gallery-image-item');
            imageItem.classList.add('main-image');
            button.innerHTML = '<i class="fas fa-star"></i>';
            button.classList.remove('btn-outline-primary', 'btn-primary', 'btn-outline-warning');
            button.classList.add('btn-warning');
        }

        // åˆ é™¤å›¾åº“å›¾ç‰‡
        function removeGalleryImage(button) {
            const col = button.closest('.col-md-3');
            col.remove();
        }

        // æ›´æ–°å›¾ç‰‡æè¿°
        function updateImageAlt(input) {
            const img = input.closest('.gallery-image-item').querySelector('img');
            img.alt = input.value;
        }

        // æ ‡è®°ä¸ºæ–°ä¸Šä¼ 
        function markAsNewUpload(checkbox) {
            const imageItem = checkbox.closest('.gallery-image-item');
            imageItem.dataset.newUpload = checkbox.checked;
        }

        // æ˜¾ç¤ºå›¾ç‰‡åœ°å€
        function showImageAddress(button) {
            const imageItem = button.closest('.gallery-image-item');
            const addressDiv = imageItem.querySelector('.image-address');
            const srcInput = imageItem.querySelector('.image-src');

            if (addressDiv.style.display === 'none') {
                addressDiv.style.display = 'block';
                button.classList.remove('btn-outline-info');
                button.classList.add('btn-info');
                button.title = 'éšè—åœ°å€';
            } else {
                addressDiv.style.display = 'none';
                button.classList.remove('btn-info');
                button.classList.add('btn-outline-info');
                button.title = 'æŸ¥çœ‹åœ°å€';
            }
        }

        // åˆ‡æ¢å›¾ç‰‡æ˜¾ç¤ºæ¨¡å¼ï¼ˆå›¾ç‰‡/åœ°å€ï¼‰
        function toggleImageDisplay(element) {
            const imageItem = element.closest('.gallery-image-item');
            const addressDiv = imageItem.querySelector('.image-address');

            if (addressDiv.style.display === 'none') {
                showImageAddress(imageItem.querySelector('.btn-outline-info, .btn-info'));
            } else {
                showImageAddress(imageItem.querySelector('.btn-outline-info, .btn-info'));
            }
        }

        // è·å–å›¾åº“æ•°æ®
        function getGalleryData() {
            const galleryItems = document.querySelectorAll('.gallery-image-item');
            const gallery = [];

            galleryItems.forEach((item, index) => {
                const img = item.querySelector('img');
                const srcInput = item.querySelector('.image-src');
                const altInput = item.querySelector('input[type="text"]');
                const isMain = item.classList.contains('main-image');
                const isNewUpload = item.querySelector('input[type="checkbox"]').checked;

                // ä¼˜å…ˆä½¿ç”¨éšè—è¾“å…¥æ¡†ä¸­çš„åœ°å€ï¼Œå…¶æ¬¡ä½¿ç”¨imgçš„src
                const imageSrc = srcInput ? srcInput.value : (img ? img.src : '');

                if (imageSrc) {
                    gallery.push({
                        image: imageSrc,
                        alt: altInput.value || `äº§å“å›¾ç‰‡${index + 1}`,
                        is_main: isMain,
                        is_new_upload: isNewUpload
                    });
                }
            });

            return gallery;
        }

        // æ–‡ä»¶ç®¡ç†åŠŸèƒ½
        function processProductFiles(productData) {
            // å¤„ç†å›¾åº“ä¸­çš„æ–°ä¸Šä¼ æ–‡ä»¶
            if (productData.gallery) {
                productData.gallery.forEach((img, index) => {
                    if (img.is_new_upload && img.image.startsWith('data:')) {
                        // è¿™æ˜¯ä¸€ä¸ªæ–°ä¸Šä¼ çš„base64å›¾ç‰‡ï¼Œéœ€è¦ä¿å­˜åˆ°æŒ‡å®šç›®å½•
                        const fileName = `${productData.model || productData.id}-${index + 1}.jpg`;
                        const targetPath = `/images/products/${productData.series || 'general'}/${fileName}`;

                        // åœ¨å®é™…åº”ç”¨ä¸­ï¼Œè¿™é‡Œåº”è¯¥è°ƒç”¨APIä¿å­˜æ–‡ä»¶
                        // ç°åœ¨æˆ‘ä»¬åªæ˜¯æ›´æ–°è·¯å¾„
                        img.image = targetPath;
                        img.is_new_upload = false;

                        console.log(`å›¾ç‰‡å°†ä¿å­˜åˆ°: ${targetPath}`);
                    }
                });
            }

            // å¤„ç†èµ„æ–™ä¸‹è½½ä¸­çš„æ–°ä¸Šä¼ æ–‡ä»¶
            if (productData.data_download) {
                productData.data_download.forEach((download, index) => {
                    if (download.is_new_upload && download.file_path.startsWith('data:')) {
                        // è¿™æ˜¯ä¸€ä¸ªæ–°ä¸Šä¼ çš„æ–‡ä»¶
                        const fileName = `${productData.model || productData.id}-${download.file_title}.pdf`;
                        const targetPath = `/uploads/products/${fileName}`;

                        // åœ¨å®é™…åº”ç”¨ä¸­ï¼Œè¿™é‡Œåº”è¯¥è°ƒç”¨APIä¿å­˜æ–‡ä»¶
                        download.file_path = targetPath;
                        download.is_new_upload = false;

                        console.log(`æ–‡ä»¶å°†ä¿å­˜åˆ°: ${targetPath}`);
                    }
                });
            }

            return productData;
        }

        // å¤åˆ¶äº§å“æ—¶çš„æ–‡ä»¶å¤„ç†
        function copyProductFiles(originalProduct, newProduct) {
            // å¤åˆ¶å›¾åº“æ–‡ä»¶
            if (originalProduct.gallery) {
                newProduct.gallery = originalProduct.gallery.map((img, index) => {
                    const newFileName = img.image.replace(
                        originalProduct.model || originalProduct.id,
                        newProduct.model || newProduct.id
                    );

                    return {
                        ...img,
                        image: newFileName,
                        is_new_upload: true // æ ‡è®°ä¸ºéœ€è¦å¤åˆ¶çš„æ–‡ä»¶
                    };
                });
            }

            // å¤åˆ¶èµ„æ–™ä¸‹è½½æ–‡ä»¶
            if (originalProduct.data_download) {
                newProduct.data_download = originalProduct.data_download.map(download => {
                    const newFileName = download.file_path.replace(
                        originalProduct.model || originalProduct.id,
                        newProduct.model || newProduct.id
                    );

                    return {
                        ...download,
                        file_path: newFileName,
                        is_new_upload: true // æ ‡è®°ä¸ºéœ€è¦å¤åˆ¶çš„æ–‡ä»¶
                    };
                });
            }

            return newProduct;
        }

        // æ³¨é‡Šç»“æŸ
        */

        // æ·»åŠ åŸºæœ¬çš„èœå•åŠŸèƒ½
        function showProductsList() {
            console.log('ğŸ“¦ æ˜¾ç¤ºäº§å“åˆ—è¡¨');
            const contentTitle = document.getElementById('contentTitle');
            const contentSubtitle = document.getElementById('contentSubtitle');
            const contentBody = document.getElementById('contentBody');
            const contentActions = document.getElementById('contentActions');

            if (contentTitle) contentTitle.textContent = 'äº§å“ç®¡ç†';
            if (contentSubtitle) contentSubtitle.textContent = 'ç®¡ç†äº§å“ä¿¡æ¯ï¼ŒåŒ…æ‹¬äº§å“è¯¦æƒ…ã€æŠ€æœ¯å‚æ•°ã€ä¾›åº”å•†ç­‰';

            // æ·»åŠ æ“ä½œæŒ‰é’®
            if (contentActions) {
                contentActions.innerHTML = `
                    <button class="btn btn-primary" onclick="addProduct()">
                        <i class="fas fa-plus me-1"></i>æ·»åŠ äº§å“
                    </button>
                    <button class="btn btn-success" onclick="loadProductsFromProject()">
                        <i class="fas fa-sync me-1"></i>ä»é¡¹ç›®åŒæ­¥
                    </button>
                    <button class="btn btn-info" onclick="exportProducts()">
                        <i class="fas fa-download me-1"></i>å¯¼å‡ºæ•°æ®
                    </button>
                `;
            }

            if (contentBody) {
                contentBody.innerHTML = `
                    <div class="row mb-3">
                        <div class="col-md-6">
                            <input type="text" class="form-control" placeholder="æœç´¢äº§å“..." id="productSearch">
                        </div>
                        <div class="col-md-3">
                            <select class="form-select" id="categoryFilter">
                                <option value="">æ‰€æœ‰åˆ†ç±»</option>
                                <option value="ç”µå­å†…çª¥é•œ">ç”µå­å†…çª¥é•œ</option>
                                <option value="å…‰çº¤å†…çª¥é•œ">å…‰çº¤å†…çª¥é•œ</option>
                                <option value="å·¥ä¸šå†…çª¥é•œ">å·¥ä¸šå†…çª¥é•œ</option>
                            </select>
                        </div>
                        <div class="col-md-3">
                            <select class="form-select" id="statusFilter">
                                <option value="">æ‰€æœ‰çŠ¶æ€</option>
                                <option value="published">å·²å‘å¸ƒ</option>
                                <option value="draft">è‰ç¨¿</option>
                            </select>
                        </div>
                    </div>

                    <div class="card">
                        <div class="card-body">
                            <div id="productTableContainer">
                                <div class="text-center py-4">
                                    <div class="spinner-border text-primary" role="status">
                                        <span class="visually-hidden">åŠ è½½ä¸­...</span>
                                    </div>
                                    <p class="mt-2">æ­£åœ¨åŠ è½½äº§å“æ•°æ®...</p>
                                </div>
                            </div>
                        </div>
                    </div>
                `;

                // æ¨¡æ‹ŸåŠ è½½äº§å“æ•°æ®
                setTimeout(() => {
                    loadProductTable();
                }, 1000);
            }

            // è®¾ç½®èœå•é¡¹ä¸ºæ´»åŠ¨çŠ¶æ€
            document.querySelectorAll('.sidebar-item').forEach(item => item.classList.remove('active'));
            const productMenuItem = document.querySelector('.sidebar-item[onclick*="showProductsList"]');
            if (productMenuItem) productMenuItem.classList.add('active');
        }

        function showNewsList() {
            console.log('ğŸ“° æ˜¾ç¤ºèµ„è®¯åˆ—è¡¨');
            const contentTitle = document.getElementById('contentTitle');
            const contentSubtitle = document.getElementById('contentSubtitle');
            const contentBody = document.getElementById('contentBody');
            const contentActions = document.getElementById('contentActions');

            if (contentTitle) contentTitle.textContent = 'èµ„è®¯ç®¡ç†';
            if (contentSubtitle) contentSubtitle.textContent = 'ç®¡ç†ç½‘ç«™æ–°é—»èµ„è®¯å†…å®¹';

            // æ·»åŠ æ“ä½œæŒ‰é’®
            if (contentActions) {
                contentActions.innerHTML = `
                    <button class="btn btn-primary" onclick="addNews()">
                        <i class="fas fa-plus me-1"></i>æ·»åŠ èµ„è®¯
                    </button>
                    <button class="btn btn-success" onclick="loadNewsFromProject()">
                        <i class="fas fa-sync me-1"></i>ä»é¡¹ç›®åŒæ­¥
                    </button>
                    <button class="btn btn-info" onclick="exportNews()">
                        <i class="fas fa-download me-1"></i>å¯¼å‡ºæ•°æ®
                    </button>
                `;
            }

            if (contentBody) {
                // ä½¿ç”¨çœŸå®çš„é¡¹ç›®èµ„è®¯æ•°æ®
                const news = projectData.news;

                contentBody.innerHTML = `
                    <div class="row mb-3">
                        <div class="col-md-6">
                            <input type="text" class="form-control" placeholder="æœç´¢èµ„è®¯..." id="newsSearch">
                        </div>
                        <div class="col-md-3">
                            <select class="form-select" id="newsCategoryFilter">
                                <option value="">æ‰€æœ‰åˆ†ç±»</option>
                                <option value="è¡Œä¸šåŠ¨æ€">è¡Œä¸šåŠ¨æ€</option>
                                <option value="å±•ä¼šä¿¡æ¯">å±•ä¼šä¿¡æ¯</option>
                                <option value="äº§å“å‘å¸ƒ">äº§å“å‘å¸ƒ</option>
                            </select>
                        </div>
                        <div class="col-md-3">
                            <select class="form-select" id="newsStatusFilter">
                                <option value="">æ‰€æœ‰çŠ¶æ€</option>
                                <option value="published">å·²å‘å¸ƒ</option>
                                <option value="draft">è‰ç¨¿</option>
                            </select>
                        </div>
                    </div>

                    <div class="card">
                        <div class="card-body">
                            <div class="table-responsive">
                                <table class="table table-hover">
                                    <thead class="table-light">
                                        <tr>
                                            <th>æ ‡é¢˜</th>
                                            <th>åˆ†ç±»</th>
                                            <th>ä½œè€…</th>
                                            <th>çŠ¶æ€</th>
                                            <th>æµè§ˆé‡</th>
                                            <th>å‘å¸ƒæ—¶é—´</th>
                                            <th>æ“ä½œ</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        ${news.map(newsItem => `
                                            <tr>
                                                <td>
                                                    <div class="fw-bold">${newsItem.title}</div>
                                                    <small class="text-muted">ID: ${newsItem.id}</small>
                                                </td>
                                                <td><span class="badge bg-info">${newsItem.category}</span></td>
                                                <td>${newsItem.author}</td>
                                                <td>
                                                    <span class="badge ${newsItem.status === 'published' ? 'bg-success' : 'bg-warning'}">
                                                        ${newsItem.status === 'published' ? 'å·²å‘å¸ƒ' : 'è‰ç¨¿'}
                                                    </span>
                                                </td>
                                                <td>${newsItem.views}</td>
                                                <td><small>${newsItem.date}</small></td>
                                                <td>
                                                    <div class="btn-group btn-group-sm">
                                                        <button class="btn btn-outline-primary" onclick="viewNews('${newsItem.id}')" title="æŸ¥çœ‹">
                                                            <i class="fas fa-eye"></i>
                                                        </button>
                                                        <button class="btn btn-outline-success" onclick="editNews('${newsItem.id}')" title="ç¼–è¾‘">
                                                            <i class="fas fa-edit"></i>
                                                        </button>
                                                        <button class="btn btn-outline-danger" onclick="deleteNews('${newsItem.id}')" title="åˆ é™¤">
                                                            <i class="fas fa-trash"></i>
                                                        </button>
                                                    </div>
                                                </td>
                                            </tr>
                                        `).join('')}
                                    </tbody>
                                </table>
                            </div>

                            <div class="d-flex justify-content-between align-items-center mt-3">
                                <div>
                                    <small class="text-muted">æ˜¾ç¤º ${news.length} ç¯‡èµ„è®¯</small>
                                </div>
                                <nav>
                                    <ul class="pagination pagination-sm mb-0">
                                        <li class="page-item disabled">
                                            <span class="page-link">ä¸Šä¸€é¡µ</span>
                                        </li>
                                        <li class="page-item active">
                                            <span class="page-link">1</span>
                                        </li>
                                        <li class="page-item disabled">
                                            <span class="page-link">ä¸‹ä¸€é¡µ</span>
                                        </li>
                                    </ul>
                                </nav>
                            </div>
                        </div>
                    </div>
                `;
            }

            // è®¾ç½®èœå•é¡¹ä¸ºæ´»åŠ¨çŠ¶æ€
            document.querySelectorAll('.sidebar-item').forEach(item => item.classList.remove('active'));
            const newsMenuItem = document.querySelector('.sidebar-item[onclick*="showNewsList"]');
            if (newsMenuItem) newsMenuItem.classList.add('active');
        }

        function showCasesList() {
            console.log('ğŸ’¼ æ˜¾ç¤ºæ¡ˆä¾‹åˆ—è¡¨');
            const contentTitle = document.getElementById('contentTitle');
            const contentSubtitle = document.getElementById('contentSubtitle');
            const contentBody = document.getElementById('contentBody');
            const contentActions = document.getElementById('contentActions');

            if (contentTitle) contentTitle.textContent = 'æ¡ˆä¾‹ç®¡ç†';
            if (contentSubtitle) contentSubtitle.textContent = 'ç®¡ç†åº”ç”¨æ¡ˆä¾‹å’ŒæˆåŠŸæ•…äº‹';

            // æ·»åŠ æ“ä½œæŒ‰é’®
            if (contentActions) {
                contentActions.innerHTML = `
                    <button class="btn btn-primary" onclick="addCase()">
                        <i class="fas fa-plus me-1"></i>æ·»åŠ æ¡ˆä¾‹
                    </button>
                    <button class="btn btn-success" onclick="loadCasesFromProject()">
                        <i class="fas fa-sync me-1"></i>ä»é¡¹ç›®åŒæ­¥
                    </button>
                    <button class="btn btn-info" onclick="exportCases()">
                        <i class="fas fa-download me-1"></i>å¯¼å‡ºæ•°æ®
                    </button>
                `;
            }

            if (contentBody) {
                // ä½¿ç”¨çœŸå®çš„é¡¹ç›®æ¡ˆä¾‹æ•°æ®
                const cases = projectData.cases;

                contentBody.innerHTML = `
                    <div class="row mb-3">
                        <div class="col-md-6">
                            <input type="text" class="form-control" placeholder="æœç´¢æ¡ˆä¾‹..." id="caseSearch">
                        </div>
                        <div class="col-md-3">
                            <select class="form-select" id="caseCategoryFilter">
                                <option value="">æ‰€æœ‰åˆ†ç±»</option>
                                <option value="å·¥ä¸šæ£€æµ‹">å·¥ä¸šæ£€æµ‹</option>
                                <option value="æ±½è½¦åˆ¶é€ ">æ±½è½¦åˆ¶é€ </option>
                                <option value="èˆªç©ºèˆªå¤©">èˆªç©ºèˆªå¤©</option>
                                <option value="èƒ½æºç”µåŠ›">èƒ½æºç”µåŠ›</option>
                            </select>
                        </div>
                        <div class="col-md-3">
                            <select class="form-select" id="caseStatusFilter">
                                <option value="">æ‰€æœ‰çŠ¶æ€</option>
                                <option value="published">å·²å‘å¸ƒ</option>
                                <option value="draft">è‰ç¨¿</option>
                            </select>
                        </div>
                    </div>

                    <div class="card">
                        <div class="card-body">
                            <div class="table-responsive">
                                <table class="table table-hover">
                                    <thead class="table-light">
                                        <tr>
                                            <th>æ¡ˆä¾‹æ ‡é¢˜</th>
                                            <th>åˆ†ç±»</th>
                                            <th>è¡Œä¸š</th>
                                            <th>çŠ¶æ€</th>
                                            <th>å‘å¸ƒæ—¶é—´</th>
                                            <th>æ“ä½œ</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        ${cases.map(caseItem => `
                                            <tr>
                                                <td>
                                                    <div class="fw-bold">${caseItem.title}</div>
                                                    <small class="text-muted">ID: ${caseItem.id}</small>
                                                </td>
                                                <td><span class="badge bg-warning">${caseItem.category}</span></td>
                                                <td>${caseItem.industry}</td>
                                                <td>
                                                    <span class="badge ${caseItem.status === 'published' ? 'bg-success' : 'bg-warning'}">
                                                        ${caseItem.status === 'published' ? 'å·²å‘å¸ƒ' : 'è‰ç¨¿'}
                                                    </span>
                                                </td>
                                                <td><small>${caseItem.date}</small></td>
                                                <td>
                                                    <div class="btn-group btn-group-sm">
                                                        <button class="btn btn-outline-primary" onclick="viewCase('${caseItem.id}')" title="æŸ¥çœ‹">
                                                            <i class="fas fa-eye"></i>
                                                        </button>
                                                        <button class="btn btn-outline-success" onclick="editCase('${caseItem.id}')" title="ç¼–è¾‘">
                                                            <i class="fas fa-edit"></i>
                                                        </button>
                                                        <button class="btn btn-outline-danger" onclick="deleteCase('${caseItem.id}')" title="åˆ é™¤">
                                                            <i class="fas fa-trash"></i>
                                                        </button>
                                                    </div>
                                                </td>
                                            </tr>
                                        `).join('')}
                                    </tbody>
                                </table>
                            </div>

                            <div class="d-flex justify-content-between align-items-center mt-3">
                                <div>
                                    <small class="text-muted">æ˜¾ç¤º ${cases.length} ä¸ªæ¡ˆä¾‹</small>
                                </div>
                                <nav>
                                    <ul class="pagination pagination-sm mb-0">
                                        <li class="page-item disabled">
                                            <span class="page-link">ä¸Šä¸€é¡µ</span>
                                        </li>
                                        <li class="page-item active">
                                            <span class="page-link">1</span>
                                        </li>
                                        <li class="page-item disabled">
                                            <span class="page-link">ä¸‹ä¸€é¡µ</span>
                                        </li>
                                    </ul>
                                </nav>
                            </div>
                        </div>
                    </div>
                `;
            }

            // è®¾ç½®èœå•é¡¹ä¸ºæ´»åŠ¨çŠ¶æ€
            document.querySelectorAll('.sidebar-item').forEach(item => item.classList.remove('active'));
            const casesMenuItem = document.querySelector('.sidebar-item[onclick*="showCasesList"]');
            if (casesMenuItem) casesMenuItem.classList.add('active');
        }

        function toggleSection(sectionId) {
            console.log('ğŸ”„ åˆ‡æ¢èŠ‚:', sectionId);
            const section = document.getElementById(sectionId + '-section');
            if (section) {
                section.classList.toggle('collapsed');

                const header = section.previousElementSibling;
                if (header) {
                    const icon = header.querySelector('i.fa-chevron-down, i.fa-chevron-up');
                    if (icon) {
                        if (section.classList.contains('collapsed')) {
                            icon.className = 'fas fa-chevron-up';
                        } else {
                            icon.className = 'fas fa-chevron-down';
                        }
                    }
                }
            }
        }

        // æ·»åŠ å…¶ä»–åŸºæœ¬åŠŸèƒ½
        function showProductCategories() {
            console.log('ğŸ·ï¸ æ˜¾ç¤ºäº§å“åˆ†ç±»');
            const contentTitle = document.getElementById('contentTitle');
            const contentSubtitle = document.getElementById('contentSubtitle');
            const contentBody = document.getElementById('contentBody');
            const contentActions = document.getElementById('contentActions');

            if (contentTitle) contentTitle.textContent = 'äº§å“åˆ†ç±»ç®¡ç†';
            if (contentSubtitle) contentSubtitle.textContent = 'ç®¡ç†äº§å“åˆ†ç±»å’Œå±‚çº§ç»“æ„';

            // æ·»åŠ æ“ä½œæŒ‰é’®
            if (contentActions) {
                contentActions.innerHTML = `
                    <button class="btn btn-primary" onclick="addCategory()">
                        <i class="fas fa-plus me-1"></i>æ·»åŠ åˆ†ç±»
                    </button>
                    <button class="btn btn-success" onclick="refreshCategories()">
                        <i class="fas fa-sync me-1"></i>åˆ·æ–°åˆ†ç±»
                    </button>
                    <button class="btn btn-info" onclick="exportCategories()">
                        <i class="fas fa-download me-1"></i>å¯¼å‡ºæ•°æ®
                    </button>
                `;
            }

            if (contentBody) {
                const categories = projectData.categories;

                contentBody.innerHTML = `
                    <div class="row mb-3">
                        <div class="col-md-8">
                            <input type="text" class="form-control" placeholder="æœç´¢åˆ†ç±»..." id="categorySearch">
                        </div>
                        <div class="col-md-4">
                            <select class="form-select" id="categoryStatusFilter">
                                <option value="">æ‰€æœ‰çŠ¶æ€</option>
                                <option value="active">å¯ç”¨</option>
                                <option value="inactive">ç¦ç”¨</option>
                            </select>
                        </div>
                    </div>

                    <div class="card">
                        <div class="card-body">
                            <div class="table-responsive">
                                <table class="table table-hover">
                                    <thead class="table-light">
                                        <tr>
                                            <th>åˆ†ç±»åç§°</th>
                                            <th>äº§å“æ•°é‡</th>
                                            <th>çŠ¶æ€</th>
                                            <th>åˆ›å»ºæ—¶é—´</th>
                                            <th>æ“ä½œ</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        ${categories.map(category => `
                                            <tr>
                                                <td>
                                                    <div class="d-flex align-items-center">
                                                        <div class="category-icon me-2">
                                                            <i class="fas fa-tag text-primary"></i>
                                                        </div>
                                                        <div>
                                                            <div class="fw-bold">${category.name}</div>
                                                            <small class="text-muted">ID: ${category.id}</small>
                                                        </div>
                                                    </div>
                                                </td>
                                                <td>
                                                    <span class="badge bg-primary">${category.products} ä¸ªäº§å“</span>
                                                </td>
                                                <td>
                                                    <span class="badge ${category.status === 'active' ? 'bg-success' : 'bg-secondary'}">
                                                        ${category.status === 'active' ? 'å¯ç”¨' : 'ç¦ç”¨'}
                                                    </span>
                                                </td>
                                                <td><small>${category.date}</small></td>
                                                <td>
                                                    <div class="btn-group btn-group-sm">
                                                        <button class="btn btn-outline-primary" onclick="viewCategory('${category.id}')" title="æŸ¥çœ‹">
                                                            <i class="fas fa-eye"></i>
                                                        </button>
                                                        <button class="btn btn-outline-success" onclick="editCategory('${category.id}')" title="ç¼–è¾‘">
                                                            <i class="fas fa-edit"></i>
                                                        </button>
                                                        <button class="btn btn-outline-danger" onclick="deleteCategory('${category.id}')" title="åˆ é™¤">
                                                            <i class="fas fa-trash"></i>
                                                        </button>
                                                    </div>
                                                </td>
                                            </tr>
                                        `).join('')}
                                    </tbody>
                                </table>
                            </div>

                            <div class="d-flex justify-content-between align-items-center mt-3">
                                <div>
                                    <small class="text-muted">æ˜¾ç¤º ${categories.length} ä¸ªåˆ†ç±»</small>
                                </div>
                                <nav>
                                    <ul class="pagination pagination-sm mb-0">
                                        <li class="page-item disabled">
                                            <span class="page-link">ä¸Šä¸€é¡µ</span>
                                        </li>
                                        <li class="page-item active">
                                            <span class="page-link">1</span>
                                        </li>
                                        <li class="page-item disabled">
                                            <span class="page-link">ä¸‹ä¸€é¡µ</span>
                                        </li>
                                    </ul>
                                </nav>
                            </div>
                        </div>
                    </div>
                `;
            }

            // è®¾ç½®èœå•é¡¹ä¸ºæ´»åŠ¨çŠ¶æ€
            document.querySelectorAll('.sidebar-item').forEach(item => item.classList.remove('active'));
            const categoryMenuItem = document.querySelector('.sidebar-item[onclick*="showProductCategories"]');
            if (categoryMenuItem) categoryMenuItem.classList.add('active');
        }

        function showSuppliers() {
            console.log('ğŸ¢ æ˜¾ç¤ºä¾›åº”å•†');
            const contentTitle = document.getElementById('contentTitle');
            const contentSubtitle = document.getElementById('contentSubtitle');
            const contentBody = document.getElementById('contentBody');
            const contentActions = document.getElementById('contentActions');

            if (contentTitle) contentTitle.textContent = 'ä¾›åº”å•†ç®¡ç†';
            if (contentSubtitle) contentSubtitle.textContent = 'ç®¡ç†ä¾›åº”å•†ä¿¡æ¯å’Œåˆä½œå…³ç³»';

            // æ·»åŠ æ“ä½œæŒ‰é’®
            if (contentActions) {
                contentActions.innerHTML = `
                    <button class="btn btn-primary" onclick="addSupplier()">
                        <i class="fas fa-plus me-1"></i>æ·»åŠ ä¾›åº”å•†
                    </button>
                    <button class="btn btn-success" onclick="refreshSuppliers()">
                        <i class="fas fa-sync me-1"></i>åˆ·æ–°æ•°æ®
                    </button>
                    <button class="btn btn-info" onclick="exportSuppliers()">
                        <i class="fas fa-download me-1"></i>å¯¼å‡ºæ•°æ®
                    </button>
                `;
            }

            if (contentBody) {
                const suppliers = projectData.suppliers;

                contentBody.innerHTML = `
                    <div class="row mb-3">
                        <div class="col-md-6">
                            <input type="text" class="form-control" placeholder="æœç´¢ä¾›åº”å•†..." id="supplierSearch">
                        </div>
                        <div class="col-md-3">
                            <select class="form-select" id="supplierTypeFilter">
                                <option value="">æ‰€æœ‰ç±»å‹</option>
                                <option value="åˆ¶é€ å•†">åˆ¶é€ å•†</option>
                                <option value="ä»£ç†å•†">ä»£ç†å•†</option>
                                <option value="æœåŠ¡å•†">æœåŠ¡å•†</option>
                            </select>
                        </div>
                        <div class="col-md-3">
                            <select class="form-select" id="supplierStatusFilter">
                                <option value="">æ‰€æœ‰çŠ¶æ€</option>
                                <option value="active">åˆä½œä¸­</option>
                                <option value="inactive">å·²åœæ­¢</option>
                            </select>
                        </div>
                    </div>

                    <div class="card">
                        <div class="card-body">
                            <div class="table-responsive">
                                <table class="table table-hover">
                                    <thead class="table-light">
                                        <tr>
                                            <th>ä¾›åº”å•†åç§°</th>
                                            <th>ç±»å‹</th>
                                            <th>äº§å“æ•°é‡</th>
                                            <th>çŠ¶æ€</th>
                                            <th>åˆä½œæ—¶é—´</th>
                                            <th>æ“ä½œ</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        ${suppliers.map(supplier => `
                                            <tr>
                                                <td>
                                                    <div class="d-flex align-items-center">
                                                        <div class="supplier-icon me-2">
                                                            <i class="fas fa-building text-success"></i>
                                                        </div>
                                                        <div>
                                                            <div class="fw-bold">${supplier.name}</div>
                                                            <small class="text-muted">ID: ${supplier.id}</small>
                                                        </div>
                                                    </div>
                                                </td>
                                                <td><span class="badge bg-info">${supplier.type}</span></td>
                                                <td>
                                                    <span class="badge bg-primary">${supplier.products} ä¸ªäº§å“</span>
                                                </td>
                                                <td>
                                                    <span class="badge ${supplier.status === 'active' ? 'bg-success' : 'bg-secondary'}">
                                                        ${supplier.status === 'active' ? 'åˆä½œä¸­' : 'å·²åœæ­¢'}
                                                    </span>
                                                </td>
                                                <td><small>${supplier.date}</small></td>
                                                <td>
                                                    <div class="btn-group btn-group-sm">
                                                        <button class="btn btn-outline-primary" onclick="viewSupplier('${supplier.id}')" title="æŸ¥çœ‹">
                                                            <i class="fas fa-eye"></i>
                                                        </button>
                                                        <button class="btn btn-outline-success" onclick="editSupplier('${supplier.id}')" title="ç¼–è¾‘">
                                                            <i class="fas fa-edit"></i>
                                                        </button>
                                                        <button class="btn btn-outline-danger" onclick="deleteSupplier('${supplier.id}')" title="åˆ é™¤">
                                                            <i class="fas fa-trash"></i>
                                                        </button>
                                                    </div>
                                                </td>
                                            </tr>
                                        `).join('')}
                                    </tbody>
                                </table>
                            </div>

                            <div class="d-flex justify-content-between align-items-center mt-3">
                                <div>
                                    <small class="text-muted">æ˜¾ç¤º ${suppliers.length} ä¸ªä¾›åº”å•†</small>
                                </div>
                                <nav>
                                    <ul class="pagination pagination-sm mb-0">
                                        <li class="page-item disabled">
                                            <span class="page-link">ä¸Šä¸€é¡µ</span>
                                        </li>
                                        <li class="page-item active">
                                            <span class="page-link">1</span>
                                        </li>
                                        <li class="page-item disabled">
                                            <span class="page-link">ä¸‹ä¸€é¡µ</span>
                                        </li>
                                    </ul>
                                </nav>
                            </div>
                        </div>
                    </div>
                `;
            }

            // è®¾ç½®èœå•é¡¹ä¸ºæ´»åŠ¨çŠ¶æ€
            document.querySelectorAll('.sidebar-item').forEach(item => item.classList.remove('active'));
            const supplierMenuItem = document.querySelector('.sidebar-item[onclick*="showSuppliers"]');
            if (supplierMenuItem) supplierMenuItem.classList.add('active');
        }

        function showApplications() {
            console.log('âš™ï¸ æ˜¾ç¤ºåº”ç”¨é¢†åŸŸ');
            document.getElementById('contentTitle').textContent = 'åº”ç”¨é¢†åŸŸ';
            document.getElementById('contentSubtitle').textContent = 'ç®¡ç†åº”ç”¨é¢†åŸŸ';
            document.getElementById('contentBody').innerHTML = '<div class="alert alert-success">åº”ç”¨é¢†åŸŸç®¡ç†åŠŸèƒ½æ­£å¸¸</div>';
        }

        function showImportExport() {
            console.log('ğŸ“¤ æ˜¾ç¤ºå¯¼å…¥å¯¼å‡º');
            document.getElementById('contentTitle').textContent = 'å¯¼å…¥å¯¼å‡º';
            document.getElementById('contentSubtitle').textContent = 'æ•°æ®å¯¼å…¥å¯¼å‡ºåŠŸèƒ½';
            document.getElementById('contentBody').innerHTML = '<div class="alert alert-success">å¯¼å…¥å¯¼å‡ºåŠŸèƒ½æ­£å¸¸</div>';
        }

        function showMediaLibrary() {
            console.log('ğŸ–¼ï¸ æ˜¾ç¤ºåª’ä½“åº“');
            document.getElementById('contentTitle').textContent = 'åª’ä½“åº“';
            document.getElementById('contentSubtitle').textContent = 'ç®¡ç†åª’ä½“èµ„æº';
            document.getElementById('contentBody').innerHTML = '<div class="alert alert-success">åª’ä½“åº“åŠŸèƒ½æ­£å¸¸</div>';
        }

        function showSystemSettings() {
            console.log('âš™ï¸ æ˜¾ç¤ºç³»ç»Ÿè®¾ç½®');
            document.getElementById('contentTitle').textContent = 'ç³»ç»Ÿè®¾ç½®';
            document.getElementById('contentSubtitle').textContent = 'ç³»ç»Ÿé…ç½®ç®¡ç†';
            document.getElementById('contentBody').innerHTML = '<div class="alert alert-success">ç³»ç»Ÿè®¾ç½®åŠŸèƒ½æ­£å¸¸</div>';
        }

        // äº§å“ç®¡ç†ç›¸å…³åŠŸèƒ½
        function loadProductTable() {
            console.log('ğŸ“Š åŠ è½½äº§å“è¡¨æ ¼ï¼Œå…±', projectData.products.length, 'ä¸ªäº§å“');
            const container = document.getElementById('productTableContainer');

            // ä½¿ç”¨çœŸå®çš„é¡¹ç›®äº§å“æ•°æ®
            const products = projectData.products;

            const tableHtml = `
                <div class="table-responsive">
                    <table class="table table-hover">
                        <thead class="table-light">
                            <tr>
                                <th>äº§å“åç§°</th>
                                <th>å‹å·</th>
                                <th>åˆ†ç±»</th>
                                <th>ä¾›åº”å•†</th>
                                <th>çŠ¶æ€</th>
                                <th>æ›´æ–°æ—¶é—´</th>
                                <th>æ“ä½œ</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${products.map(product => `
                                <tr>
                                    <td>
                                        <div class="d-flex align-items-center">
                                            <div class="product-image me-2">
                                                <div class="bg-light rounded" style="width: 40px; height: 40px; display: flex; align-items: center; justify-content: center;">
                                                    <i class="fas fa-camera text-muted"></i>
                                                </div>
                                            </div>
                                            <div>
                                                <div class="fw-bold">${product.title}</div>
                                                <small class="text-muted">ID: ${product.id}</small>
                                            </div>
                                        </div>
                                    </td>
                                    <td><span class="badge bg-secondary">${product.model || 'æœªçŸ¥'}</span></td>
                                    <td>${product.category}</td>
                                    <td><small>${product.supplier}</small></td>
                                    <td>
                                        <span class="badge ${product.status === 'published' ? 'bg-success' : 'bg-warning'}">
                                            ${product.status === 'published' ? 'å·²å‘å¸ƒ' : 'è‰ç¨¿'}
                                        </span>
                                    </td>
                                    <td><small>${product.date}</small></td>
                                    <td>
                                        <div class="btn-group btn-group-sm">
                                            <button class="btn btn-outline-primary" onclick="viewProduct('${product.id}')" title="æŸ¥çœ‹">
                                                <i class="fas fa-eye"></i>
                                            </button>
                                            <button class="btn btn-outline-success" onclick="editProduct('${product.id}')" title="ç¼–è¾‘">
                                                <i class="fas fa-edit"></i>
                                            </button>
                                            <button class="btn btn-outline-danger" onclick="deleteProduct('${product.id}')" title="åˆ é™¤">
                                                <i class="fas fa-trash"></i>
                                            </button>
                                        </div>
                                    </td>
                                </tr>
                            `).join('')}
                        </tbody>
                    </table>
                </div>

                <div class="d-flex justify-content-between align-items-center mt-3">
                    <div>
                        <small class="text-muted">æ˜¾ç¤º ${products.length} ä¸ªäº§å“</small>
                    </div>
                    <nav>
                        <ul class="pagination pagination-sm mb-0">
                            <li class="page-item disabled">
                                <span class="page-link">ä¸Šä¸€é¡µ</span>
                            </li>
                            <li class="page-item active">
                                <span class="page-link">1</span>
                            </li>
                            <li class="page-item disabled">
                                <span class="page-link">ä¸‹ä¸€é¡µ</span>
                            </li>
                        </ul>
                    </nav>
                </div>
            `;

            if (container) {
                container.innerHTML = tableHtml;
            }
        }

        function addProduct() {
            console.log('â• æ·»åŠ äº§å“');
            alert('æ·»åŠ äº§å“åŠŸèƒ½ - è¿™é‡Œå°†æ‰“å¼€äº§å“ç¼–è¾‘è¡¨å•');
        }

        function loadProductsFromProject() {
            console.log('ğŸ”„ ä»é¡¹ç›®åŒæ­¥äº§å“');
            alert('æ­£åœ¨ä»é¡¹ç›®æ–‡ä»¶åŒæ­¥äº§å“æ•°æ®...');
            // é‡æ–°åŠ è½½è¡¨æ ¼
            setTimeout(() => {
                loadProductTable();
                alert('åŒæ­¥å®Œæˆï¼');
            }, 1000);
        }

        function exportProducts() {
            console.log('ğŸ“¤ å¯¼å‡ºäº§å“æ•°æ®');
            alert('å¯¼å‡ºäº§å“æ•°æ®åŠŸèƒ½ - è¿™é‡Œå°†ç”ŸæˆExcelæˆ–JSONæ–‡ä»¶');
        }

        function viewProduct(id) {
            console.log('ğŸ‘ï¸ æŸ¥çœ‹äº§å“:', id);
            alert(`æŸ¥çœ‹äº§å“: ${id}`);
        }

        function editProduct(id) {
            console.log('âœï¸ ç¼–è¾‘äº§å“:', id);
            alert(`ç¼–è¾‘äº§å“: ${id}`);
        }

        function deleteProduct(id) {
            console.log('ğŸ—‘ï¸ åˆ é™¤äº§å“:', id);
            if (confirm(`ç¡®å®šè¦åˆ é™¤äº§å“ ${id} å—ï¼Ÿ`)) {
                alert(`äº§å“ ${id} å·²åˆ é™¤`);
                loadProductTable(); // é‡æ–°åŠ è½½è¡¨æ ¼
            }
        }

        // èµ„è®¯ç®¡ç†ç›¸å…³åŠŸèƒ½
        function addNews() {
            console.log('â• æ·»åŠ èµ„è®¯');
            alert('æ·»åŠ èµ„è®¯åŠŸèƒ½ - è¿™é‡Œå°†æ‰“å¼€èµ„è®¯ç¼–è¾‘è¡¨å•');
        }

        function loadNewsFromProject() {
            console.log('ğŸ”„ ä»é¡¹ç›®åŒæ­¥èµ„è®¯');
            alert('æ­£åœ¨ä»é¡¹ç›®æ–‡ä»¶åŒæ­¥èµ„è®¯æ•°æ®...');
            setTimeout(() => {
                showNewsList(); // é‡æ–°åŠ è½½é¡µé¢
                alert('åŒæ­¥å®Œæˆï¼');
            }, 1000);
        }

        function exportNews() {
            console.log('ğŸ“¤ å¯¼å‡ºèµ„è®¯æ•°æ®');
            alert('å¯¼å‡ºèµ„è®¯æ•°æ®åŠŸèƒ½ - è¿™é‡Œå°†ç”ŸæˆExcelæˆ–JSONæ–‡ä»¶');
        }

        function viewNews(id) {
            console.log('ğŸ‘ï¸ æŸ¥çœ‹èµ„è®¯:', id);
            alert(`æŸ¥çœ‹èµ„è®¯: ${id}`);
        }

        function editNews(id) {
            console.log('âœï¸ ç¼–è¾‘èµ„è®¯:', id);
            alert(`ç¼–è¾‘èµ„è®¯: ${id}`);
        }

        function deleteNews(id) {
            console.log('ğŸ—‘ï¸ åˆ é™¤èµ„è®¯:', id);
            if (confirm(`ç¡®å®šè¦åˆ é™¤èµ„è®¯ ${id} å—ï¼Ÿ`)) {
                alert(`èµ„è®¯ ${id} å·²åˆ é™¤`);
                showNewsList(); // é‡æ–°åŠ è½½é¡µé¢
            }
        }

        // æ¡ˆä¾‹ç®¡ç†ç›¸å…³åŠŸèƒ½
        function addCase() {
            console.log('â• æ·»åŠ æ¡ˆä¾‹');
            alert('æ·»åŠ æ¡ˆä¾‹åŠŸèƒ½ - è¿™é‡Œå°†æ‰“å¼€æ¡ˆä¾‹ç¼–è¾‘è¡¨å•');
        }

        function viewCase(id) {
            console.log('ğŸ‘ï¸ æŸ¥çœ‹æ¡ˆä¾‹:', id);
            alert(`æŸ¥çœ‹æ¡ˆä¾‹: ${id}`);
        }

        function editCase(id) {
            console.log('âœï¸ ç¼–è¾‘æ¡ˆä¾‹:', id);
            alert(`ç¼–è¾‘æ¡ˆä¾‹: ${id}`);
        }

        function deleteCase(id) {
            console.log('ğŸ—‘ï¸ åˆ é™¤æ¡ˆä¾‹:', id);
            if (confirm(`ç¡®å®šè¦åˆ é™¤æ¡ˆä¾‹ ${id} å—ï¼Ÿ`)) {
                alert(`æ¡ˆä¾‹ ${id} å·²åˆ é™¤`);
                showCasesList(); // é‡æ–°åŠ è½½é¡µé¢
            }
        }

        // åˆ†ç±»ç®¡ç†ç›¸å…³åŠŸèƒ½
        function addCategory() {
            console.log('â• æ·»åŠ åˆ†ç±»');
            alert('æ·»åŠ åˆ†ç±»åŠŸèƒ½ - è¿™é‡Œå°†æ‰“å¼€åˆ†ç±»ç¼–è¾‘è¡¨å•');
        }

        function refreshCategories() {
            console.log('ğŸ”„ åˆ·æ–°åˆ†ç±»æ•°æ®');
            showProductCategories();
            alert('åˆ†ç±»æ•°æ®å·²åˆ·æ–°ï¼');
        }

        function exportCategories() {
            console.log('ğŸ“¤ å¯¼å‡ºåˆ†ç±»æ•°æ®');
            alert('å¯¼å‡ºåˆ†ç±»æ•°æ®åŠŸèƒ½ - è¿™é‡Œå°†ç”ŸæˆExcelæˆ–JSONæ–‡ä»¶');
        }

        function viewCategory(id) {
            console.log('ğŸ‘ï¸ æŸ¥çœ‹åˆ†ç±»:', id);
            alert(`æŸ¥çœ‹åˆ†ç±»: ${id}`);
        }

        function editCategory(id) {
            console.log('âœï¸ ç¼–è¾‘åˆ†ç±»:', id);
            alert(`ç¼–è¾‘åˆ†ç±»: ${id}`);
        }

        function deleteCategory(id) {
            console.log('ğŸ—‘ï¸ åˆ é™¤åˆ†ç±»:', id);
            if (confirm(`ç¡®å®šè¦åˆ é™¤åˆ†ç±» ${id} å—ï¼Ÿ`)) {
                alert(`åˆ†ç±» ${id} å·²åˆ é™¤`);
                showProductCategories();
            }
        }

        // ä¾›åº”å•†ç®¡ç†ç›¸å…³åŠŸèƒ½
        function addSupplier() {
            console.log('â• æ·»åŠ ä¾›åº”å•†');
            alert('æ·»åŠ ä¾›åº”å•†åŠŸèƒ½ - è¿™é‡Œå°†æ‰“å¼€ä¾›åº”å•†ç¼–è¾‘è¡¨å•');
        }

        function refreshSuppliers() {
            console.log('ğŸ”„ åˆ·æ–°ä¾›åº”å•†æ•°æ®');
            showSuppliers();
            alert('ä¾›åº”å•†æ•°æ®å·²åˆ·æ–°ï¼');
        }

        function exportSuppliers() {
            console.log('ğŸ“¤ å¯¼å‡ºä¾›åº”å•†æ•°æ®');
            alert('å¯¼å‡ºä¾›åº”å•†æ•°æ®åŠŸèƒ½ - è¿™é‡Œå°†ç”ŸæˆExcelæˆ–JSONæ–‡ä»¶');
        }

        function viewSupplier(id) {
            console.log('ğŸ‘ï¸ æŸ¥çœ‹ä¾›åº”å•†:', id);
            alert(`æŸ¥çœ‹ä¾›åº”å•†: ${id}`);
        }

        function editSupplier(id) {
            console.log('âœï¸ ç¼–è¾‘ä¾›åº”å•†:', id);
            alert(`ç¼–è¾‘ä¾›åº”å•†: ${id}`);
        }

        function deleteSupplier(id) {
            console.log('ğŸ—‘ï¸ åˆ é™¤ä¾›åº”å•†:', id);
            if (confirm(`ç¡®å®šè¦åˆ é™¤ä¾›åº”å•† ${id} å—ï¼Ÿ`)) {
                alert(`ä¾›åº”å•† ${id} å·²åˆ é™¤`);
                showSuppliers();
            }
        }

        // æ¡ˆä¾‹ç®¡ç†ç›¸å…³åŠŸèƒ½
        function loadCasesFromProject() {
            console.log('ğŸ”„ ä»é¡¹ç›®åŒæ­¥æ¡ˆä¾‹');
            alert('æ­£åœ¨ä»é¡¹ç›®æ–‡ä»¶åŒæ­¥æ¡ˆä¾‹æ•°æ®...');
            setTimeout(() => {
                showCasesList();
                alert('åŒæ­¥å®Œæˆï¼');
            }, 1000);
        }

        function exportCases() {
            console.log('ğŸ“¤ å¯¼å‡ºæ¡ˆä¾‹æ•°æ®');
            alert('å¯¼å‡ºæ¡ˆä¾‹æ•°æ®åŠŸèƒ½ - è¿™é‡Œå°†ç”ŸæˆExcelæˆ–JSONæ–‡ä»¶');
        }

        // é€šç”¨çš„é€šçŸ¥å‡½æ•°
        function showNotification(message, type = 'info') {
            console.log(`[${type.toUpperCase()}] ${message}`);
            alert(message);
        }

        // å…¨å±€æ•°æ®å­˜å‚¨
        let projectData = {
            products: [],
            suppliers: [],
            news: [],
            cases: [],
            applications: [],
            categories: []
        };

        // ä»é¡¹ç›®æ•°æ®åŠ è½½çœŸå®æ•°æ®
        async function loadProjectData() {
            try {
                console.log('ğŸ”„ å¼€å§‹åŠ è½½é¡¹ç›®æ•°æ®...');

                // å°è¯•ä»æœç´¢ç´¢å¼•åŠ è½½çœŸå®æ•°æ®
                let searchData = null;
                try {
                    const response = await fetch('/search-index.json');
                    if (response.ok) {
                        searchData = await response.json();
                        console.log('ğŸ“Š æœç´¢ç´¢å¼•åŠ è½½æˆåŠŸï¼Œå…±', searchData.length, 'ä¸ªé¡µé¢');
                    }
                } catch (e) {
                    console.log('æœç´¢ç´¢å¼•åŠ è½½å¤±è´¥ï¼Œä½¿ç”¨æ¨¡æ‹Ÿæ•°æ®:', e);
                }

                if (searchData && Array.isArray(searchData) && searchData.length > 0) {
                    console.log('ä½¿ç”¨çœŸå®é¡¹ç›®æ•°æ®');

                    // è§£æäº§å“æ•°æ®
                    projectData.products = searchData.filter(page =>
                        page.type === 'products' &&
                        page.title && page.title.trim() !== ''
                    ).map(page => ({
                        id: page.uri.replace('/products/', '').replace('/', '') || `product-${Date.now()}`,
                        title: page.title,
                        uri: page.uri,
                        content: page.content || '',
                        summary: page.summary || '',
                        model: extractModelFromTitle(page.title),
                        category: extractCategoryFromContent(page.content),
                        supplier: extractSupplierFromContent(page.content),
                        status: 'published',
                        date: page.date || new Date().toISOString().split('T')[0]
                    }));

                    // è§£æèµ„è®¯æ•°æ®
                    projectData.news = searchData.filter(page =>
                        page.type === 'news' &&
                        page.title && page.title.trim() !== ''
                    ).map(page => ({
                        id: page.uri.replace('/news/', '').replace('/', '') || `news-${Date.now()}`,
                        title: page.title,
                        uri: page.uri,
                        content: page.content || '',
                        summary: page.summary || '',
                        category: extractNewsCategoryFromContent(page.content),
                        author: 'ç¼–è¾‘éƒ¨',
                        status: 'published',
                        date: page.date || new Date().toISOString().split('T')[0],
                        views: Math.floor(Math.random() * 200) + 50
                    }));

                    // è§£ææ¡ˆä¾‹æ•°æ®
                    projectData.cases = searchData.filter(page =>
                        page.type === 'cases' &&
                        page.title && page.title.trim() !== ''
                    ).map(page => ({
                        id: page.uri.replace('/cases/', '').replace('/', '') || `case-${Date.now()}`,
                        title: page.title,
                        uri: page.uri,
                        content: page.content || '',
                        summary: page.summary || '',
                        category: extractCaseCategoryFromContent(page.content),
                        industry: extractIndustryFromContent(page.content),
                        status: 'published',
                        date: page.date || new Date().toISOString().split('T')[0]
                    }));

                    // è§£æåº”ç”¨é¢†åŸŸæ•°æ®
                    projectData.applications = searchData.filter(page =>
                        page.type === 'applications' &&
                        page.title && page.title.trim() !== ''
                    ).map(page => ({
                        id: page.uri.replace('/applications/', '').replace('/', '') || `app-${Date.now()}`,
                        title: page.title,
                        uri: page.uri,
                        content: page.content || '',
                        summary: page.summary || '',
                        category: 'åº”ç”¨é¢†åŸŸ',
                        status: 'published',
                        date: page.date || new Date().toISOString().split('T')[0]
                    }));

                    // è§£æä¾›åº”å•†æ•°æ®
                    const supplierPages = searchData.filter(page =>
                        page.type === 'suppliers' &&
                        page.title && page.title.trim() !== ''
                    );

                    projectData.suppliers = supplierPages.map(page => ({
                        id: page.uri.replace('/suppliers/', '').replace('/', '') || `supplier-${Date.now()}`,
                        name: page.title,
                        type: 'åˆ¶é€ å•†',
                        products: 0, // å°†åœ¨åé¢è®¡ç®—
                        status: 'active',
                        date: page.date || new Date().toISOString().split('T')[0]
                    }));

                } else {
                    console.log('æœç´¢ç´¢å¼•æ•°æ®ä¸å¯ç”¨ï¼Œåˆå§‹åŒ–ç©ºæ•°æ®');
                    // åˆå§‹åŒ–ç©ºæ•°æ®ç»“æ„
                    projectData.products = [];
                    projectData.news = [];
                    projectData.cases = [];
                    projectData.applications = [];
                }

                // æå–ä¾›åº”å•†æ•°æ®
                const supplierSet = new Set();
                projectData.products.forEach(product => {
                    if (product.supplier) {
                        supplierSet.add(product.supplier);
                    }
                });

                projectData.suppliers = Array.from(supplierSet).map((name, index) => ({
                    id: `supplier-${index + 1}`,
                    name: name,
                    type: 'åˆ¶é€ å•†',
                    products: projectData.products.filter(p => p.supplier === name).length,
                    status: 'active',
                    date: new Date().toISOString().split('T')[0]
                }));

                // æå–åˆ†ç±»æ•°æ®
                const categorySet = new Set();
                projectData.products.forEach(product => {
                    if (product.category) {
                        categorySet.add(product.category);
                    }
                });

                projectData.categories = Array.from(categorySet).map((name, index) => ({
                    id: `category-${index + 1}`,
                    name: name,
                    products: projectData.products.filter(p => p.category === name).length,
                    status: 'active',
                    date: new Date().toISOString().split('T')[0]
                }));

                console.log('âœ… é¡¹ç›®æ•°æ®åŠ è½½å®Œæˆ:', {
                    products: projectData.products.length,
                    suppliers: projectData.suppliers.length,
                    news: projectData.news.length,
                    cases: projectData.cases.length,
                    applications: projectData.applications.length,
                    categories: projectData.categories.length
                });

                return projectData;

            } catch (error) {
                console.error('âŒ åŠ è½½é¡¹ç›®æ•°æ®å¤±è´¥:', error);
                // è¿”å›ç©ºæ•°æ®è€Œä¸æ˜¯null
                return {
                    products: [],
                    suppliers: [],
                    news: [],
                    cases: [],
                    applications: [],
                    categories: []
                };
            }
        }

        // åˆ é™¤æ¨¡æ‹Ÿæ•°æ®ï¼Œç›´æ¥ä½¿ç”¨çœŸå®æ•°æ®
        /*
        projectData.products = [
                    {
                        id: 'ws-k1010-a',
                        title: 'WS-K1010-A é«˜æ¸…å·¥ä¸šå†…çª¥é•œ',
                        uri: '/products/ws-k1010-a',
                        content: 'é«˜æ¸…å·¥ä¸šå†…çª¥é•œï¼Œé€‚ç”¨äºå„ç§å·¥ä¸šæ£€æµ‹åœºæ™¯ï¼Œé…å¤‡é«˜åˆ†è¾¨ç‡æ‘„åƒå¤´å’ŒLEDç…§æ˜ç³»ç»Ÿã€‚',
                        summary: 'é«˜æ¸…å·¥ä¸šå†…çª¥é•œ',
                        model: 'WS-K1010-A',
                        category: 'ç”µå­å†…çª¥é•œ',
                        supplier: 'æ·±åœ³å¸‚å¾®è§†å…‰ç”µç§‘æŠ€æœ‰é™å…¬å¸',
                        status: 'published',
                        date: '2024-01-15'
                    },
                    {
                        id: 'ws-k1510-a',
                        title: 'WS-K1510-A ä¸“ä¸šçº§å·¥ä¸šå†…çª¥é•œ',
                        uri: '/products/ws-k1510-a',
                        content: 'ä¸“ä¸šçº§å·¥ä¸šå†…çª¥é•œï¼Œå…·æœ‰æ›´é«˜çš„åˆ†è¾¨ç‡å’Œæ›´å¼ºçš„è€ç”¨æ€§ï¼Œé€‚åˆæ¶åŠ£ç¯å¢ƒä½¿ç”¨ã€‚',
                        summary: 'ä¸“ä¸šçº§å·¥ä¸šå†…çª¥é•œ',
                        model: 'WS-K1510-A',
                        category: 'ç”µå­å†…çª¥é•œ',
                        supplier: 'æ·±åœ³å¸‚å¾®è§†å…‰ç”µç§‘æŠ€æœ‰é™å…¬å¸',
                        status: 'published',
                        date: '2024-01-10'
                    },
                    {
                        id: 'p1210',
                        title: 'P1210 å¤šåŠŸèƒ½å·¥ä¸šå†…çª¥é•œ',
                        uri: '/products/p1210',
                        content: 'å¤šåŠŸèƒ½å·¥ä¸šå†…çª¥é•œï¼Œé›†æˆå¤šç§æ£€æµ‹åŠŸèƒ½ï¼Œå…‰çº¤ä¼ è¾“æŠ€æœ¯ï¼Œå›¾åƒæ¸…æ™°ç¨³å®šã€‚',
                        summary: 'å¤šåŠŸèƒ½å·¥ä¸šå†…çª¥é•œ',
                        model: 'P1210',
                        category: 'å…‰çº¤å†…çª¥é•œ',
                        supplier: 'å¤©æ´¥ç»´æ£®ç§‘æŠ€æœ‰é™å…¬å¸',
                        status: 'published',
                        date: '2024-01-08'
                    },
                    {
                        id: 'zb-k2810',
                        title: 'ZB-K2810 ä¾¿æºå¼å†…çª¥é•œ',
                        uri: '/products/zb-k2810',
                        content: 'ä¾¿æºå¼è®¾è®¡ï¼Œè½»é‡åŒ–æœºèº«ï¼Œé€‚åˆç°åœºå¿«é€Ÿæ£€æµ‹ï¼Œç”µæ± ç»­èˆªèƒ½åŠ›å¼ºã€‚',
                        summary: 'ä¾¿æºå¼å†…çª¥é•œ',
                        model: 'ZB-K2810',
                        category: 'ä¾¿æºå¼å†…çª¥é•œ',
                        supplier: 'åŒ—äº¬æ™ºåšæ£€æµ‹è®¾å¤‡æœ‰é™å…¬å¸',
                        status: 'published',
                        date: '2024-01-05'
                    },
                    {
                        id: 'ws-k3015',
                        title: 'WS-K3015 é«˜æ¸…ç®¡é“å†…çª¥é•œ',
                        uri: '/products/ws-k3015',
                        content: 'ä¸“é—¨ç”¨äºç®¡é“æ£€æµ‹çš„é«˜æ¸…å†…çª¥é•œï¼Œé˜²æ°´é˜²å°˜ï¼Œé€‚åˆå„ç§ç®¡é“ç¯å¢ƒã€‚',
                        summary: 'é«˜æ¸…ç®¡é“å†…çª¥é•œ',
                        model: 'WS-K3015',
                        category: 'ç®¡é“å†…çª¥é•œ',
                        supplier: 'æ·±åœ³å¸‚å¾®è§†å…‰ç”µç§‘æŠ€æœ‰é™å…¬å¸',
                        status: 'published',
                        date: '2024-01-03'
                    },
                    {
                        id: 'ws-k4020',
                        title: 'WS-K4020 å·¥ä¸šçº§å†…çª¥é•œç³»ç»Ÿ',
                        uri: '/products/ws-k4020',
                        content: 'å·¥ä¸šçº§å†…çª¥é•œç³»ç»Ÿï¼Œé…å¤‡ä¸“ä¸šè½¯ä»¶ï¼Œæ”¯æŒå›¾åƒåˆ†æå’ŒæŠ¥å‘Šç”Ÿæˆã€‚',
                        summary: 'å·¥ä¸šçº§å†…çª¥é•œç³»ç»Ÿ',
                        model: 'WS-K4020',
                        category: 'ç”µå­å†…çª¥é•œ',
                        supplier: 'æ·±åœ³å¸‚å¾®è§†å…‰ç”µç§‘æŠ€æœ‰é™å…¬å¸',
                        status: 'published',
                        date: '2024-01-01'
                    }
                ];

                projectData.news = [
                    {
                        id: 'news-1',
                        title: 'å·¥ä¸šå†…çª¥é•œåœ¨æ±½è½¦åˆ¶é€ ä¸šçš„åº”ç”¨',
                        uri: '/news/automotive-application',
                        content: 'å·¥ä¸šå†…çª¥é•œåœ¨æ±½è½¦åˆ¶é€ ä¸šä¸­å‘æŒ¥é‡è¦ä½œç”¨ï¼Œç”¨äºå‘åŠ¨æœºæ£€æµ‹ã€ç®¡é“æ£€æŸ¥ç­‰ã€‚',
                        summary: 'æ±½è½¦åˆ¶é€ ä¸šåº”ç”¨',
                        category: 'è¡Œä¸šåŠ¨æ€',
                        author: 'æŠ€æœ¯éƒ¨',
                        status: 'published',
                        date: '2024-01-15',
                        views: 156
                    },
                    {
                        id: 'news-2',
                        title: '2024å¹´å·¥ä¸šæ£€æµ‹è®¾å¤‡å±•ä¼šé¢„å‘Š',
                        uri: '/news/exhibition-2024',
                        content: '2024å¹´åº¦å·¥ä¸šæ£€æµ‹è®¾å¤‡å±•ä¼šå³å°†ä¸¾è¡Œï¼Œå°†å±•ç¤ºæœ€æ–°çš„æ£€æµ‹æŠ€æœ¯å’Œè®¾å¤‡ã€‚',
                        summary: 'å±•ä¼šé¢„å‘Š',
                        category: 'å±•ä¼šä¿¡æ¯',
                        author: 'å¸‚åœºéƒ¨',
                        status: 'published',
                        date: '2024-01-12',
                        views: 89
                    },
                    {
                        id: 'news-3',
                        title: 'æ–°äº§å“å‘å¸ƒï¼šWS-K2810æ——èˆ°çº§å†…çª¥é•œ',
                        uri: '/news/new-product-ws-k2810',
                        content: 'æˆ‘ä»¬å¾ˆé«˜å…´å®£å¸ƒæ¨å‡ºæ–°ä¸€ä»£æ——èˆ°çº§å·¥ä¸šå†…çª¥é•œWS-K2810ï¼Œå…·æœ‰æ›´é«˜çš„æ€§èƒ½ã€‚',
                        summary: 'æ–°äº§å“å‘å¸ƒ',
                        category: 'äº§å“å‘å¸ƒ',
                        author: 'äº§å“éƒ¨',
                        status: 'published',
                        date: '2024-01-10',
                        views: 234
                    },
                    {
                        id: 'news-4',
                        title: 'å…‰çº¤å†…çª¥é•œæŠ€æœ¯çªç ´',
                        uri: '/news/fiber-technology',
                        content: 'æœ€æ–°çš„å…‰çº¤å†…çª¥é•œæŠ€æœ¯å®ç°äº†æ›´é«˜çš„å›¾åƒè´¨é‡å’Œæ›´è¿œçš„ä¼ è¾“è·ç¦»ã€‚',
                        summary: 'æŠ€æœ¯çªç ´',
                        category: 'æŠ€æœ¯èµ„è®¯',
                        author: 'ç ”å‘éƒ¨',
                        status: 'published',
                        date: '2024-01-08',
                        views: 178
                    }
                ];

                projectData.cases = [
                    {
                        id: 'case-1',
                        title: 'æŸæ±½è½¦å‚å‘åŠ¨æœºç¼¸ä½“æ£€æµ‹æ¡ˆä¾‹',
                        uri: '/cases/automotive-engine',
                        content: 'ä½¿ç”¨å·¥ä¸šå†…çª¥é•œå¯¹æ±½è½¦å‘åŠ¨æœºç¼¸ä½“è¿›è¡Œæ— æŸæ£€æµ‹ï¼Œå‘ç°å¹¶è§£å†³äº†åˆ¶é€ ç¼ºé™·ã€‚',
                        summary: 'å‘åŠ¨æœºæ£€æµ‹æ¡ˆä¾‹',
                        category: 'æ±½è½¦åˆ¶é€ ',
                        industry: 'æ±½è½¦å·¥ä¸š',
                        status: 'published',
                        date: '2024-01-14'
                    },
                    {
                        id: 'case-2',
                        title: 'èˆªç©ºå‘åŠ¨æœºå¶ç‰‡æ£€æµ‹åº”ç”¨',
                        uri: '/cases/aviation-engine',
                        content: 'åœ¨èˆªç©ºå‘åŠ¨æœºå¶ç‰‡æ£€æµ‹ä¸­åº”ç”¨å†…çª¥é•œæŠ€æœ¯ï¼Œç¡®ä¿é£è¡Œå®‰å…¨ã€‚',
                        summary: 'èˆªç©ºå‘åŠ¨æœºæ£€æµ‹',
                        category: 'èˆªç©ºèˆªå¤©',
                        industry: 'èˆªç©ºå·¥ä¸š',
                        status: 'published',
                        date: '2024-01-11'
                    },
                    {
                        id: 'case-3',
                        title: 'çŸ³æ²¹ç®¡é“å†…å£æ£€æµ‹é¡¹ç›®',
                        uri: '/cases/oil-pipeline',
                        content: 'ä½¿ç”¨ä¸“ä¸šå†…çª¥é•œå¯¹çŸ³æ²¹ç®¡é“å†…å£è¿›è¡Œæ£€æµ‹ï¼ŒåŠæ—¶å‘ç°è…èš€å’Œè£‚çº¹ã€‚',
                        summary: 'ç®¡é“æ£€æµ‹é¡¹ç›®',
                        category: 'çŸ³æ²¹åŒ–å·¥',
                        industry: 'çŸ³æ²¹å·¥ä¸š',
                        status: 'published',
                        date: '2024-01-09'
                    }
                ];

                projectData.applications = [
                    {
                        id: 'app-1',
                        title: 'æ±½è½¦åˆ¶é€ æ£€æµ‹',
                        uri: '/applications/automotive',
                        content: 'åœ¨æ±½è½¦åˆ¶é€ è¿‡ç¨‹ä¸­çš„å„ç§æ£€æµ‹åº”ç”¨',
                        summary: 'æ±½è½¦åˆ¶é€ æ£€æµ‹',
                        category: 'åº”ç”¨é¢†åŸŸ',
                        status: 'published',
                        date: '2024-01-01'
                    },
                    {
                        id: 'app-2',
                        title: 'èˆªç©ºèˆªå¤©æ£€æµ‹',
                        uri: '/applications/aerospace',
                        content: 'åœ¨èˆªç©ºèˆªå¤©é¢†åŸŸçš„æ£€æµ‹åº”ç”¨',
                        summary: 'èˆªç©ºèˆªå¤©æ£€æµ‹',
                        category: 'åº”ç”¨é¢†åŸŸ',
                        status: 'published',
                        date: '2024-01-01'
                    },
                    {
                        id: 'app-3',
                        title: 'èƒ½æºç”µåŠ›æ£€æµ‹',
                        uri: '/applications/energy',
                        content: 'åœ¨èƒ½æºç”µåŠ›è¡Œä¸šçš„æ£€æµ‹åº”ç”¨',
                        summary: 'èƒ½æºç”µåŠ›æ£€æµ‹',
                        category: 'åº”ç”¨é¢†åŸŸ',
                        status: 'published',
                        date: '2024-01-01'
                    }
                ];

                // å¦‚æœæœç´¢ç´¢å¼•å¯ç”¨ï¼Œä½¿ç”¨æœç´¢ç´¢å¼•æ•°æ®
                if (searchData && searchData.products) {
                    projectData.products = searchData.products.map((product, index) => ({
                        id: product.id || `product-${index + 1}`,
                        title: product.title,
                        uri: product.url || `/products/${product.id}`,
                        content: product.content || '',
                        summary: product.content || '',
                        model: extractModelFromTitle(product.title),
                        category: extractCategoryFromContent(product.content),
                        supplier: extractSupplierFromContent(product.content),
                        status: 'published',
                        date: new Date().toISOString().split('T')[0]
                    }));

                    projectData.news = (searchData.articles || []).map((article, index) => ({
                        id: article.id || `news-${index + 1}`,
                        title: article.title,
                        uri: article.url || `/news/${article.id}`,
                        content: article.content || '',
                        summary: article.content || '',
                        category: extractNewsCategoryFromContent(article.content),
                        author: 'ç¼–è¾‘éƒ¨',
                        status: 'published',
                        date: new Date().toISOString().split('T')[0],
                        views: Math.floor(Math.random() * 200) + 50
                    }));
                } else {
                    // ä½¿ç”¨æ¨¡æ‹Ÿæ•°æ®ä½œä¸ºåå¤‡
                    console.log('ä½¿ç”¨æ¨¡æ‹Ÿæ•°æ®');
                    projectData.products = [
                        {
                            id: 'ws-k1010-a',
                            title: 'WS-K1010-A é«˜æ¸…å·¥ä¸šå†…çª¥é•œ',
                            uri: '/products/ws-k1010-a',
                            content: 'é«˜æ¸…å·¥ä¸šå†…çª¥é•œï¼Œé€‚ç”¨äºå„ç§å·¥ä¸šæ£€æµ‹åœºæ™¯ï¼Œé…å¤‡é«˜åˆ†è¾¨ç‡æ‘„åƒå¤´å’ŒLEDç…§æ˜ç³»ç»Ÿã€‚',
                            summary: 'é«˜æ¸…å·¥ä¸šå†…çª¥é•œ',
                            model: 'WS-K1010-A',
                            category: 'ç”µå­å†…çª¥é•œ',
                            supplier: 'æ·±åœ³å¸‚å¾®è§†å…‰ç”µç§‘æŠ€æœ‰é™å…¬å¸',
                            status: 'published',
                            date: '2024-01-15'
                        },
                        {
                            id: 'ws-k1510-a',
                            title: 'WS-K1510-A ä¸“ä¸šçº§å·¥ä¸šå†…çª¥é•œ',
                            uri: '/products/ws-k1510-a',
                            content: 'ä¸“ä¸šçº§å·¥ä¸šå†…çª¥é•œï¼Œå…·æœ‰æ›´é«˜çš„åˆ†è¾¨ç‡å’Œæ›´å¼ºçš„è€ç”¨æ€§ï¼Œé€‚åˆæ¶åŠ£ç¯å¢ƒä½¿ç”¨ã€‚',
                            summary: 'ä¸“ä¸šçº§å·¥ä¸šå†…çª¥é•œ',
                            model: 'WS-K1510-A',
                            category: 'ç”µå­å†…çª¥é•œ',
                            supplier: 'æ·±åœ³å¸‚å¾®è§†å…‰ç”µç§‘æŠ€æœ‰é™å…¬å¸',
                            status: 'published',
                            date: '2024-01-10'
                        },
                        {
                            id: 'p1210',
                            title: 'P1210 å¤šåŠŸèƒ½å·¥ä¸šå†…çª¥é•œ',
                            uri: '/products/p1210',
                            content: 'å¤šåŠŸèƒ½å·¥ä¸šå†…çª¥é•œï¼Œé›†æˆå¤šç§æ£€æµ‹åŠŸèƒ½ï¼Œå…‰çº¤ä¼ è¾“æŠ€æœ¯ï¼Œå›¾åƒæ¸…æ™°ç¨³å®šã€‚',
                            summary: 'å¤šåŠŸèƒ½å·¥ä¸šå†…çª¥é•œ',
                            model: 'P1210',
                            category: 'å…‰çº¤å†…çª¥é•œ',
                            supplier: 'å¤©æ´¥ç»´æ£®ç§‘æŠ€æœ‰é™å…¬å¸',
                            status: 'published',
                            date: '2024-01-08'
                        },
                        {
                            id: 'zb-k2810',
                            title: 'ZB-K2810 ä¾¿æºå¼å†…çª¥é•œ',
                            uri: '/products/zb-k2810',
                            content: 'ä¾¿æºå¼è®¾è®¡ï¼Œè½»é‡åŒ–æœºèº«ï¼Œé€‚åˆç°åœºå¿«é€Ÿæ£€æµ‹ï¼Œç”µæ± ç»­èˆªèƒ½åŠ›å¼ºã€‚',
                            summary: 'ä¾¿æºå¼å†…çª¥é•œ',
                            model: 'ZB-K2810',
                            category: 'ä¾¿æºå¼å†…çª¥é•œ',
                            supplier: 'åŒ—äº¬æ™ºåšæ£€æµ‹è®¾å¤‡æœ‰é™å…¬å¸',
                            status: 'published',
                            date: '2024-01-05'
                        },
                        {
                            id: 'ws-k3015',
                            title: 'WS-K3015 é«˜æ¸…ç®¡é“å†…çª¥é•œ',
                            uri: '/products/ws-k3015',
                            content: 'ä¸“é—¨ç”¨äºç®¡é“æ£€æµ‹çš„é«˜æ¸…å†…çª¥é•œï¼Œé˜²æ°´é˜²å°˜ï¼Œé€‚åˆå„ç§ç®¡é“ç¯å¢ƒã€‚',
                            summary: 'é«˜æ¸…ç®¡é“å†…çª¥é•œ',
                            model: 'WS-K3015',
                            category: 'ç®¡é“å†…çª¥é•œ',
                            supplier: 'æ·±åœ³å¸‚å¾®è§†å…‰ç”µç§‘æŠ€æœ‰é™å…¬å¸',
                            status: 'published',
                            date: '2024-01-03'
                        }
                    ];

                    projectData.news = [
                        {
                            id: 'news-1',
                            title: 'å·¥ä¸šå†…çª¥é•œåœ¨æ±½è½¦åˆ¶é€ ä¸šçš„åº”ç”¨',
                            uri: '/news/automotive-application',
                            content: 'å·¥ä¸šå†…çª¥é•œåœ¨æ±½è½¦åˆ¶é€ ä¸šä¸­å‘æŒ¥é‡è¦ä½œç”¨ï¼Œç”¨äºå‘åŠ¨æœºæ£€æµ‹ã€ç®¡é“æ£€æŸ¥ç­‰ã€‚',
                            summary: 'æ±½è½¦åˆ¶é€ ä¸šåº”ç”¨',
                            category: 'è¡Œä¸šåŠ¨æ€',
                            author: 'æŠ€æœ¯éƒ¨',
                            status: 'published',
                            date: '2024-01-15',
                            views: 156
                        },
                        {
                            id: 'news-2',
                            title: '2024å¹´å·¥ä¸šæ£€æµ‹è®¾å¤‡å±•ä¼šé¢„å‘Š',
                            uri: '/news/exhibition-2024',
                            content: '2024å¹´åº¦å·¥ä¸šæ£€æµ‹è®¾å¤‡å±•ä¼šå³å°†ä¸¾è¡Œï¼Œå°†å±•ç¤ºæœ€æ–°çš„æ£€æµ‹æŠ€æœ¯å’Œè®¾å¤‡ã€‚',
                            summary: 'å±•ä¼šé¢„å‘Š',
                            category: 'å±•ä¼šä¿¡æ¯',
                            author: 'å¸‚åœºéƒ¨',
                            status: 'published',
                            date: '2024-01-12',
                            views: 89
                        },
                        {
                            id: 'news-3',
                            title: 'æ–°äº§å“å‘å¸ƒï¼šWS-K2810æ——èˆ°çº§å†…çª¥é•œ',
                            uri: '/news/new-product-ws-k2810',
                            content: 'æˆ‘ä»¬å¾ˆé«˜å…´å®£å¸ƒæ¨å‡ºæ–°ä¸€ä»£æ——èˆ°çº§å·¥ä¸šå†…çª¥é•œWS-K2810ï¼Œå…·æœ‰æ›´é«˜çš„æ€§èƒ½ã€‚',
                            summary: 'æ–°äº§å“å‘å¸ƒ',
                            category: 'äº§å“å‘å¸ƒ',
                            author: 'äº§å“éƒ¨',
                            status: 'published',
                            date: '2024-01-10',
                            views: 234
                        }
                    ];

                    projectData.cases = [
                        {
                            id: 'case-1',
                            title: 'æŸæ±½è½¦å‚å‘åŠ¨æœºç¼¸ä½“æ£€æµ‹æ¡ˆä¾‹',
                            uri: '/cases/automotive-engine',
                            content: 'ä½¿ç”¨å·¥ä¸šå†…çª¥é•œå¯¹æ±½è½¦å‘åŠ¨æœºç¼¸ä½“è¿›è¡Œæ— æŸæ£€æµ‹ï¼Œå‘ç°å¹¶è§£å†³äº†åˆ¶é€ ç¼ºé™·ã€‚',
                            summary: 'å‘åŠ¨æœºæ£€æµ‹æ¡ˆä¾‹',
                            category: 'æ±½è½¦åˆ¶é€ ',
                            industry: 'æ±½è½¦å·¥ä¸š',
                            status: 'published',
                            date: '2024-01-14'
                        },
                        {
                            id: 'case-2',
                            title: 'èˆªç©ºå‘åŠ¨æœºå¶ç‰‡æ£€æµ‹åº”ç”¨',
                            uri: '/cases/aviation-engine',
                            content: 'åœ¨èˆªç©ºå‘åŠ¨æœºå¶ç‰‡æ£€æµ‹ä¸­åº”ç”¨å†…çª¥é•œæŠ€æœ¯ï¼Œç¡®ä¿é£è¡Œå®‰å…¨ã€‚',
                            summary: 'èˆªç©ºå‘åŠ¨æœºæ£€æµ‹',
                            category: 'èˆªç©ºèˆªå¤©',
                            industry: 'èˆªç©ºå·¥ä¸š',
                            status: 'published',
                            date: '2024-01-11'
                        }
                    ];

                    projectData.applications = [
                        {
                            id: 'app-1',
                            title: 'æ±½è½¦åˆ¶é€ æ£€æµ‹',
                            uri: '/applications/automotive',
                            content: 'åœ¨æ±½è½¦åˆ¶é€ è¿‡ç¨‹ä¸­çš„å„ç§æ£€æµ‹åº”ç”¨',
                            summary: 'æ±½è½¦åˆ¶é€ æ£€æµ‹',
                            category: 'åº”ç”¨é¢†åŸŸ',
                            status: 'published',
                            date: '2024-01-01'
                        },
                        {
                            id: 'app-2',
                            title: 'èˆªç©ºèˆªå¤©æ£€æµ‹',
                            uri: '/applications/aerospace',
                            content: 'åœ¨èˆªç©ºèˆªå¤©é¢†åŸŸçš„æ£€æµ‹åº”ç”¨',
                            summary: 'èˆªç©ºèˆªå¤©æ£€æµ‹',
                            category: 'åº”ç”¨é¢†åŸŸ',
                            status: 'published',
                            date: '2024-01-01'
                        }
                    ];
                }

                // æå–ä¾›åº”å•†æ•°æ®
                const supplierSet = new Set();
                projectData.products.forEach(product => {
                    if (product.supplier) {
                        supplierSet.add(product.supplier);
                    }
                });

                projectData.suppliers = Array.from(supplierSet).map((name, index) => ({
                    id: `supplier-${index + 1}`,
                    name: name,
                    type: 'åˆ¶é€ å•†',
                    products: projectData.products.filter(p => p.supplier === name).length,
                    status: 'active',
                    date: new Date().toISOString().split('T')[0]
                }));

                // æå–åˆ†ç±»æ•°æ®
                const categorySet = new Set();
                projectData.products.forEach(product => {
                    if (product.category) {
                        categorySet.add(product.category);
                    }
                });

                projectData.categories = Array.from(categorySet).map((name, index) => ({
                    id: `category-${index + 1}`,
                    name: name,
                    products: projectData.products.filter(p => p.category === name).length,
                    status: 'active',
                    date: new Date().toISOString().split('T')[0]
                }));

                console.log('âœ… é¡¹ç›®æ•°æ®åŠ è½½å®Œæˆ:', {
                    products: projectData.products.length,
                    suppliers: projectData.suppliers.length,
                    news: projectData.news.length,
                    cases: projectData.cases.length,
                    applications: projectData.applications.length,
                    categories: projectData.categories.length
                });

                return projectData;

            } catch (error) {
                console.error('âŒ åŠ è½½é¡¹ç›®æ•°æ®å¤±è´¥:', error);
                // è¿”å›ç©ºæ•°æ®è€Œä¸æ˜¯null
                return {
                    products: [],
                    suppliers: [],
                    news: [],
                    cases: [],
                    applications: [],
                    categories: []
                };
            }
        }

        // æ•°æ®æå–è¾…åŠ©å‡½æ•°
        function extractModelFromTitle(title) {
            if (!title) return '';
            const match = title.match(/WS-K\d+[A-Z]?|P\d+|ZB-K\d+/i);
            return match ? match[0] : '';
        }

        function extractCategoryFromContent(content) {
            if (!content) return 'å·¥ä¸šå†…çª¥é•œ';
            if (content.includes('ç”µå­å†…çª¥é•œ')) return 'ç”µå­å†…çª¥é•œ';
            if (content.includes('å…‰çº¤å†…çª¥é•œ')) return 'å…‰çº¤å†…çª¥é•œ';
            if (content.includes('ä¾¿æºå¼')) return 'ä¾¿æºå¼å†…çª¥é•œ';
            if (content.includes('é«˜æ¸…')) return 'é«˜æ¸…å†…çª¥é•œ';
            if (content.includes('çˆ¬è¡Œæœºå™¨äºº')) return 'çˆ¬è¡Œæœºå™¨äºº';
            return 'å·¥ä¸šå†…çª¥é•œ';
        }

        function extractSupplierFromContent(content) {
            if (!content) return 'ç»´æ£®ç§‘æŠ€';
            if (content.includes('æ·±åœ³å¸‚å¾®è§†å…‰ç”µ')) return 'æ·±åœ³å¸‚å¾®è§†å…‰ç”µç§‘æŠ€æœ‰é™å…¬å¸';
            if (content.includes('å¤©æ´¥ç»´æ£®')) return 'å¤©æ´¥ç»´æ£®ç§‘æŠ€æœ‰é™å…¬å¸';
            return 'ç»´æ£®ç§‘æŠ€';
        }

        function extractNewsCategoryFromContent(content) {
            if (!content) return 'è¡Œä¸šåŠ¨æ€';
            if (content.includes('å±•ä¼š') || content.includes('å±•è§ˆ')) return 'å±•ä¼šä¿¡æ¯';
            if (content.includes('äº§å“') || content.includes('å‘å¸ƒ')) return 'äº§å“å‘å¸ƒ';
            if (content.includes('æŠ€æœ¯') || content.includes('åº”ç”¨')) return 'æŠ€æœ¯èµ„è®¯';
            return 'è¡Œä¸šåŠ¨æ€';
        }

        function extractCaseCategoryFromContent(content) {
            if (!content) return 'å·¥ä¸šæ£€æµ‹';
            if (content.includes('æ±½è½¦')) return 'æ±½è½¦åˆ¶é€ ';
            if (content.includes('èˆªç©º') || content.includes('èˆªå¤©')) return 'èˆªç©ºèˆªå¤©';
            if (content.includes('èƒ½æº') || content.includes('ç”µåŠ›')) return 'èƒ½æºç”µåŠ›';
            if (content.includes('çŸ³æ²¹') || content.includes('åŒ–å·¥')) return 'çŸ³æ²¹åŒ–å·¥';
            return 'å·¥ä¸šæ£€æµ‹';
        }

        function extractIndustryFromContent(content) {
            if (!content) return 'åˆ¶é€ ä¸š';
            if (content.includes('æ±½è½¦')) return 'æ±½è½¦å·¥ä¸š';
            if (content.includes('èˆªç©º')) return 'èˆªç©ºå·¥ä¸š';
            if (content.includes('èƒ½æº')) return 'èƒ½æºå·¥ä¸š';
            if (content.includes('çŸ³æ²¹')) return 'çŸ³æ²¹å·¥ä¸š';
            return 'åˆ¶é€ ä¸š';
        }

        // é¡µé¢åˆå§‹åŒ–æ—¶æ˜¾ç¤ºä»ªè¡¨æ¿
        document.addEventListener('DOMContentLoaded', async function() {
            console.log('âœ… é¡µé¢åŠ è½½å®Œæˆï¼Œåˆå§‹åŒ–ç®¡ç†ä¸­å¿ƒ');

            // å…ˆæ˜¾ç¤ºåŠ è½½çŠ¶æ€
            showDashboardLoading();

            // åŠ è½½é¡¹ç›®æ•°æ®
            await loadProjectData();

            // æ˜¾ç¤ºä»ªè¡¨æ¿
            showDashboard();
        });

        // æ˜¾ç¤ºä»ªè¡¨æ¿åŠ è½½çŠ¶æ€
        function showDashboardLoading() {
            const contentTitle = document.getElementById('contentTitle');
            const contentSubtitle = document.getElementById('contentSubtitle');
            const contentBody = document.getElementById('contentBody');
            const contentActions = document.getElementById('contentActions');

            if (contentTitle) contentTitle.textContent = 'ç®¡ç†ä¸­å¿ƒ';
            if (contentSubtitle) contentSubtitle.textContent = 'æ­£åœ¨åŠ è½½é¡¹ç›®æ•°æ®...';
            if (contentActions) contentActions.innerHTML = '';

            if (contentBody) {
                contentBody.innerHTML = `
                    <div class="text-center py-5">
                        <div class="spinner-border text-primary mb-3" role="status" style="width: 3rem; height: 3rem;">
                            <span class="visually-hidden">åŠ è½½ä¸­...</span>
                        </div>
                        <h4>æ­£åœ¨åŒæ­¥é¡¹ç›®æ•°æ®</h4>
                        <p class="text-muted">æ­£åœ¨ä»é¡¹ç›®æ–‡ä»¶ä¸­è¯»å–æœ€æ–°çš„äº§å“ã€èµ„è®¯ã€æ¡ˆä¾‹ç­‰æ•°æ®...</p>
                    </div>
                `;
            }
        }

        // æ˜¾ç¤ºä»ªè¡¨æ¿
        function showDashboard() {
            const contentTitle = document.getElementById('contentTitle');
            const contentSubtitle = document.getElementById('contentSubtitle');
            const contentBody = document.getElementById('contentBody');
            const contentActions = document.getElementById('contentActions');

            if (contentTitle) contentTitle.textContent = 'ç®¡ç†ä¸­å¿ƒ';
            if (contentSubtitle) contentSubtitle.textContent = 'æ¬¢è¿ä½¿ç”¨ VisNDT å†…å®¹ç®¡ç†ç³»ç»Ÿ - å®æ—¶æ•°æ®åŒæ­¥';

            if (contentActions) {
                contentActions.innerHTML = `
                    <button class="btn btn-primary" onclick="refreshDashboard()">
                        <i class="fas fa-sync me-1"></i>åˆ·æ–°æ•°æ®
                    </button>
                    <button class="btn btn-success" onclick="showProductsList()">
                        <i class="fas fa-box me-1"></i>ç®¡ç†äº§å“
                    </button>
                    <button class="btn btn-info" onclick="showNewsList()">
                        <i class="fas fa-newspaper me-1"></i>ç®¡ç†èµ„è®¯
                    </button>
                `;
            }

            if (contentBody) {
                contentBody.innerHTML = `
                    <!-- ç»Ÿè®¡å¡ç‰‡ -->
                    <div class="row mb-4">
                        <div class="col-md-3">
                            <div class="card bg-primary text-white">
                                <div class="card-body">
                                    <div class="d-flex justify-content-between">
                                        <div>
                                            <h4 class="mb-0">${projectData.products.length}</h4>
                                            <p class="mb-0">äº§å“æ€»æ•°</p>
                                        </div>
                                        <div class="align-self-center">
                                            <i class="fas fa-box fa-2x"></i>
                                        </div>
                                    </div>
                                </div>
                                <div class="card-footer">
                                    <small>åŒ…å«æ‰€æœ‰ç³»åˆ—äº§å“</small>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="card bg-success text-white">
                                <div class="card-body">
                                    <div class="d-flex justify-content-between">
                                        <div>
                                            <h4 class="mb-0">${projectData.suppliers.length}</h4>
                                            <p class="mb-0">ä¾›åº”å•†</p>
                                        </div>
                                        <div class="align-self-center">
                                            <i class="fas fa-building fa-2x"></i>
                                        </div>
                                    </div>
                                </div>
                                <div class="card-footer">
                                    <small>åˆä½œä¾›åº”å•†æ•°é‡</small>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="card bg-info text-white">
                                <div class="card-body">
                                    <div class="d-flex justify-content-between">
                                        <div>
                                            <h4 class="mb-0">${projectData.news.length}</h4>
                                            <p class="mb-0">èµ„è®¯æ–‡ç« </p>
                                        </div>
                                        <div class="align-self-center">
                                            <i class="fas fa-newspaper fa-2x"></i>
                                        </div>
                                    </div>
                                </div>
                                <div class="card-footer">
                                    <small>å·²å‘å¸ƒèµ„è®¯æ•°é‡</small>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="card bg-warning text-white">
                                <div class="card-body">
                                    <div class="d-flex justify-content-between">
                                        <div>
                                            <h4 class="mb-0">${projectData.cases.length}</h4>
                                            <p class="mb-0">åº”ç”¨æ¡ˆä¾‹</p>
                                        </div>
                                        <div class="align-self-center">
                                            <i class="fas fa-briefcase fa-2x"></i>
                                        </div>
                                    </div>
                                </div>
                                <div class="card-footer">
                                    <small>æˆåŠŸæ¡ˆä¾‹æ•°é‡</small>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- å¿«æ·æ“ä½œ -->
                    <div class="row mb-4">
                        <div class="col-md-4">
                            <div class="card h-100">
                                <div class="card-header bg-primary text-white">
                                    <h5 class="mb-0"><i class="fas fa-box me-2"></i>äº§å“ç®¡ç†</h5>
                                </div>
                                <div class="card-body">
                                    <p class="card-text">ç®¡ç†å·¥ä¸šå†…çª¥é•œäº§å“ä¿¡æ¯ï¼ŒåŒ…æ‹¬äº§å“è¯¦æƒ…ã€æŠ€æœ¯å‚æ•°ã€ä¾›åº”å•†ç­‰ã€‚</p>
                                    <div class="mb-3">
                                        <small class="text-muted">
                                            äº§å“åˆ†ç±»: ${projectData.categories.length} ä¸ª<br>
                                            æœ€æ–°æ›´æ–°: ${new Date().toLocaleDateString()}
                                        </small>
                                    </div>
                                </div>
                                <div class="card-footer">
                                    <button class="btn btn-primary w-100" onclick="showProductsList()">
                                        <i class="fas fa-list me-1"></i>æŸ¥çœ‹äº§å“åˆ—è¡¨
                                    </button>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="card h-100">
                                <div class="card-header bg-success text-white">
                                    <h5 class="mb-0"><i class="fas fa-newspaper me-2"></i>å†…å®¹ç®¡ç†</h5>
                                </div>
                                <div class="card-body">
                                    <p class="card-text">ç®¡ç†ç½‘ç«™èµ„è®¯ã€æ¡ˆä¾‹å’Œåº”ç”¨é¢†åŸŸç­‰å†…å®¹ï¼Œä¿æŒç½‘ç«™ä¿¡æ¯çš„åŠæ—¶æ›´æ–°ã€‚</p>
                                    <div class="mb-3">
                                        <small class="text-muted">
                                            åº”ç”¨é¢†åŸŸ: ${projectData.applications.length} ä¸ª<br>
                                            æ€»æµè§ˆé‡: ${projectData.news.reduce((sum, news) => sum + news.views, 0)}
                                        </small>
                                    </div>
                                </div>
                                <div class="card-footer">
                                    <div class="btn-group w-100">
                                        <button class="btn btn-success" onclick="showNewsList()">
                                            <i class="fas fa-newspaper me-1"></i>èµ„è®¯
                                        </button>
                                        <button class="btn btn-success" onclick="showCasesList()">
                                            <i class="fas fa-briefcase me-1"></i>æ¡ˆä¾‹
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="card h-100">
                                <div class="card-header bg-info text-white">
                                    <h5 class="mb-0"><i class="fas fa-cogs me-2"></i>ç³»ç»Ÿç®¡ç†</h5>
                                </div>
                                <div class="card-body">
                                    <p class="card-text">ç³»ç»Ÿè®¾ç½®ã€æ•°æ®å¯¼å…¥å¯¼å‡ºã€åª’ä½“åº“ç®¡ç†ç­‰ç³»ç»Ÿçº§åŠŸèƒ½ã€‚</p>
                                    <div class="mb-3">
                                        <small class="text-muted">
                                            æ•°æ®åŒæ­¥: å®æ—¶<br>
                                            ç³»ç»ŸçŠ¶æ€: æ­£å¸¸è¿è¡Œ
                                        </small>
                                    </div>
                                </div>
                                <div class="card-footer">
                                    <div class="btn-group w-100">
                                        <button class="btn btn-info" onclick="showImportExport()">
                                            <i class="fas fa-exchange-alt me-1"></i>å¯¼å…¥å¯¼å‡º
                                        </button>
                                        <button class="btn btn-info" onclick="showMediaLibrary()">
                                            <i class="fas fa-images me-1"></i>åª’ä½“åº“
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- æ•°æ®æ¦‚è§ˆ -->
                    <div class="row">
                        <div class="col-12">
                            <div class="card">
                                <div class="card-header">
                                    <h5 class="mb-0"><i class="fas fa-chart-bar me-2"></i>æ•°æ®æ¦‚è§ˆ</h5>
                                </div>
                                <div class="card-body">
                                    <div class="row">
                                        <div class="col-md-6">
                                            <h6>äº§å“åˆ†å¸ƒ</h6>
                                            <div class="mb-3">
                                                ${projectData.categories.map(cat => `
                                                    <div class="d-flex justify-content-between mb-1">
                                                        <span>${cat.name}</span>
                                                        <span class="badge bg-primary">${cat.products}</span>
                                                    </div>
                                                `).join('')}
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <h6>ä¾›åº”å•†åˆ†å¸ƒ</h6>
                                            <div class="mb-3">
                                                ${projectData.suppliers.map(supplier => `
                                                    <div class="d-flex justify-content-between mb-1">
                                                        <span>${supplier.name}</span>
                                                        <span class="badge bg-success">${supplier.products}</span>
                                                    </div>
                                                `).join('')}
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            }
        }

        // åˆ·æ–°ä»ªè¡¨æ¿
        async function refreshDashboard() {
            console.log('ğŸ”„ åˆ·æ–°ä»ªè¡¨æ¿æ•°æ®');
            showDashboardLoading();
            await loadProjectData();
            showDashboard();
            alert('æ•°æ®åˆ·æ–°å®Œæˆï¼');
        }

        console.log('ğŸ¯ å¢å¼ºç‰ˆJavaScriptåŠ è½½å®Œæˆ');

    </script>

    <!-- åª’ä½“åº“é€‰æ‹©æ¨¡æ€æ¡† -->
    <div class="modal fade" id="mediaLibraryModal" tabindex="-1" aria-labelledby="mediaLibraryModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-xl">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="mediaLibraryModalLabel">é€‰æ‹©åª’ä½“æ–‡ä»¶</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="row">
                        <div class="col-md-3">
                            <div class="list-group" id="mediaFolderList">
                                <button type="button" class="list-group-item list-group-item-action active" data-folder="images/products">
                                    <i class="fas fa-folder me-2"></i>äº§å“å›¾ç‰‡
                                </button>
                                <button type="button" class="list-group-item list-group-item-action" data-folder="images/cases">
                                    <i class="fas fa-folder me-2"></i>æ¡ˆä¾‹å›¾ç‰‡
                                </button>
                                <button type="button" class="list-group-item list-group-item-action" data-folder="images/news">
                                    <i class="fas fa-folder me-2"></i>èµ„è®¯å›¾ç‰‡
                                </button>
                                <button type="button" class="list-group-item list-group-item-action" data-folder="uploads">
                                    <i class="fas fa-file me-2"></i>ä¸Šä¼ æ–‡ä»¶
                                </button>
                            </div>
                        </div>
                        <div class="col-md-9">
                            <div id="mediaFileGrid" class="row">
                                <!-- åª’ä½“æ–‡ä»¶ç½‘æ ¼å°†åœ¨è¿™é‡Œæ˜¾ç¤º -->
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">å–æ¶ˆ</button>
                    <button type="button" class="btn btn-primary" id="selectMediaBtn" onclick="confirmMediaSelection()">é€‰æ‹©æ–‡ä»¶</button>
                </div>
            </div>
        </div>
    </div>

</body>
</html>
