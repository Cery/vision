<section class="new-products-section py-4">
    <div class="container">
        <div class="row mb-4">
            <div class="col-12">
                <h2 class="section-title text-center">新品推荐</h2>
                <p class="text-center text-muted">最新上市的无损检测设备</p>
            </div>
        </div>

        <div class="row">
            {{ $displayedProducts := 0 }}
            {{ if .Params.new_product_recommendations }}
            {{ range .Params.new_product_recommendations.products }}
            {{ if .display }}
            {{ with $.Site.GetPage (printf "/products/%s" .product) }}
            <div class="col-lg-4 col-md-6 mb-4">
                <div class="card h-100 border-0 shadow-sm product-card">
                                    {{ $hasImage := false }}
                    {{ range first 1 .Params.gallery }}
                    {{ if .is_main }}
                    <div class="product-image-wrapper">
                        <img src="{{ .image }}" class="card-img-top product-image" alt="{{ .alt }}">
                    </div>
                                            {{ $hasImage = true }}
                    {{ end }}
                    {{ end }}
                                    {{ if not $hasImage }}
                                        <div class="product-image-wrapper">
                                            <img src="https://picsum.photos/400/300?random={{ .Title }}" class="card-img-top product-image" alt="{{ .Title }}">
                                        </div>
                                    {{ end }}
                    <div class="card-body">
                        <h5 class="card-title"><a href="{{ .Permalink }}" class="text-decoration-none text-dark">{{ .Title }}</a></h5>
                        {{ with .Params.model }}
                        <p class="card-text text-muted small mb-2">型号：{{ . }}</p>
                        {{ end }}
                        <p class="card-text">{{ .Summary }}</p>
                        <div class="mt-3">
                            {{ range first 1 .Params.primary_categories }}
                                            <span class="badge bg-primary me-2">{{ . }}</span>
                            {{ end }}
                            {{ range first 1 .Params.secondary_categories }}
                                            <span class="badge bg-secondary me-2">{{ . }}</span>
                            {{ end }}
                        </div>
                    </div>
                    <div class="card-footer bg-white border-0">
                        <a href="{{ .Permalink }}" class="btn btn-outline-primary w-100">查看详情</a>
                    </div>
                </div>
            </div>
                            {{ $displayedProducts = add $displayedProducts 1 }}
                        {{ end }}
            {{ end }}
            {{ end }}
            {{ end }}

            <!-- 如果没有足够的产品，添加占位产品 -->
            {{ range seq (sub 3 $displayedProducts) }}
                <div class="col-lg-4 col-md-6 mb-4">
                    <div class="card h-100 border-0 shadow-sm product-card">
                        <div class="product-image-wrapper">
                            <img src="https://picsum.photos/400/300?random={{ . }}" class="card-img-top product-image" alt="产品占位图">
                        </div>
                        <div class="card-body">
                            <h5 class="card-title"><a href="#" class="text-decoration-none text-dark">示例产品 {{ . }}</a></h5>
                            <p class="card-text text-muted small mb-2">型号：DEMO-{{ . }}</p>
                            <p class="card-text">这是一个示例产品描述，您可以在后台添加真实的产品信息。</p>
                            <div class="mt-3">
                                <span class="badge bg-primary me-2">示例分类</span>
                                <span class="badge bg-secondary me-2">子分类</span>
                            </div>
                        </div>
                        <div class="card-footer bg-white border-0">
                            <a href="#" class="btn btn-outline-primary w-100">查看详情</a>
                        </div>
                    </div>
                </div>
            {{ end }}
        </div>
    </div>
</section>

<style>
.product-card {
    transition: transform 0.3s ease;
}

.product-card:hover {
    transform: translateY(-5px);
}

.product-image-wrapper {
    height: 200px;
    overflow: hidden;
}

.product-image {
    width: 100%;
    height: 100%;
    object-fit: cover;
}

.card-title {
    font-size: 1.1rem;
    margin-bottom: 0.75rem;
}

.card-text {
    font-size: 0.9rem;
    line-height: 1.5;
}

.badge {
    font-weight: 500;
    padding: 0.5em 0.75em;
}
</style>