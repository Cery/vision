<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SEO元素检查工具</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        .seo-item {
            margin-bottom: 1rem;
            padding: 1rem;
            border: 1px solid #dee2e6;
            border-radius: 0.375rem;
        }
        .seo-item.found {
            border-color: #198754;
            background-color: #d1e7dd;
        }
        .seo-item.missing {
            border-color: #dc3545;
            background-color: #f8d7da;
        }
        .meta-content {
            font-family: monospace;
            font-size: 0.875rem;
            background-color: #f8f9fa;
            padding: 0.5rem;
            border-radius: 0.25rem;
            margin-top: 0.5rem;
        }
    </style>
</head>
<body>
    <div class="container py-5">
        <h1 class="mb-4">SEO元素检查工具</h1>
        
        <div class="row">
            <div class="col-md-6">
                <div class="mb-3">
                    <label for="urlInput" class="form-label">输入要检查的页面URL：</label>
                    <input type="url" class="form-control" id="urlInput" placeholder="http://localhost:1313/products/model/">
                </div>
                <button class="btn btn-primary" onclick="checkSEO()">检查SEO元素</button>
            </div>
        </div>

        <div id="results" class="mt-4"></div>
    </div>

    <script>
        async function checkSEO() {
            const url = document.getElementById('urlInput').value;
            if (!url) {
                alert('请输入URL');
                return;
            }

            const resultsDiv = document.getElementById('results');
            resultsDiv.innerHTML = '<div class="text-center"><div class="spinner-border" role="status"></div><p>正在检查SEO元素...</p></div>';

            try {
                // 由于CORS限制，我们需要在同一域名下检查
                const response = await fetch(url);
                const html = await response.text();
                
                // 创建一个临时DOM来解析HTML
                const parser = new DOMParser();
                const doc = parser.parseFromString(html, 'text/html');
                
                const seoElements = [
                    {
                        name: 'Title标签',
                        selector: 'title',
                        attribute: null,
                        description: '页面标题'
                    },
                    {
                        name: 'Meta Description',
                        selector: 'meta[name="description"]',
                        attribute: 'content',
                        description: '页面描述'
                    },
                    {
                        name: 'Meta Keywords',
                        selector: 'meta[name="keywords"]',
                        attribute: 'content',
                        description: '关键词'
                    },
                    {
                        name: 'SEO Title',
                        selector: 'meta[name="seo_title"]',
                        attribute: 'content',
                        description: '自定义SEO标题'
                    },
                    {
                        name: 'OG Title',
                        selector: 'meta[property="og:title"]',
                        attribute: 'content',
                        description: 'Open Graph标题'
                    },
                    {
                        name: 'OG Description',
                        selector: 'meta[property="og:description"]',
                        attribute: 'content',
                        description: 'Open Graph描述'
                    },
                    {
                        name: 'OG Image',
                        selector: 'meta[property="og:image"]',
                        attribute: 'content',
                        description: 'Open Graph图片'
                    },
                    {
                        name: 'OG Type',
                        selector: 'meta[property="og:type"]',
                        attribute: 'content',
                        description: 'Open Graph类型'
                    },
                    {
                        name: 'Twitter Card',
                        selector: 'meta[name="twitter:card"]',
                        attribute: 'content',
                        description: 'Twitter卡片类型'
                    },
                    {
                        name: 'Canonical URL',
                        selector: 'link[rel="canonical"]',
                        attribute: 'href',
                        description: '规范URL'
                    },
                    {
                        name: 'Product Model',
                        selector: 'meta[name="product:model"]',
                        attribute: 'content',
                        description: '产品型号'
                    },
                    {
                        name: 'Product Manufacturer',
                        selector: 'meta[name="product:manufacturer"]',
                        attribute: 'content',
                        description: '产品制造商'
                    },
                    {
                        name: 'Structured Data (JSON-LD)',
                        selector: 'script[type="application/ld+json"]',
                        attribute: null,
                        description: '结构化数据'
                    }
                ];

                let resultsHTML = `<h2>SEO检查结果 - ${url}</h2>`;
                
                seoElements.forEach(element => {
                    const found = doc.querySelector(element.selector);
                    const content = found ? (element.attribute ? found.getAttribute(element.attribute) : found.textContent) : null;
                    
                    resultsHTML += `
                        <div class="seo-item ${found ? 'found' : 'missing'}">
                            <h5>${element.name} ${found ? '✅' : '❌'}</h5>
                            <p class="mb-1">${element.description}</p>
                            ${content ? `<div class="meta-content">${content.length > 200 ? content.substring(0, 200) + '...' : content}</div>` : '<small class="text-muted">未找到</small>'}
                        </div>
                    `;
                });

                // 检查结构化数据
                const structuredDataScripts = doc.querySelectorAll('script[type="application/ld+json"]');
                if (structuredDataScripts.length > 0) {
                    resultsHTML += `<h3>结构化数据 (${structuredDataScripts.length}个)</h3>`;
                    structuredDataScripts.forEach((script, index) => {
                        try {
                            const data = JSON.parse(script.textContent);
                            resultsHTML += `
                                <div class="seo-item found">
                                    <h5>结构化数据 ${index + 1}: ${data['@type'] || '未知类型'} ✅</h5>
                                    <div class="meta-content">${JSON.stringify(data, null, 2).substring(0, 500)}...</div>
                                </div>
                            `;
                        } catch (e) {
                            resultsHTML += `
                                <div class="seo-item missing">
                                    <h5>结构化数据 ${index + 1}: 解析错误 ❌</h5>
                                    <p>JSON格式错误</p>
                                </div>
                            `;
                        }
                    });
                }

                resultsDiv.innerHTML = resultsHTML;

            } catch (error) {
                resultsDiv.innerHTML = `<div class="alert alert-danger">检查失败: ${error.message}</div>`;
            }
        }

        // 页面加载时自动检查model页面
        document.addEventListener('DOMContentLoaded', function() {
            document.getElementById('urlInput').value = 'http://localhost:1313/products/model/';
            checkSEO();
        });
    </script>
</body>
</html>
